(function t(e,r){if(typeof exports==="object"&&typeof module==="object")module.exports=r();else if(typeof define==="function"&&define.amd)define("world",[],r);else if(typeof exports==="object")exports["world"]=r();else e["world"]=r()})(this,function(){return function(t){var e={};function r(a){if(e[a])return e[a].exports;var n=e[a]={exports:{},id:a,loaded:false};t[a].call(n.exports,n,n.exports,r);n.loaded=true;return n.exports}r.m=t;r.c=e;r.p="";return r(0)}([function(t,e,r){if(true){var a=r(1);var n=a.Graphics3D;var o=a.TextureManager;var i=a.InputManager;window.math=a.Math.advenMath;window.glMat=a.Math.glMat;window.Model=n.Model;window.RESTManager=a.RESTManager;var s=n.Container;var u=n.Ray;var l=n.Octree;var h=n.GLSLProgram;var f=r(35);window.IOMANAGER=r(38);window.initWebglContext=r(39);window.wiki=r(40);t.exports=S}CONTEXT=null;TEXTUREMANAGER=null;EARTHSCENE=null;DRAGONSCENE=null;BATTLESCENE=null;BATTLESCENE2=null;WORLDSCENE=null;ACTIVESCENE=null;SESSION=null;GAMES=null;var c=-1;var M=30;function v(t){x();if(ACTIVESCENE){ACTIVESCENE.update();ACTIVESCENE.draw(CONTEXT,TEXTUREMANAGER);CONTEXT.gl.flush()}c=window.requestAnimationFrame(v)}function p(t){console.log("resources loaded");CONTEXT=initWebglContext(t||document.getElementById("target"),IOMANAGER);CONTEXT.gl.clearColor(0,.15,.3,1);TEXTUREMANAGER=new o({gl:CONTEXT.gl,ioManager:IOMANAGER});m();I();window.gl=CONTEXT.gl;v()}function x(){if(ACTIVESCENE){ACTIVESCENE.processInput()}}function d(){}function m(){var t=JSON.parse(IOMANAGER.getResource("resources/dragonDecimated.json"));var e=new Model({name:"resources/dragonDecimated.json",aPosition:3,aColor:3,aUV:2,vertices:t.vertices,indices:t.indices});EARTHSCENE=new f;EARTHSCENE.init(IOMANAGER,CONTEXT.canvas);ACTIVESCENE=EARTHSCENE;d()}function S(){IOMANAGER.loadAllResources(p)}function I(){var t=CONTEXT.canvas;t.addEventListener("dblclick",A);document.onkeyup=D;document.onkeydown=g;t.addEventListener("mousedown",F);t.addEventListener("mouseup",y);t.addEventListener("mousemove",b);t.addEventListener("touchstart",F);t.addEventListener("touchend",y);t.addEventListener("touchmove",b);t.onwheel=E;t.oncontextmenu=w;window.addEventListener("resize",T)}function g(t){var e=t.keyCode;if(e==49){ACTIVESCENE=EARTHSCENE}if(ACTIVESCENE){ACTIVESCENE.inputManager.pressKey(t)}}function D(t){if(ACTIVESCENE){ACTIVESCENE.inputManager.releaseKey(t)}}function F(t){if(ACTIVESCENE){ACTIVESCENE.inputManager.mouseDown(t);if(ACTIVESCENE===EARTHSCENE){var e=EARTHSCENE.map.mouseMoveTargets.splice(0);if(e.length>0){wiki.getPage(EARTHSCENE.map.children[e[0].id].admin,function(t){document.getElementById("info").innerHTML=t.firstPassage},10)}}}}function y(t){if(ACTIVESCENE){ACTIVESCENE.inputManager.mouseUp(t)}}function b(t){if(ACTIVESCENE){var e=ACTIVESCENE.inputManager.mouseMove(t)}}function E(t){if(ACTIVESCENE){ACTIVESCENE.inputManager.onWheel(t)}}function w(t){if(ACTIVESCENE){ACTIVESCENE.inputManager.onContextMenu(t)}return false}function A(t){if(c===-1){v()}else{cancelAnimationFrame(c);c=-1}}function T(t){}},function(t,e,r){t.exports={Math:r(2),ResourceLoader:r(14),Graphics3D:r(16),Intersect:r(23),InputManager:r(25),TextureManager:r(27),geoJSONParser:r(29),WebGLManager:r(32)}},function(t,e,r){t.exports={advenMath:r(3),glMat:r(4)}},function(t,e,r){if(true){}var a={_multiByMatrixInv:function(t,e){return new Float32Array([e[0]*t[0]+e[1]*t[1]+e[2]*t[2]-(e[12]*e[0]+e[13]*e[1]+e[14]*e[2])*t[3],e[4]*t[0]+e[5]*t[1]+e[6]*t[2]-(e[12]*e[4]+e[13]*e[5]+e[14]*e[6])*t[3],e[8]*t[0]+e[9]*t[1]+e[10]*t[2]-(e[12]*e[8]+e[13]*e[9]+e[14]*e[10])*t[3]])},multPoint3ByMat4Inv:function(t,e){t.push(1);return this._multiByMatrixInv(t,e)},multVec3ByMat4Inv:function(t,e){t.push(0);return this._multiByMatrixInv(t,e)},degToRad:function(t){return t*Math.PI/180},m4_x_v4:function(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3]]},mat4GetProjection:function(t,e,r,a){var n=Math.tan(this.degToRad(.5*t)),o=-(a+r)/(a-r),i=-2*a*r/(a-r);return new Float32Array([.5/n,0,0,0,0,.5*e/n,0,0,0,0,o,-1,0,0,i,0])},mat4GetVec4:function(t,e){t[0]=e[12];t[1]=e[13];t[2]=e[14];t[3]=e[15]},mat4TranslateRaw:function(t,e){t[12]+=e[0];t[13]+=e[1];t[14]+=e[2]},mat4Create:function(){return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])},mat4SetIdentity:function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1},mat3Create:function(){return new Float32Array([1,0,0,0,1,0,0,0,1])},mat4RotateX:function(t,e){var r=Math.cos(e);var a=Math.sin(e);var n=t[1],o=t[5],i=t[9];t[1]=t[1]*r-t[2]*a;t[5]=t[5]*r-t[6]*a;t[9]=t[9]*r-t[10]*a;t[2]=t[2]*r+n*a;t[6]=t[6]*r+o*a;t[10]=t[10]*r+i*a},mat4RotateY:function(t,e){var r=Math.cos(e);var a=Math.sin(e);var n=t[0],o=t[4],i=t[8];t[0]=r*t[0]+a*t[2];t[4]=r*t[4]+a*t[6];t[8]=r*t[8]+a*t[10];t[2]=r*t[2]-a*n;t[6]=r*t[6]-a*o;t[10]=r*t[10]-a*i},mat4RotateZ:function(t,e){var r=Math.cos(e);var a=Math.sin(e);var n=t[0],o=t[4],i=t[8];t[0]=r*t[0]-a*t[1];t[4]=r*t[4]-a*t[5];t[8]=r*t[8]-a*t[9];t[1]=r*t[1]+a*n;t[5]=r*t[5]+a*o;t[9]=r*t[9]+a*i},mat4TranslateZ:function(t,e){t[14]+=e},mat4TranslateY:function(t,e){t[13]+=e},mat4TranslateX:function(t,e){t[12]+=e},mat4SetPosition:function(t,e,r,a){t[12]=e,t[13]=r,t[14]=a},vec3Square:function(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]},vec3GetUnit:function(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);return e===0?[0,0,0]:[t[0]/e,t[1]/e,t[2]/e]},mat4Transpose43:function(t,e){e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[1],e[4]=t[5],e[5]=t[9],e[6]=t[2],e[7]=t[6],e[8]=t[10]},vec3Normalize:function(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e},mat4GetTranslationVec3:function(t){return new Float32Array([t[12],t[13],t[14]])},vec3MultiplyByMat4:function(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]]},vec3Sub:function(t,e){return new Float32Array([e[0]-t[0],e[1]-t[1],e[2]-t[2]])},vec3SubNew:function(t,e){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]},vec3Dot:function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},vec3Size:function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])},vec3Cross:function(t,e){return new Float32Array([t[1]*e[2]-t[2]*e[1],-t[0]*e[2]+t[2]*e[0],t[0]*e[1]-t[1]*e[0]])},vec3SquareNorm:function(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]},mat4Multiply:function(t,e,r){var a=e;var n=r;var o=t;var i=a[0],s=a[4],u=a[8],l=a[12];var h=a[1],f=a[5],c=a[9],M=a[13];var v=a[2],p=a[6],x=a[10],d=a[14];var m=a[3],S=a[7],I=a[11],g=a[15];var D=n[0],F=n[4],y=n[8],b=n[12];var E=n[1],w=n[5],A=n[9],T=n[13];var R=n[2],N=n[6],C=n[10],P=n[14];var L=n[3],z=n[7],_=n[11],O=n[15];o[0]=i*D+s*E+u*R+l*L;o[4]=i*F+s*w+u*N+l*z;o[8]=i*y+s*A+u*C+l*_;o[12]=i*b+s*T+u*P+l*O;o[1]=h*D+f*E+c*R+M*L;o[5]=h*F+f*w+c*N+M*z;o[9]=h*y+f*A+c*C+M*_;o[13]=h*b+f*T+c*P+M*O;o[2]=v*D+p*E+x*R+d*L;o[6]=v*F+p*w+x*N+d*z;o[10]=v*y+p*A+x*C+d*_;o[14]=v*b+p*T+x*P+d*O;o[3]=m*D+S*E+I*R+g*L;o[7]=m*F+S*w+I*N+g*z;o[11]=m*y+S*A+I*C+g*_;o[15]=m*b+S*T+I*P+g*O},mat4Scale:function(t,e){var r=t;var a=e[0],n=e[1],o=e[2];r[0]*=a;r[5]*=n;r[10]*=o},mat4Inverse:function(t,e){var r=new Float32Array(16),a,n;r[0]=t[5]*t[10]*t[15]-t[5]*t[11]*t[14]-t[9]*t[6]*t[15]+t[9]*t[7]*t[14]+t[13]*t[6]*t[11]-t[13]*t[7]*t[10];r[4]=-t[4]*t[10]*t[15]+t[4]*t[11]*t[14]+t[8]*t[6]*t[15]-t[8]*t[7]*t[14]-t[12]*t[6]*t[11]+t[12]*t[7]*t[10];r[8]=t[4]*t[9]*t[15]-t[4]*t[11]*t[13]-t[8]*t[5]*t[15]+t[8]*t[7]*t[13]+t[12]*t[5]*t[11]-t[12]*t[7]*t[9];r[12]=-t[4]*t[9]*t[14]+t[4]*t[10]*t[13]+t[8]*t[5]*t[14]-t[8]*t[6]*t[13]-t[12]*t[5]*t[10]+t[12]*t[6]*t[9];r[1]=-t[1]*t[10]*t[15]+t[1]*t[11]*t[14]+t[9]*t[2]*t[15]-t[9]*t[3]*t[14]-t[13]*t[2]*t[11]+t[13]*t[3]*t[10];r[5]=t[0]*t[10]*t[15]-t[0]*t[11]*t[14]-t[8]*t[2]*t[15]+t[8]*t[3]*t[14]+t[12]*t[2]*t[11]-t[12]*t[3]*t[10];r[9]=-t[0]*t[9]*t[15]+t[0]*t[11]*t[13]+t[8]*t[1]*t[15]-t[8]*t[3]*t[13]-t[12]*t[1]*t[11]+t[12]*t[3]*t[9];r[13]=t[0]*t[9]*t[14]-t[0]*t[10]*t[13]-t[8]*t[1]*t[14]+t[8]*t[2]*t[13]+t[12]*t[1]*t[10]-t[12]*t[2]*t[9];r[2]=t[1]*t[6]*t[15]-t[1]*t[7]*t[14]-t[5]*t[2]*t[15]+t[5]*t[3]*t[14]+t[13]*t[2]*t[7]-t[13]*t[3]*t[6];r[6]=-t[0]*t[6]*t[15]+t[0]*t[7]*t[14]+t[4]*t[2]*t[15]-t[4]*t[3]*t[14]-t[12]*t[2]*t[7]+t[12]*t[3]*t[6];r[10]=t[0]*t[5]*t[15]-t[0]*t[7]*t[13]-t[4]*t[1]*t[15]+t[4]*t[3]*t[13]+t[12]*t[1]*t[7]-t[12]*t[3]*t[5];r[14]=-t[0]*t[5]*t[14]+t[0]*t[6]*t[13]+t[4]*t[1]*t[14]-t[4]*t[2]*t[13]-t[12]*t[1]*t[6]+t[12]*t[2]*t[5];r[3]=-t[1]*t[6]*t[11]+t[1]*t[7]*t[10]+t[5]*t[2]*t[11]-t[5]*t[3]*t[10]-t[9]*t[2]*t[7]+t[9]*t[3]*t[6];r[7]=t[0]*t[6]*t[11]-t[0]*t[7]*t[10]-t[4]*t[2]*t[11]+t[4]*t[3]*t[10]+t[8]*t[2]*t[7]-t[8]*t[3]*t[6];r[11]=-t[0]*t[5]*t[11]+t[0]*t[7]*t[9]+t[4]*t[1]*t[11]-t[4]*t[3]*t[9]-t[8]*t[1]*t[7]+t[8]*t[3]*t[5];r[15]=t[0]*t[5]*t[10]-t[0]*t[6]*t[9]-t[4]*t[1]*t[10]+t[4]*t[2]*t[9]+t[8]*t[1]*t[6]-t[8]*t[2]*t[5];n=t[0]*r[0]+t[1]*r[4]+t[2]*r[8]+t[3]*r[12];if(n==0)return false;n=1/n;for(a=0;a<16;a++)e[a]=r[a]*n;return true}};if(true){t.exports=a}},function(t,e,r){e.glMatrix=r(5);e.mat2=r(6);e.mat2d=r(7);e.mat3=r(8);e.mat4=r(9);e.quat=r(10);e.vec2=r(13);e.vec3=r(11);e.vec4=r(12)},function(t,e){var r={};r.EPSILON=1e-6;r.ARRAY_TYPE=typeof Float32Array!=="undefined"?Float32Array:Array;r.RANDOM=Math.random;r.ENABLE_SIMD=false;r.SIMD_AVAILABLE=r.ARRAY_TYPE===Float32Array&&"SIMD"in window;r.USE_SIMD=r.ENABLE_SIMD&&r.SIMD_AVAILABLE;r.setMatrixArrayType=function(t){r.ARRAY_TYPE=t};var a=Math.PI/180;r.toRadian=function(t){return t*a};r.equals=function(t,e){return Math.abs(t-e)<=r.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))};t.exports=r},function(t,e,r){var a=r(5);var n={};n.create=function(){var t=new a.ARRAY_TYPE(4);t[0]=1;t[1]=0;t[2]=0;t[3]=1;return t};n.clone=function(t){var e=new a.ARRAY_TYPE(4);e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];return e};n.copy=function(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];return t};n.identity=function(t){t[0]=1;t[1]=0;t[2]=0;t[3]=1;return t};n.fromValues=function(t,e,r,n){var o=new a.ARRAY_TYPE(4);o[0]=t;o[1]=e;o[2]=r;o[3]=n;return o};n.set=function(t,e,r,a,n){t[0]=e;t[1]=r;t[2]=a;t[3]=n;return t};n.transpose=function(t,e){if(t===e){var r=e[1];t[1]=e[2];t[2]=r}else{t[0]=e[0];t[1]=e[2];t[2]=e[1];t[3]=e[3]}return t};n.invert=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=r*o-n*a;if(!i){return null}i=1/i;t[0]=o*i;t[1]=-a*i;t[2]=-n*i;t[3]=r*i;return t};n.adjoint=function(t,e){var r=e[0];t[0]=e[3];t[1]=-e[1];t[2]=-e[2];t[3]=r;return t};n.determinant=function(t){return t[0]*t[3]-t[2]*t[1]};n.multiply=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3];var s=r[0],u=r[1],l=r[2],h=r[3];t[0]=a*s+o*u;t[1]=n*s+i*u;t[2]=a*l+o*h;t[3]=n*l+i*h;return t};n.mul=n.multiply;n.rotate=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],s=Math.sin(r),u=Math.cos(r);t[0]=a*u+o*s;t[1]=n*u+i*s;t[2]=a*-s+o*u;t[3]=n*-s+i*u;return t};n.scale=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],s=r[0],u=r[1];t[0]=a*s;t[1]=n*s;t[2]=o*u;t[3]=i*u;return t};n.fromRotation=function(t,e){var r=Math.sin(e),a=Math.cos(e);t[0]=a;t[1]=r;t[2]=-r;t[3]=a;return t};n.fromScaling=function(t,e){t[0]=e[0];t[1]=0;t[2]=0;t[3]=e[1];return t};n.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"};n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))};n.LDU=function(t,e,r,a){t[2]=a[2]/a[0];r[0]=a[0];r[1]=a[1];r[3]=a[3]-t[2]*r[1];return[t,e,r]};n.add=function(t,e,r){t[0]=e[0]+r[0];t[1]=e[1]+r[1];t[2]=e[2]+r[2];t[3]=e[3]+r[3];return t};n.subtract=function(t,e,r){t[0]=e[0]-r[0];t[1]=e[1]-r[1];t[2]=e[2]-r[2];t[3]=e[3]-r[3];return t};n.sub=n.subtract;n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]};n.equals=function(t,e){var r=t[0],n=t[1],o=t[2],i=t[3];var s=e[0],u=e[1],l=e[2],h=e[3];return Math.abs(r-s)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-u)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(o-l)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(i-h)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))};n.multiplyScalar=function(t,e,r){t[0]=e[0]*r;t[1]=e[1]*r;t[2]=e[2]*r;t[3]=e[3]*r;return t};n.multiplyScalarAndAdd=function(t,e,r,a){t[0]=e[0]+r[0]*a;t[1]=e[1]+r[1]*a;t[2]=e[2]+r[2]*a;t[3]=e[3]+r[3]*a;return t};t.exports=n},function(t,e,r){var a=r(5);var n={};n.create=function(){var t=new a.ARRAY_TYPE(6);t[0]=1;t[1]=0;t[2]=0;t[3]=1;t[4]=0;t[5]=0;return t};n.clone=function(t){var e=new a.ARRAY_TYPE(6);e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[4]=t[4];e[5]=t[5];return e};n.copy=function(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];return t};n.identity=function(t){t[0]=1;t[1]=0;t[2]=0;t[3]=1;t[4]=0;t[5]=0;return t};n.fromValues=function(t,e,r,n,o,i){var s=new a.ARRAY_TYPE(6);s[0]=t;s[1]=e;s[2]=r;s[3]=n;s[4]=o;s[5]=i;return s};n.set=function(t,e,r,a,n,o,i){t[0]=e;t[1]=r;t[2]=a;t[3]=n;t[4]=o;t[5]=i;return t};n.invert=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],s=e[5];var u=r*o-a*n;if(!u){return null}u=1/u;t[0]=o*u;t[1]=-a*u;t[2]=-n*u;t[3]=r*u;t[4]=(n*s-o*i)*u;t[5]=(a*i-r*s)*u;return t};n.determinant=function(t){return t[0]*t[3]-t[1]*t[2]};n.multiply=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],s=e[4],u=e[5],l=r[0],h=r[1],f=r[2],c=r[3],M=r[4],v=r[5];t[0]=a*l+o*h;t[1]=n*l+i*h;t[2]=a*f+o*c;t[3]=n*f+i*c;t[4]=a*M+o*v+s;t[5]=n*M+i*v+u;return t};n.mul=n.multiply;n.rotate=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],s=e[4],u=e[5],l=Math.sin(r),h=Math.cos(r);t[0]=a*h+o*l;t[1]=n*h+i*l;t[2]=a*-l+o*h;t[3]=n*-l+i*h;t[4]=s;t[5]=u;return t};n.scale=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],s=e[4],u=e[5],l=r[0],h=r[1];t[0]=a*l;t[1]=n*l;t[2]=o*h;t[3]=i*h;t[4]=s;t[5]=u;return t};n.translate=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],s=e[4],u=e[5],l=r[0],h=r[1];t[0]=a;t[1]=n;t[2]=o;t[3]=i;t[4]=a*l+o*h+s;t[5]=n*l+i*h+u;return t};n.fromRotation=function(t,e){var r=Math.sin(e),a=Math.cos(e);t[0]=a;t[1]=r;t[2]=-r;t[3]=a;t[4]=0;t[5]=0;return t};n.fromScaling=function(t,e){t[0]=e[0];t[1]=0;t[2]=0;t[3]=e[1];t[4]=0;t[5]=0;return t};n.fromTranslation=function(t,e){t[0]=1;t[1]=0;t[2]=0;t[3]=1;t[4]=e[0];t[5]=e[1];return t};n.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"};n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)};n.add=function(t,e,r){t[0]=e[0]+r[0];t[1]=e[1]+r[1];t[2]=e[2]+r[2];t[3]=e[3]+r[3];t[4]=e[4]+r[4];t[5]=e[5]+r[5];return t};n.subtract=function(t,e,r){t[0]=e[0]-r[0];t[1]=e[1]-r[1];t[2]=e[2]-r[2];t[3]=e[3]-r[3];t[4]=e[4]-r[4];t[5]=e[5]-r[5];return t};n.sub=n.subtract;n.multiplyScalar=function(t,e,r){t[0]=e[0]*r;t[1]=e[1]*r;t[2]=e[2]*r;t[3]=e[3]*r;t[4]=e[4]*r;t[5]=e[5]*r;return t};n.multiplyScalarAndAdd=function(t,e,r,a){t[0]=e[0]+r[0]*a;t[1]=e[1]+r[1]*a;t[2]=e[2]+r[2]*a;t[3]=e[3]+r[3]*a;t[4]=e[4]+r[4]*a;t[5]=e[5]+r[5]*a;return t};n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]};n.equals=function(t,e){var r=t[0],n=t[1],o=t[2],i=t[3],s=t[4],u=t[5];var l=e[0],h=e[1],f=e[2],c=e[3],M=e[4],v=e[5];return Math.abs(r-l)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(n-h)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(o-f)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(i-c)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(s-M)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(u-v)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))};t.exports=n},function(t,e,r){var a=r(5);var n={};n.create=function(){var t=new a.ARRAY_TYPE(9);t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=1;t[5]=0;t[6]=0;t[7]=0;t[8]=1;return t};n.fromMat4=function(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[4];t[4]=e[5];t[5]=e[6];t[6]=e[8];t[7]=e[9];t[8]=e[10];return t};n.clone=function(t){var e=new a.ARRAY_TYPE(9);e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];e[8]=t[8];return e};n.copy=function(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];return t};n.fromValues=function(t,e,r,n,o,i,s,u,l){var h=new a.ARRAY_TYPE(9);h[0]=t;h[1]=e;h[2]=r;h[3]=n;h[4]=o;h[5]=i;h[6]=s;h[7]=u;h[8]=l;return h};n.set=function(t,e,r,a,n,o,i,s,u,l){t[0]=e;t[1]=r;t[2]=a;t[3]=n;t[4]=o;t[5]=i;t[6]=s;t[7]=u;t[8]=l;return t};n.identity=function(t){t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=1;t[5]=0;t[6]=0;t[7]=0;t[8]=1;return t};n.transpose=function(t,e){if(t===e){var r=e[1],a=e[2],n=e[5];t[1]=e[3];t[2]=e[6];t[3]=r;t[5]=e[7];t[6]=a;t[7]=n}else{t[0]=e[0];t[1]=e[3];t[2]=e[6];t[3]=e[1];t[4]=e[4];t[5]=e[7];t[6]=e[2];t[7]=e[5];t[8]=e[8]}return t};n.invert=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],s=e[5],u=e[6],l=e[7],h=e[8],f=h*i-s*l,c=-h*o+s*u,M=l*o-i*u,v=r*f+a*c+n*M;if(!v){return null}v=1/v;t[0]=f*v;t[1]=(-h*a+n*l)*v;t[2]=(s*a-n*i)*v;t[3]=c*v;t[4]=(h*r-n*u)*v;t[5]=(-s*r+n*o)*v;t[6]=M*v;t[7]=(-l*r+a*u)*v;t[8]=(i*r-a*o)*v;return t};n.adjoint=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],s=e[5],u=e[6],l=e[7],h=e[8];t[0]=i*h-s*l;t[1]=n*l-a*h;t[2]=a*s-n*i;t[3]=s*u-o*h;t[4]=r*h-n*u;t[5]=n*o-r*s;t[6]=o*l-i*u;t[7]=a*u-r*l;t[8]=r*i-a*o;return t};n.determinant=function(t){var e=t[0],r=t[1],a=t[2],n=t[3],o=t[4],i=t[5],s=t[6],u=t[7],l=t[8];return e*(l*o-i*u)+r*(-l*n+i*s)+a*(u*n-o*s)};n.multiply=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],s=e[4],u=e[5],l=e[6],h=e[7],f=e[8],c=r[0],M=r[1],v=r[2],p=r[3],x=r[4],d=r[5],m=r[6],S=r[7],I=r[8];t[0]=c*a+M*i+v*l;t[1]=c*n+M*s+v*h;t[2]=c*o+M*u+v*f;t[3]=p*a+x*i+d*l;t[4]=p*n+x*s+d*h;t[5]=p*o+x*u+d*f;t[6]=m*a+S*i+I*l;t[7]=m*n+S*s+I*h;t[8]=m*o+S*u+I*f;return t};n.mul=n.multiply;n.translate=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],s=e[4],u=e[5],l=e[6],h=e[7],f=e[8],c=r[0],M=r[1];t[0]=a;t[1]=n;t[2]=o;t[3]=i;t[4]=s;t[5]=u;t[6]=c*a+M*i+l;t[7]=c*n+M*s+h;t[8]=c*o+M*u+f;return t};n.rotate=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],s=e[4],u=e[5],l=e[6],h=e[7],f=e[8],c=Math.sin(r),M=Math.cos(r);t[0]=M*a+c*i;t[1]=M*n+c*s;t[2]=M*o+c*u;t[3]=M*i-c*a;t[4]=M*s-c*n;t[5]=M*u-c*o;t[6]=l;t[7]=h;t[8]=f;return t};n.scale=function(t,e,r){var a=r[0],n=r[1];t[0]=a*e[0];t[1]=a*e[1];t[2]=a*e[2];t[3]=n*e[3];t[4]=n*e[4];t[5]=n*e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];return t};n.fromTranslation=function(t,e){t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=1;t[5]=0;t[6]=e[0];t[7]=e[1];t[8]=1;return t};n.fromRotation=function(t,e){var r=Math.sin(e),a=Math.cos(e);t[0]=a;t[1]=r;t[2]=0;t[3]=-r;t[4]=a;t[5]=0;t[6]=0;t[7]=0;t[8]=1;return t};n.fromScaling=function(t,e){t[0]=e[0];t[1]=0;t[2]=0;t[3]=0;t[4]=e[1];t[5]=0;t[6]=0;t[7]=0;t[8]=1;return t};n.fromMat2d=function(t,e){t[0]=e[0];t[1]=e[1];t[2]=0;t[3]=e[2];t[4]=e[3];t[5]=0;t[6]=e[4];t[7]=e[5];t[8]=1;return t};n.fromQuat=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=r+r,s=a+a,u=n+n,l=r*i,h=a*i,f=a*s,c=n*i,M=n*s,v=n*u,p=o*i,x=o*s,d=o*u;t[0]=1-f-v;t[3]=h-d;t[6]=c+x;t[1]=h+d;t[4]=1-l-v;t[7]=M-p;t[2]=c-x;t[5]=M+p;t[8]=1-l-f;return t};n.normalFromMat4=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],s=e[5],u=e[6],l=e[7],h=e[8],f=e[9],c=e[10],M=e[11],v=e[12],p=e[13],x=e[14],d=e[15],m=r*s-a*i,S=r*u-n*i,I=r*l-o*i,g=a*u-n*s,D=a*l-o*s,F=n*l-o*u,y=h*p-f*v,b=h*x-c*v,E=h*d-M*v,w=f*x-c*p,A=f*d-M*p,T=c*d-M*x,R=m*T-S*A+I*w+g*E-D*b+F*y;if(!R){return null}R=1/R;t[0]=(s*T-u*A+l*w)*R;t[1]=(u*E-i*T-l*b)*R;t[2]=(i*A-s*E+l*y)*R;t[3]=(n*A-a*T-o*w)*R;t[4]=(r*T-n*E+o*b)*R;t[5]=(a*E-r*A-o*y)*R;t[6]=(p*F-x*D+d*g)*R;t[7]=(x*I-v*F-d*S)*R;t[8]=(v*D-p*I+d*m)*R;return t};n.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"};n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))};n.add=function(t,e,r){t[0]=e[0]+r[0];t[1]=e[1]+r[1];t[2]=e[2]+r[2];t[3]=e[3]+r[3];t[4]=e[4]+r[4];t[5]=e[5]+r[5];t[6]=e[6]+r[6];t[7]=e[7]+r[7];t[8]=e[8]+r[8];return t};n.subtract=function(t,e,r){t[0]=e[0]-r[0];t[1]=e[1]-r[1];t[2]=e[2]-r[2];t[3]=e[3]-r[3];t[4]=e[4]-r[4];t[5]=e[5]-r[5];t[6]=e[6]-r[6];t[7]=e[7]-r[7];t[8]=e[8]-r[8];return t};n.sub=n.subtract;n.multiplyScalar=function(t,e,r){t[0]=e[0]*r;t[1]=e[1]*r;t[2]=e[2]*r;t[3]=e[3]*r;t[4]=e[4]*r;t[5]=e[5]*r;t[6]=e[6]*r;t[7]=e[7]*r;t[8]=e[8]*r;return t};n.multiplyScalarAndAdd=function(t,e,r,a){t[0]=e[0]+r[0]*a;t[1]=e[1]+r[1]*a;t[2]=e[2]+r[2]*a;t[3]=e[3]+r[3]*a;t[4]=e[4]+r[4]*a;t[5]=e[5]+r[5]*a;t[6]=e[6]+r[6]*a;t[7]=e[7]+r[7]*a;t[8]=e[8]+r[8]*a;return t};n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]};n.equals=function(t,e){var r=t[0],n=t[1],o=t[2],i=t[3],s=t[4],u=t[5],l=t[6],h=t[7],f=t[8];var c=e[0],M=e[1],v=e[2],p=e[3],x=e[4],d=e[5],m=t[6],S=e[7],I=e[8];return Math.abs(r-c)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(n-M)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(M))&&Math.abs(o-v)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(i-p)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(s-x)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(u-d)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(d))&&Math.abs(l-m)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(m))&&Math.abs(h-S)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(S))&&Math.abs(f-I)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(I))};t.exports=n},function(t,e,r){var a=r(5);var n={scalar:{},SIMD:{}};n.create=function(){var t=new a.ARRAY_TYPE(16);t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=1;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=1;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};n.clone=function(t){var e=new a.ARRAY_TYPE(16);e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];e[8]=t[8];e[9]=t[9];e[10]=t[10];e[11]=t[11];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15];return e};n.copy=function(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t};n.fromValues=function(t,e,r,n,o,i,s,u,l,h,f,c,M,v,p,x){var d=new a.ARRAY_TYPE(16);d[0]=t;d[1]=e;d[2]=r;d[3]=n;d[4]=o;d[5]=i;d[6]=s;d[7]=u;d[8]=l;d[9]=h;d[10]=f;d[11]=c;d[12]=M;d[13]=v;d[14]=p;d[15]=x;return d};n.set=function(t,e,r,a,n,o,i,s,u,l,h,f,c,M,v,p,x){t[0]=e;t[1]=r;t[2]=a;t[3]=n;t[4]=o;t[5]=i;t[6]=s;t[7]=u;t[8]=l;t[9]=h;t[10]=f;t[11]=c;t[12]=M;t[13]=v;t[14]=p;t[15]=x;return t};n.identity=function(t){t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=1;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=1;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};n.scalar.transpose=function(t,e){if(t===e){var r=e[1],a=e[2],n=e[3],o=e[6],i=e[7],s=e[11];t[1]=e[4];t[2]=e[8];t[3]=e[12];t[4]=r;t[6]=e[9];t[7]=e[13];t[8]=a;t[9]=o;t[11]=e[14];t[12]=n;t[13]=i;t[14]=s}else{t[0]=e[0];t[1]=e[4];t[2]=e[8];t[3]=e[12];t[4]=e[1];t[5]=e[5];t[6]=e[9];t[7]=e[13];t[8]=e[2];t[9]=e[6];t[10]=e[10];t[11]=e[14];t[12]=e[3];t[13]=e[7];t[14]=e[11];t[15]=e[15]}return t};n.SIMD.transpose=function(t,e){var r,a,n,o,i,s,u,l,h,f;r=SIMD.Float32x4.load(e,0);a=SIMD.Float32x4.load(e,4);n=SIMD.Float32x4.load(e,8);o=SIMD.Float32x4.load(e,12);i=SIMD.Float32x4.shuffle(r,a,0,1,4,5);s=SIMD.Float32x4.shuffle(n,o,0,1,4,5);u=SIMD.Float32x4.shuffle(i,s,0,2,4,6);l=SIMD.Float32x4.shuffle(i,s,1,3,5,7);SIMD.Float32x4.store(t,0,u);SIMD.Float32x4.store(t,4,l);i=SIMD.Float32x4.shuffle(r,a,2,3,6,7);s=SIMD.Float32x4.shuffle(n,o,2,3,6,7);h=SIMD.Float32x4.shuffle(i,s,0,2,4,6);f=SIMD.Float32x4.shuffle(i,s,1,3,5,7);SIMD.Float32x4.store(t,8,h);SIMD.Float32x4.store(t,12,f);return t};n.transpose=a.USE_SIMD?n.SIMD.transpose:n.scalar.transpose;n.scalar.invert=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],s=e[5],u=e[6],l=e[7],h=e[8],f=e[9],c=e[10],M=e[11],v=e[12],p=e[13],x=e[14],d=e[15],m=r*s-a*i,S=r*u-n*i,I=r*l-o*i,g=a*u-n*s,D=a*l-o*s,F=n*l-o*u,y=h*p-f*v,b=h*x-c*v,E=h*d-M*v,w=f*x-c*p,A=f*d-M*p,T=c*d-M*x,R=m*T-S*A+I*w+g*E-D*b+F*y;if(!R){return null}R=1/R;t[0]=(s*T-u*A+l*w)*R;t[1]=(n*A-a*T-o*w)*R;t[2]=(p*F-x*D+d*g)*R;t[3]=(c*D-f*F-M*g)*R;t[4]=(u*E-i*T-l*b)*R;t[5]=(r*T-n*E+o*b)*R;t[6]=(x*I-v*F-d*S)*R;t[7]=(h*F-c*I+M*S)*R;t[8]=(i*A-s*E+l*y)*R;t[9]=(a*E-r*A-o*y)*R;t[10]=(v*D-p*I+d*m)*R;t[11]=(f*I-h*D-M*m)*R;t[12]=(s*b-i*w-u*y)*R;t[13]=(r*w-a*b+n*y)*R;t[14]=(p*S-v*g-x*m)*R;t[15]=(h*g-f*S+c*m)*R;return t};n.SIMD.invert=function(t,e){var r,a,n,o,i,s,u,l,h,f,c=SIMD.Float32x4.load(e,0),M=SIMD.Float32x4.load(e,4),v=SIMD.Float32x4.load(e,8),p=SIMD.Float32x4.load(e,12);i=SIMD.Float32x4.shuffle(c,M,0,1,4,5);a=SIMD.Float32x4.shuffle(v,p,0,1,4,5);r=SIMD.Float32x4.shuffle(i,a,0,2,4,6);a=SIMD.Float32x4.shuffle(a,i,1,3,5,7);i=SIMD.Float32x4.shuffle(c,M,2,3,6,7);o=SIMD.Float32x4.shuffle(v,p,2,3,6,7);n=SIMD.Float32x4.shuffle(i,o,0,2,4,6);o=SIMD.Float32x4.shuffle(o,i,1,3,5,7);i=SIMD.Float32x4.mul(n,o);i=SIMD.Float32x4.swizzle(i,1,0,3,2);s=SIMD.Float32x4.mul(a,i);u=SIMD.Float32x4.mul(r,i);i=SIMD.Float32x4.swizzle(i,2,3,0,1);s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),s);u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),u);u=SIMD.Float32x4.swizzle(u,2,3,0,1);i=SIMD.Float32x4.mul(a,n);i=SIMD.Float32x4.swizzle(i,1,0,3,2);s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),s);h=SIMD.Float32x4.mul(r,i);i=SIMD.Float32x4.swizzle(i,2,3,0,1);s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(o,i));h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);i=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,2,3,0,1),o);i=SIMD.Float32x4.swizzle(i,1,0,3,2);n=SIMD.Float32x4.swizzle(n,2,3,0,1);s=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,i),s);l=SIMD.Float32x4.mul(r,i);i=SIMD.Float32x4.swizzle(i,2,3,0,1);s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(n,i));l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),l);l=SIMD.Float32x4.swizzle(l,2,3,0,1);i=SIMD.Float32x4.mul(r,a);i=SIMD.Float32x4.swizzle(i,1,0,3,2);l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),l);h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,i),h);i=SIMD.Float32x4.swizzle(i,2,3,0,1);l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,i),l);h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(n,i));i=SIMD.Float32x4.mul(r,o);i=SIMD.Float32x4.swizzle(i,1,0,3,2);u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(n,i));l=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),l);i=SIMD.Float32x4.swizzle(i,2,3,0,1);u=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,i),u);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(a,i));i=SIMD.Float32x4.mul(r,n);i=SIMD.Float32x4.swizzle(i,1,0,3,2);u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),u);h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(a,i));i=SIMD.Float32x4.swizzle(i,2,3,0,1);u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(o,i));h=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),h);f=SIMD.Float32x4.mul(r,s);f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,2,3,0,1),f);f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,1,0,3,2),f);i=SIMD.Float32x4.reciprocalApproximation(f);f=SIMD.Float32x4.sub(SIMD.Float32x4.add(i,i),SIMD.Float32x4.mul(f,SIMD.Float32x4.mul(i,i)));f=SIMD.Float32x4.swizzle(f,0,0,0,0);if(!f){return null}SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(f,s));SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(f,u));SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(f,l));SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(f,h));return t};n.invert=a.USE_SIMD?n.SIMD.invert:n.scalar.invert;n.scalar.adjoint=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],s=e[5],u=e[6],l=e[7],h=e[8],f=e[9],c=e[10],M=e[11],v=e[12],p=e[13],x=e[14],d=e[15];t[0]=s*(c*d-M*x)-f*(u*d-l*x)+p*(u*M-l*c);t[1]=-(a*(c*d-M*x)-f*(n*d-o*x)+p*(n*M-o*c));t[2]=a*(u*d-l*x)-s*(n*d-o*x)+p*(n*l-o*u);t[3]=-(a*(u*M-l*c)-s*(n*M-o*c)+f*(n*l-o*u));t[4]=-(i*(c*d-M*x)-h*(u*d-l*x)+v*(u*M-l*c));t[5]=r*(c*d-M*x)-h*(n*d-o*x)+v*(n*M-o*c);t[6]=-(r*(u*d-l*x)-i*(n*d-o*x)+v*(n*l-o*u));t[7]=r*(u*M-l*c)-i*(n*M-o*c)+h*(n*l-o*u);t[8]=i*(f*d-M*p)-h*(s*d-l*p)+v*(s*M-l*f);t[9]=-(r*(f*d-M*p)-h*(a*d-o*p)+v*(a*M-o*f));t[10]=r*(s*d-l*p)-i*(a*d-o*p)+v*(a*l-o*s);t[11]=-(r*(s*M-l*f)-i*(a*M-o*f)+h*(a*l-o*s));t[12]=-(i*(f*x-c*p)-h*(s*x-u*p)+v*(s*c-u*f));t[13]=r*(f*x-c*p)-h*(a*x-n*p)+v*(a*c-n*f);t[14]=-(r*(s*x-u*p)-i*(a*x-n*p)+v*(a*u-n*s));t[15]=r*(s*c-u*f)-i*(a*c-n*f)+h*(a*u-n*s);return t};n.SIMD.adjoint=function(t,e){var r,a,n,o;var i,s,u,l;var h;var f,c,M,v;var r=SIMD.Float32x4.load(e,0);var a=SIMD.Float32x4.load(e,4);var n=SIMD.Float32x4.load(e,8);var o=SIMD.Float32x4.load(e,12);h=SIMD.Float32x4.shuffle(r,a,0,1,4,5);s=SIMD.Float32x4.shuffle(n,o,0,1,4,5);i=SIMD.Float32x4.shuffle(h,s,0,2,4,6);s=SIMD.Float32x4.shuffle(s,h,1,3,5,7);h=SIMD.Float32x4.shuffle(r,a,2,3,6,7);l=SIMD.Float32x4.shuffle(n,o,2,3,6,7);u=SIMD.Float32x4.shuffle(h,l,0,2,4,6);l=SIMD.Float32x4.shuffle(l,h,1,3,5,7);h=SIMD.Float32x4.mul(u,l);h=SIMD.Float32x4.swizzle(h,1,0,3,2);f=SIMD.Float32x4.mul(s,h);c=SIMD.Float32x4.mul(i,h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,h),f);c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,h),c);c=SIMD.Float32x4.swizzle(c,2,3,0,1);h=SIMD.Float32x4.mul(s,u);h=SIMD.Float32x4.swizzle(h,1,0,3,2);f=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,h),f);v=SIMD.Float32x4.mul(i,h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(l,h));v=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,h),v);v=SIMD.Float32x4.swizzle(v,2,3,0,1);h=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,3,0,1),l);h=SIMD.Float32x4.swizzle(h,1,0,3,2);u=SIMD.Float32x4.swizzle(u,2,3,0,1);f=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,h),f);M=SIMD.Float32x4.mul(i,h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(u,h));M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,h),M);M=SIMD.Float32x4.swizzle(M,2,3,0,1);h=SIMD.Float32x4.mul(i,s);h=SIMD.Float32x4.swizzle(h,1,0,3,2);M=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,h),M);v=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,h),v);h=SIMD.Float32x4.swizzle(h,2,3,0,1);M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,h),M);v=SIMD.Float32x4.sub(v,SIMD.Float32x4.mul(u,h));h=SIMD.Float32x4.mul(i,l);h=SIMD.Float32x4.swizzle(h,1,0,3,2);c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(u,h));M=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,h),M);h=SIMD.Float32x4.swizzle(h,2,3,0,1);c=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,h),c);M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(s,h));h=SIMD.Float32x4.mul(i,u);h=SIMD.Float32x4.swizzle(h,1,0,3,2);c=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,h),c);v=SIMD.Float32x4.sub(v,SIMD.Float32x4.mul(s,h));h=SIMD.Float32x4.swizzle(h,2,3,0,1);c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(l,h));v=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,h),v);SIMD.Float32x4.store(t,0,f);SIMD.Float32x4.store(t,4,c);SIMD.Float32x4.store(t,8,M);SIMD.Float32x4.store(t,12,v);return t};n.adjoint=a.USE_SIMD?n.SIMD.adjoint:n.scalar.adjoint;n.determinant=function(t){var e=t[0],r=t[1],a=t[2],n=t[3],o=t[4],i=t[5],s=t[6],u=t[7],l=t[8],h=t[9],f=t[10],c=t[11],M=t[12],v=t[13],p=t[14],x=t[15],d=e*i-r*o,m=e*s-a*o,S=e*u-n*o,I=r*s-a*i,g=r*u-n*i,D=a*u-n*s,F=l*v-h*M,y=l*p-f*M,b=l*x-c*M,E=h*p-f*v,w=h*x-c*v,A=f*x-c*p;return d*A-m*w+S*E+I*b-g*y+D*F};n.SIMD.multiply=function(t,e,r){var a=SIMD.Float32x4.load(e,0);var n=SIMD.Float32x4.load(e,4);var o=SIMD.Float32x4.load(e,8);var i=SIMD.Float32x4.load(e,12);var s=SIMD.Float32x4.load(r,0);var u=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),i))));SIMD.Float32x4.store(t,0,u);var l=SIMD.Float32x4.load(r,4);var h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,3,3,3,3),i))));SIMD.Float32x4.store(t,4,h);var f=SIMD.Float32x4.load(r,8);var c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),i))));SIMD.Float32x4.store(t,8,c);var M=SIMD.Float32x4.load(r,12);var v=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(M,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(M,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(M,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(M,3,3,3,3),i))));
SIMD.Float32x4.store(t,12,v);return t};n.scalar.multiply=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],s=e[4],u=e[5],l=e[6],h=e[7],f=e[8],c=e[9],M=e[10],v=e[11],p=e[12],x=e[13],d=e[14],m=e[15];var S=r[0],I=r[1],g=r[2],D=r[3];t[0]=S*a+I*s+g*f+D*p;t[1]=S*n+I*u+g*c+D*x;t[2]=S*o+I*l+g*M+D*d;t[3]=S*i+I*h+g*v+D*m;S=r[4];I=r[5];g=r[6];D=r[7];t[4]=S*a+I*s+g*f+D*p;t[5]=S*n+I*u+g*c+D*x;t[6]=S*o+I*l+g*M+D*d;t[7]=S*i+I*h+g*v+D*m;S=r[8];I=r[9];g=r[10];D=r[11];t[8]=S*a+I*s+g*f+D*p;t[9]=S*n+I*u+g*c+D*x;t[10]=S*o+I*l+g*M+D*d;t[11]=S*i+I*h+g*v+D*m;S=r[12];I=r[13];g=r[14];D=r[15];t[12]=S*a+I*s+g*f+D*p;t[13]=S*n+I*u+g*c+D*x;t[14]=S*o+I*l+g*M+D*d;t[15]=S*i+I*h+g*v+D*m;return t};n.multiply=a.USE_SIMD?n.SIMD.multiply:n.scalar.multiply;n.mul=n.multiply;n.scalar.translate=function(t,e,r){var a=r[0],n=r[1],o=r[2],i,s,u,l,h,f,c,M,v,p,x,d;if(e===t){t[12]=e[0]*a+e[4]*n+e[8]*o+e[12];t[13]=e[1]*a+e[5]*n+e[9]*o+e[13];t[14]=e[2]*a+e[6]*n+e[10]*o+e[14];t[15]=e[3]*a+e[7]*n+e[11]*o+e[15]}else{i=e[0];s=e[1];u=e[2];l=e[3];h=e[4];f=e[5];c=e[6];M=e[7];v=e[8];p=e[9];x=e[10];d=e[11];t[0]=i;t[1]=s;t[2]=u;t[3]=l;t[4]=h;t[5]=f;t[6]=c;t[7]=M;t[8]=v;t[9]=p;t[10]=x;t[11]=d;t[12]=i*a+h*n+v*o+e[12];t[13]=s*a+f*n+p*o+e[13];t[14]=u*a+c*n+x*o+e[14];t[15]=l*a+M*n+d*o+e[15]}return t};n.SIMD.translate=function(t,e,r){var a=SIMD.Float32x4.load(e,0),n=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4(r[0],r[1],r[2],0);if(e!==t){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11]}a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(s,0,0,0,0));n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(s,1,1,1,1));o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(s,2,2,2,2));var u=SIMD.Float32x4.add(a,SIMD.Float32x4.add(n,SIMD.Float32x4.add(o,i)));SIMD.Float32x4.store(t,12,u);return t};n.translate=a.USE_SIMD?n.SIMD.translate:n.scalar.translate;n.scalar.scale=function(t,e,r){var a=r[0],n=r[1],o=r[2];t[0]=e[0]*a;t[1]=e[1]*a;t[2]=e[2]*a;t[3]=e[3]*a;t[4]=e[4]*n;t[5]=e[5]*n;t[6]=e[6]*n;t[7]=e[7]*n;t[8]=e[8]*o;t[9]=e[9]*o;t[10]=e[10]*o;t[11]=e[11]*o;t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t};n.SIMD.scale=function(t,e,r){var a,n,o;var i=SIMD.Float32x4(r[0],r[1],r[2],0);a=SIMD.Float32x4.load(e,0);SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(i,0,0,0,0)));n=SIMD.Float32x4.load(e,4);SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(i,1,1,1,1)));o=SIMD.Float32x4.load(e,8);SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(i,2,2,2,2)));t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t};n.scale=a.USE_SIMD?n.SIMD.scale:n.scalar.scale;n.rotate=function(t,e,r,n){var o=n[0],i=n[1],s=n[2],u=Math.sqrt(o*o+i*i+s*s),l,h,f,c,M,v,p,x,d,m,S,I,g,D,F,y,b,E,w,A,T,R,N,C;if(Math.abs(u)<a.EPSILON){return null}u=1/u;o*=u;i*=u;s*=u;l=Math.sin(r);h=Math.cos(r);f=1-h;c=e[0];M=e[1];v=e[2];p=e[3];x=e[4];d=e[5];m=e[6];S=e[7];I=e[8];g=e[9];D=e[10];F=e[11];y=o*o*f+h;b=i*o*f+s*l;E=s*o*f-i*l;w=o*i*f-s*l;A=i*i*f+h;T=s*i*f+o*l;R=o*s*f+i*l;N=i*s*f-o*l;C=s*s*f+h;t[0]=c*y+x*b+I*E;t[1]=M*y+d*b+g*E;t[2]=v*y+m*b+D*E;t[3]=p*y+S*b+F*E;t[4]=c*w+x*A+I*T;t[5]=M*w+d*A+g*T;t[6]=v*w+m*A+D*T;t[7]=p*w+S*A+F*T;t[8]=c*R+x*N+I*C;t[9]=M*R+d*N+g*C;t[10]=v*R+m*N+D*C;t[11]=p*R+S*N+F*C;if(e!==t){t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15]}return t};n.scalar.rotateX=function(t,e,r){var a=Math.sin(r),n=Math.cos(r),o=e[4],i=e[5],s=e[6],u=e[7],l=e[8],h=e[9],f=e[10],c=e[11];if(e!==t){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15]}t[4]=o*n+l*a;t[5]=i*n+h*a;t[6]=s*n+f*a;t[7]=u*n+c*a;t[8]=l*n-o*a;t[9]=h*n-i*a;t[10]=f*n-s*a;t[11]=c*n-u*a;return t};n.SIMD.rotateX=function(t,e,r){var a=SIMD.Float32x4.splat(Math.sin(r)),n=SIMD.Float32x4.splat(Math.cos(r));if(e!==t){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15]}var o=SIMD.Float32x4.load(e,4);var i=SIMD.Float32x4.load(e,8);SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(i,a)));SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,n),SIMD.Float32x4.mul(o,a)));return t};n.rotateX=a.USE_SIMD?n.SIMD.rotateX:n.scalar.rotateX;n.scalar.rotateY=function(t,e,r){var a=Math.sin(r),n=Math.cos(r),o=e[0],i=e[1],s=e[2],u=e[3],l=e[8],h=e[9],f=e[10],c=e[11];if(e!==t){t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15]}t[0]=o*n-l*a;t[1]=i*n-h*a;t[2]=s*n-f*a;t[3]=u*n-c*a;t[8]=o*a+l*n;t[9]=i*a+h*n;t[10]=s*a+f*n;t[11]=u*a+c*n;return t};n.SIMD.rotateY=function(t,e,r){var a=SIMD.Float32x4.splat(Math.sin(r)),n=SIMD.Float32x4.splat(Math.cos(r));if(e!==t){t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15]}var o=SIMD.Float32x4.load(e,0);var i=SIMD.Float32x4.load(e,8);SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(i,a)));SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,n)));return t};n.rotateY=a.USE_SIMD?n.SIMD.rotateY:n.scalar.rotateY;n.scalar.rotateZ=function(t,e,r){var a=Math.sin(r),n=Math.cos(r),o=e[0],i=e[1],s=e[2],u=e[3],l=e[4],h=e[5],f=e[6],c=e[7];if(e!==t){t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15]}t[0]=o*n+l*a;t[1]=i*n+h*a;t[2]=s*n+f*a;t[3]=u*n+c*a;t[4]=l*n-o*a;t[5]=h*n-i*a;t[6]=f*n-s*a;t[7]=c*n-u*a;return t};n.SIMD.rotateZ=function(t,e,r){var a=SIMD.Float32x4.splat(Math.sin(r)),n=SIMD.Float32x4.splat(Math.cos(r));if(e!==t){t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15]}var o=SIMD.Float32x4.load(e,0);var i=SIMD.Float32x4.load(e,4);SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(i,a)));SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,n),SIMD.Float32x4.mul(o,a)));return t};n.rotateZ=a.USE_SIMD?n.SIMD.rotateZ:n.scalar.rotateZ;n.fromTranslation=function(t,e){t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=1;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=1;t[11]=0;t[12]=e[0];t[13]=e[1];t[14]=e[2];t[15]=1;return t};n.fromScaling=function(t,e){t[0]=e[0];t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=e[1];t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=e[2];t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};n.fromRotation=function(t,e,r){var n=r[0],o=r[1],i=r[2],s=Math.sqrt(n*n+o*o+i*i),u,l,h;if(Math.abs(s)<a.EPSILON){return null}s=1/s;n*=s;o*=s;i*=s;u=Math.sin(e);l=Math.cos(e);h=1-l;t[0]=n*n*h+l;t[1]=o*n*h+i*u;t[2]=i*n*h-o*u;t[3]=0;t[4]=n*o*h-i*u;t[5]=o*o*h+l;t[6]=i*o*h+n*u;t[7]=0;t[8]=n*i*h+o*u;t[9]=o*i*h-n*u;t[10]=i*i*h+l;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};n.fromXRotation=function(t,e){var r=Math.sin(e),a=Math.cos(e);t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=a;t[6]=r;t[7]=0;t[8]=0;t[9]=-r;t[10]=a;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};n.fromYRotation=function(t,e){var r=Math.sin(e),a=Math.cos(e);t[0]=a;t[1]=0;t[2]=-r;t[3]=0;t[4]=0;t[5]=1;t[6]=0;t[7]=0;t[8]=r;t[9]=0;t[10]=a;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};n.fromZRotation=function(t,e){var r=Math.sin(e),a=Math.cos(e);t[0]=a;t[1]=r;t[2]=0;t[3]=0;t[4]=-r;t[5]=a;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=1;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};n.fromRotationTranslation=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],s=a+a,u=n+n,l=o+o,h=a*s,f=a*u,c=a*l,M=n*u,v=n*l,p=o*l,x=i*s,d=i*u,m=i*l;t[0]=1-(M+p);t[1]=f+m;t[2]=c-d;t[3]=0;t[4]=f-m;t[5]=1-(h+p);t[6]=v+x;t[7]=0;t[8]=c+d;t[9]=v-x;t[10]=1-(h+M);t[11]=0;t[12]=r[0];t[13]=r[1];t[14]=r[2];t[15]=1;return t};n.getTranslation=function(t,e){t[0]=e[12];t[1]=e[13];t[2]=e[14];return t};n.getRotation=function(t,e){var r=e[0]+e[5]+e[10];var a=0;if(r>0){a=Math.sqrt(r+1)*2;t[3]=.25*a;t[0]=(e[6]-e[9])/a;t[1]=(e[8]-e[2])/a;t[2]=(e[1]-e[4])/a}else if(e[0]>e[5]&e[0]>e[10]){a=Math.sqrt(1+e[0]-e[5]-e[10])*2;t[3]=(e[6]-e[9])/a;t[0]=.25*a;t[1]=(e[1]+e[4])/a;t[2]=(e[8]+e[2])/a}else if(e[5]>e[10]){a=Math.sqrt(1+e[5]-e[0]-e[10])*2;t[3]=(e[8]-e[2])/a;t[0]=(e[1]+e[4])/a;t[1]=.25*a;t[2]=(e[6]+e[9])/a}else{a=Math.sqrt(1+e[10]-e[0]-e[5])*2;t[3]=(e[1]-e[4])/a;t[0]=(e[8]+e[2])/a;t[1]=(e[6]+e[9])/a;t[2]=.25*a}return t};n.fromRotationTranslationScale=function(t,e,r,a){var n=e[0],o=e[1],i=e[2],s=e[3],u=n+n,l=o+o,h=i+i,f=n*u,c=n*l,M=n*h,v=o*l,p=o*h,x=i*h,d=s*u,m=s*l,S=s*h,I=a[0],g=a[1],D=a[2];t[0]=(1-(v+x))*I;t[1]=(c+S)*I;t[2]=(M-m)*I;t[3]=0;t[4]=(c-S)*g;t[5]=(1-(f+x))*g;t[6]=(p+d)*g;t[7]=0;t[8]=(M+m)*D;t[9]=(p-d)*D;t[10]=(1-(f+v))*D;t[11]=0;t[12]=r[0];t[13]=r[1];t[14]=r[2];t[15]=1;return t};n.fromRotationTranslationScaleOrigin=function(t,e,r,a,n){var o=e[0],i=e[1],s=e[2],u=e[3],l=o+o,h=i+i,f=s+s,c=o*l,M=o*h,v=o*f,p=i*h,x=i*f,d=s*f,m=u*l,S=u*h,I=u*f,g=a[0],D=a[1],F=a[2],y=n[0],b=n[1],E=n[2];t[0]=(1-(p+d))*g;t[1]=(M+I)*g;t[2]=(v-S)*g;t[3]=0;t[4]=(M-I)*D;t[5]=(1-(c+d))*D;t[6]=(x+m)*D;t[7]=0;t[8]=(v+S)*F;t[9]=(x-m)*F;t[10]=(1-(c+p))*F;t[11]=0;t[12]=r[0]+y-(t[0]*y+t[4]*b+t[8]*E);t[13]=r[1]+b-(t[1]*y+t[5]*b+t[9]*E);t[14]=r[2]+E-(t[2]*y+t[6]*b+t[10]*E);t[15]=1;return t};n.fromQuat=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=r+r,s=a+a,u=n+n,l=r*i,h=a*i,f=a*s,c=n*i,M=n*s,v=n*u,p=o*i,x=o*s,d=o*u;t[0]=1-f-v;t[1]=h+d;t[2]=c-x;t[3]=0;t[4]=h-d;t[5]=1-l-v;t[6]=M+p;t[7]=0;t[8]=c+x;t[9]=M-p;t[10]=1-l-f;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};n.frustum=function(t,e,r,a,n,o,i){var s=1/(r-e),u=1/(n-a),l=1/(o-i);t[0]=o*2*s;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=o*2*u;t[6]=0;t[7]=0;t[8]=(r+e)*s;t[9]=(n+a)*u;t[10]=(i+o)*l;t[11]=-1;t[12]=0;t[13]=0;t[14]=i*o*2*l;t[15]=0;return t};n.perspective=function(t,e,r,a,n){var o=1/Math.tan(e/2),i=1/(a-n);t[0]=o/r;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=o;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=(n+a)*i;t[11]=-1;t[12]=0;t[13]=0;t[14]=2*n*a*i;t[15]=0;return t};n.perspectiveFromFieldOfView=function(t,e,r,a){var n=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(i+s),l=2/(n+o);t[0]=u;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=l;t[6]=0;t[7]=0;t[8]=-((i-s)*u*.5);t[9]=(n-o)*l*.5;t[10]=a/(r-a);t[11]=-1;t[12]=0;t[13]=0;t[14]=a*r/(r-a);t[15]=0;return t};n.ortho=function(t,e,r,a,n,o,i){var s=1/(e-r),u=1/(a-n),l=1/(o-i);t[0]=-2*s;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=-2*u;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=2*l;t[11]=0;t[12]=(e+r)*s;t[13]=(n+a)*u;t[14]=(i+o)*l;t[15]=1;return t};n.lookAt=function(t,e,r,o){var i,s,u,l,h,f,c,M,v,p,x=e[0],d=e[1],m=e[2],S=o[0],I=o[1],g=o[2],D=r[0],F=r[1],y=r[2];if(Math.abs(x-D)<a.EPSILON&&Math.abs(d-F)<a.EPSILON&&Math.abs(m-y)<a.EPSILON){return n.identity(t)}c=x-D;M=d-F;v=m-y;p=1/Math.sqrt(c*c+M*M+v*v);c*=p;M*=p;v*=p;i=I*v-g*M;s=g*c-S*v;u=S*M-I*c;p=Math.sqrt(i*i+s*s+u*u);if(!p){i=0;s=0;u=0}else{p=1/p;i*=p;s*=p;u*=p}l=M*u-v*s;h=v*i-c*u;f=c*s-M*i;p=Math.sqrt(l*l+h*h+f*f);if(!p){l=0;h=0;f=0}else{p=1/p;l*=p;h*=p;f*=p}t[0]=i;t[1]=l;t[2]=c;t[3]=0;t[4]=s;t[5]=h;t[6]=M;t[7]=0;t[8]=u;t[9]=f;t[10]=v;t[11]=0;t[12]=-(i*x+s*d+u*m);t[13]=-(l*x+h*d+f*m);t[14]=-(c*x+M*d+v*m);t[15]=1;return t};n.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"};n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))};n.add=function(t,e,r){t[0]=e[0]+r[0];t[1]=e[1]+r[1];t[2]=e[2]+r[2];t[3]=e[3]+r[3];t[4]=e[4]+r[4];t[5]=e[5]+r[5];t[6]=e[6]+r[6];t[7]=e[7]+r[7];t[8]=e[8]+r[8];t[9]=e[9]+r[9];t[10]=e[10]+r[10];t[11]=e[11]+r[11];t[12]=e[12]+r[12];t[13]=e[13]+r[13];t[14]=e[14]+r[14];t[15]=e[15]+r[15];return t};n.subtract=function(t,e,r){t[0]=e[0]-r[0];t[1]=e[1]-r[1];t[2]=e[2]-r[2];t[3]=e[3]-r[3];t[4]=e[4]-r[4];t[5]=e[5]-r[5];t[6]=e[6]-r[6];t[7]=e[7]-r[7];t[8]=e[8]-r[8];t[9]=e[9]-r[9];t[10]=e[10]-r[10];t[11]=e[11]-r[11];t[12]=e[12]-r[12];t[13]=e[13]-r[13];t[14]=e[14]-r[14];t[15]=e[15]-r[15];return t};n.sub=n.subtract;n.multiplyScalar=function(t,e,r){t[0]=e[0]*r;t[1]=e[1]*r;t[2]=e[2]*r;t[3]=e[3]*r;t[4]=e[4]*r;t[5]=e[5]*r;t[6]=e[6]*r;t[7]=e[7]*r;t[8]=e[8]*r;t[9]=e[9]*r;t[10]=e[10]*r;t[11]=e[11]*r;t[12]=e[12]*r;t[13]=e[13]*r;t[14]=e[14]*r;t[15]=e[15]*r;return t};n.multiplyScalarAndAdd=function(t,e,r,a){t[0]=e[0]+r[0]*a;t[1]=e[1]+r[1]*a;t[2]=e[2]+r[2]*a;t[3]=e[3]+r[3]*a;t[4]=e[4]+r[4]*a;t[5]=e[5]+r[5]*a;t[6]=e[6]+r[6]*a;t[7]=e[7]+r[7]*a;t[8]=e[8]+r[8]*a;t[9]=e[9]+r[9]*a;t[10]=e[10]+r[10]*a;t[11]=e[11]+r[11]*a;t[12]=e[12]+r[12]*a;t[13]=e[13]+r[13]*a;t[14]=e[14]+r[14]*a;t[15]=e[15]+r[15]*a;return t};n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]};n.equals=function(t,e){var r=t[0],n=t[1],o=t[2],i=t[3],s=t[4],u=t[5],l=t[6],h=t[7],f=t[8],c=t[9],M=t[10],v=t[11],p=t[12],x=t[13],d=t[14],m=t[15];var S=e[0],I=e[1],g=e[2],D=e[3],F=e[4],y=e[5],b=e[6],E=e[7],w=e[8],A=e[9],T=e[10],R=e[11],N=e[12],C=e[13],P=e[14],L=e[15];return Math.abs(r-S)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(S))&&Math.abs(n-I)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(I))&&Math.abs(o-g)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(i-D)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(D))&&Math.abs(s-F)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(F))&&Math.abs(u-y)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(l-b)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(h-E)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(f-w)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(w))&&Math.abs(c-A)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(M-T)<=a.EPSILON*Math.max(1,Math.abs(M),Math.abs(T))&&Math.abs(v-R)<=a.EPSILON*Math.max(1,Math.abs(v),Math.abs(R))&&Math.abs(p-N)<=a.EPSILON*Math.max(1,Math.abs(p),Math.abs(N))&&Math.abs(x-C)<=a.EPSILON*Math.max(1,Math.abs(x),Math.abs(C))&&Math.abs(d-P)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(m-L)<=a.EPSILON*Math.max(1,Math.abs(m),Math.abs(L))};t.exports=n},function(t,e,r){var a=r(5);var n=r(8);var o=r(11);var i=r(12);var s={};s.create=function(){var t=new a.ARRAY_TYPE(4);t[0]=0;t[1]=0;t[2]=0;t[3]=1;return t};s.rotationTo=function(){var t=o.create();var e=o.fromValues(1,0,0);var r=o.fromValues(0,1,0);return function(a,n,i){var u=o.dot(n,i);if(u<-.999999){o.cross(t,e,n);if(o.length(t)<1e-6)o.cross(t,r,n);o.normalize(t,t);s.setAxisAngle(a,t,Math.PI);return a}else if(u>.999999){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}else{o.cross(t,n,i);a[0]=t[0];a[1]=t[1];a[2]=t[2];a[3]=1+u;return s.normalize(a,a)}}}();s.setAxes=function(){var t=n.create();return function(e,r,a,n){t[0]=a[0];t[3]=a[1];t[6]=a[2];t[1]=n[0];t[4]=n[1];t[7]=n[2];t[2]=-r[0];t[5]=-r[1];t[8]=-r[2];return s.normalize(e,s.fromMat3(e,t))}}();s.clone=i.clone;s.fromValues=i.fromValues;s.copy=i.copy;s.set=i.set;s.identity=function(t){t[0]=0;t[1]=0;t[2]=0;t[3]=1;return t};s.setAxisAngle=function(t,e,r){r=r*.5;var a=Math.sin(r);t[0]=a*e[0];t[1]=a*e[1];t[2]=a*e[2];t[3]=Math.cos(r);return t};s.getAxisAngle=function(t,e){var r=Math.acos(e[3])*2;var a=Math.sin(r/2);if(a!=0){t[0]=e[0]/a;t[1]=e[1]/a;t[2]=e[2]/a}else{t[0]=1;t[1]=0;t[2]=0}return r};s.add=i.add;s.multiply=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],s=r[0],u=r[1],l=r[2],h=r[3];t[0]=a*h+i*s+n*l-o*u;t[1]=n*h+i*u+o*s-a*l;t[2]=o*h+i*l+a*u-n*s;t[3]=i*h-a*s-n*u-o*l;return t};s.mul=s.multiply;s.scale=i.scale;s.rotateX=function(t,e,r){r*=.5;var a=e[0],n=e[1],o=e[2],i=e[3],s=Math.sin(r),u=Math.cos(r);t[0]=a*u+i*s;t[1]=n*u+o*s;t[2]=o*u-n*s;t[3]=i*u-a*s;return t};s.rotateY=function(t,e,r){r*=.5;var a=e[0],n=e[1],o=e[2],i=e[3],s=Math.sin(r),u=Math.cos(r);t[0]=a*u-o*s;t[1]=n*u+i*s;t[2]=o*u+a*s;t[3]=i*u-n*s;return t};s.rotateZ=function(t,e,r){r*=.5;var a=e[0],n=e[1],o=e[2],i=e[3],s=Math.sin(r),u=Math.cos(r);t[0]=a*u+n*s;t[1]=n*u-a*s;t[2]=o*u+i*s;t[3]=i*u-o*s;return t};s.calculateW=function(t,e){var r=e[0],a=e[1],n=e[2];t[0]=r;t[1]=a;t[2]=n;t[3]=Math.sqrt(Math.abs(1-r*r-a*a-n*n));return t};s.dot=i.dot;s.lerp=i.lerp;s.slerp=function(t,e,r,a){var n=e[0],o=e[1],i=e[2],s=e[3],u=r[0],l=r[1],h=r[2],f=r[3];var c,M,v,p,x;M=n*u+o*l+i*h+s*f;if(M<0){M=-M;u=-u;l=-l;h=-h;f=-f}if(1-M>1e-6){c=Math.acos(M);v=Math.sin(c);p=Math.sin((1-a)*c)/v;x=Math.sin(a*c)/v}else{p=1-a;x=a}t[0]=p*n+x*u;t[1]=p*o+x*l;t[2]=p*i+x*h;t[3]=p*s+x*f;return t};s.sqlerp=function(){var t=s.create();var e=s.create();return function(r,a,n,o,i,u){s.slerp(t,a,i,u);s.slerp(e,n,o,u);s.slerp(r,t,e,2*u*(1-u));return r}}();s.invert=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=r*r+a*a+n*n+o*o,s=i?1/i:0;t[0]=-r*s;t[1]=-a*s;t[2]=-n*s;t[3]=o*s;return t};s.conjugate=function(t,e){t[0]=-e[0];t[1]=-e[1];t[2]=-e[2];t[3]=e[3];return t};s.length=i.length;s.len=s.length;s.squaredLength=i.squaredLength;s.sqrLen=s.squaredLength;s.normalize=i.normalize;s.fromMat3=function(t,e){var r=e[0]+e[4]+e[8];var a;if(r>0){a=Math.sqrt(r+1);t[3]=.5*a;a=.5/a;t[0]=(e[5]-e[7])*a;t[1]=(e[6]-e[2])*a;t[2]=(e[1]-e[3])*a}else{var n=0;if(e[4]>e[0])n=1;if(e[8]>e[n*3+n])n=2;var o=(n+1)%3;var i=(n+2)%3;a=Math.sqrt(e[n*3+n]-e[o*3+o]-e[i*3+i]+1);t[n]=.5*a;a=.5/a;t[3]=(e[o*3+i]-e[i*3+o])*a;t[o]=(e[o*3+n]+e[n*3+o])*a;t[i]=(e[i*3+n]+e[n*3+i])*a}return t};s.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"};s.exactEquals=i.exactEquals;s.equals=i.equals;t.exports=s},function(t,e,r){var a=r(5);var n={};n.create=function(){var t=new a.ARRAY_TYPE(3);t[0]=0;t[1]=0;t[2]=0;return t};n.clone=function(t){var e=new a.ARRAY_TYPE(3);e[0]=t[0];e[1]=t[1];e[2]=t[2];return e};n.fromValues=function(t,e,r){var n=new a.ARRAY_TYPE(3);n[0]=t;n[1]=e;n[2]=r;return n};n.copy=function(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];return t};n.set=function(t,e,r,a){t[0]=e;t[1]=r;t[2]=a;return t};n.add=function(t,e,r){t[0]=e[0]+r[0];t[1]=e[1]+r[1];t[2]=e[2]+r[2];return t};n.subtract=function(t,e,r){t[0]=e[0]-r[0];t[1]=e[1]-r[1];t[2]=e[2]-r[2];return t};n.sub=n.subtract;n.multiply=function(t,e,r){t[0]=e[0]*r[0];t[1]=e[1]*r[1];t[2]=e[2]*r[2];return t};n.mul=n.multiply;n.divide=function(t,e,r){t[0]=e[0]/r[0];t[1]=e[1]/r[1];t[2]=e[2]/r[2];return t};n.div=n.divide;n.ceil=function(t,e){t[0]=Math.ceil(e[0]);t[1]=Math.ceil(e[1]);t[2]=Math.ceil(e[2]);return t};n.floor=function(t,e){t[0]=Math.floor(e[0]);t[1]=Math.floor(e[1]);t[2]=Math.floor(e[2]);return t};n.min=function(t,e,r){t[0]=Math.min(e[0],r[0]);t[1]=Math.min(e[1],r[1]);t[2]=Math.min(e[2],r[2]);return t};n.max=function(t,e,r){t[0]=Math.max(e[0],r[0]);t[1]=Math.max(e[1],r[1]);t[2]=Math.max(e[2],r[2]);return t};n.round=function(t,e){t[0]=Math.round(e[0]);t[1]=Math.round(e[1]);t[2]=Math.round(e[2]);return t};n.scale=function(t,e,r){t[0]=e[0]*r;t[1]=e[1]*r;t[2]=e[2]*r;return t};n.scaleAndAdd=function(t,e,r,a){t[0]=e[0]+r[0]*a;t[1]=e[1]+r[1]*a;t[2]=e[2]+r[2]*a;return t};n.distance=function(t,e){var r=e[0]-t[0],a=e[1]-t[1],n=e[2]-t[2];return Math.sqrt(r*r+a*a+n*n)};n.dist=n.distance;n.squaredDistance=function(t,e){var r=e[0]-t[0],a=e[1]-t[1],n=e[2]-t[2];return r*r+a*a+n*n};n.sqrDist=n.squaredDistance;n.length=function(t){var e=t[0],r=t[1],a=t[2];return Math.sqrt(e*e+r*r+a*a)};n.len=n.length;n.squaredLength=function(t){var e=t[0],r=t[1],a=t[2];return e*e+r*r+a*a};n.sqrLen=n.squaredLength;n.negate=function(t,e){t[0]=-e[0];t[1]=-e[1];t[2]=-e[2];return t};n.inverse=function(t,e){t[0]=1/e[0];t[1]=1/e[1];t[2]=1/e[2];return t};n.normalize=function(t,e){var r=e[0],a=e[1],n=e[2];var o=r*r+a*a+n*n;if(o>0){o=1/Math.sqrt(o);t[0]=e[0]*o;t[1]=e[1]*o;t[2]=e[2]*o}return t};n.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]};n.cross=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=r[0],s=r[1],u=r[2];t[0]=n*u-o*s;t[1]=o*i-a*u;t[2]=a*s-n*i;return t};n.lerp=function(t,e,r,a){var n=e[0],o=e[1],i=e[2];t[0]=n+a*(r[0]-n);t[1]=o+a*(r[1]-o);t[2]=i+a*(r[2]-i);return t};n.hermite=function(t,e,r,a,n,o){var i=o*o,s=i*(2*o-3)+1,u=i*(o-2)+o,l=i*(o-1),h=i*(3-2*o);t[0]=e[0]*s+r[0]*u+a[0]*l+n[0]*h;t[1]=e[1]*s+r[1]*u+a[1]*l+n[1]*h;t[2]=e[2]*s+r[2]*u+a[2]*l+n[2]*h;return t};n.bezier=function(t,e,r,a,n,o){var i=1-o,s=i*i,u=o*o,l=s*i,h=3*o*s,f=3*u*i,c=u*o;t[0]=e[0]*l+r[0]*h+a[0]*f+n[0]*c;t[1]=e[1]*l+r[1]*h+a[1]*f+n[1]*c;t[2]=e[2]*l+r[2]*h+a[2]*f+n[2]*c;return t};n.random=function(t,e){e=e||1;var r=a.RANDOM()*2*Math.PI;var n=a.RANDOM()*2-1;var o=Math.sqrt(1-n*n)*e;t[0]=Math.cos(r)*o;t[1]=Math.sin(r)*o;t[2]=n*e;return t};n.transformMat4=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=r[3]*a+r[7]*n+r[11]*o+r[15];i=i||1;t[0]=(r[0]*a+r[4]*n+r[8]*o+r[12])/i;t[1]=(r[1]*a+r[5]*n+r[9]*o+r[13])/i;t[2]=(r[2]*a+r[6]*n+r[10]*o+r[14])/i;return t};n.transformMat3=function(t,e,r){var a=e[0],n=e[1],o=e[2];t[0]=a*r[0]+n*r[3]+o*r[6];t[1]=a*r[1]+n*r[4]+o*r[7];t[2]=a*r[2]+n*r[5]+o*r[8];return t};n.transformQuat=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=r[0],s=r[1],u=r[2],l=r[3],h=l*a+s*o-u*n,f=l*n+u*a-i*o,c=l*o+i*n-s*a,M=-i*a-s*n-u*o;t[0]=h*l+M*-i+f*-u-c*-s;t[1]=f*l+M*-s+c*-i-h*-u;t[2]=c*l+M*-u+h*-s-f*-i;return t};n.rotateX=function(t,e,r,a){var n=[],o=[];n[0]=e[0]-r[0];n[1]=e[1]-r[1];n[2]=e[2]-r[2];o[0]=n[0];o[1]=n[1]*Math.cos(a)-n[2]*Math.sin(a);o[2]=n[1]*Math.sin(a)+n[2]*Math.cos(a);t[0]=o[0]+r[0];t[1]=o[1]+r[1];t[2]=o[2]+r[2];return t};n.rotateY=function(t,e,r,a){var n=[],o=[];n[0]=e[0]-r[0];n[1]=e[1]-r[1];n[2]=e[2]-r[2];o[0]=n[2]*Math.sin(a)+n[0]*Math.cos(a);o[1]=n[1];o[2]=n[2]*Math.cos(a)-n[0]*Math.sin(a);t[0]=o[0]+r[0];t[1]=o[1]+r[1];t[2]=o[2]+r[2];return t};n.rotateZ=function(t,e,r,a){var n=[],o=[];n[0]=e[0]-r[0];n[1]=e[1]-r[1];n[2]=e[2]-r[2];o[0]=n[0]*Math.cos(a)-n[1]*Math.sin(a);o[1]=n[0]*Math.sin(a)+n[1]*Math.cos(a);o[2]=n[2];t[0]=o[0]+r[0];t[1]=o[1]+r[1];t[2]=o[2]+r[2];return t};n.forEach=function(){var t=n.create();return function(e,r,a,n,o,i){var s,u;if(!r){r=3}if(!a){a=0}if(n){u=Math.min(n*r+a,e.length)}else{u=e.length}for(s=a;s<u;s+=r){t[0]=e[s];t[1]=e[s+1];t[2]=e[s+2];o(t,t,i);e[s]=t[0];e[s+1]=t[1];e[s+2]=t[2]}return e}}();n.angle=function(t,e){var r=n.fromValues(t[0],t[1],t[2]);var a=n.fromValues(e[0],e[1],e[2]);n.normalize(r,r);n.normalize(a,a);var o=n.dot(r,a);if(o>1){return 0}else{return Math.acos(o)}};n.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"};n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]};n.equals=function(t,e){var r=t[0],n=t[1],o=t[2];var i=e[0],s=e[1],u=e[2];return Math.abs(r-i)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-s)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(o-u)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))};t.exports=n},function(t,e,r){var a=r(5);var n={};n.create=function(){var t=new a.ARRAY_TYPE(4);t[0]=0;t[1]=0;t[2]=0;t[3]=0;return t};n.clone=function(t){var e=new a.ARRAY_TYPE(4);e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];return e};n.fromValues=function(t,e,r,n){var o=new a.ARRAY_TYPE(4);o[0]=t;o[1]=e;o[2]=r;o[3]=n;return o};n.copy=function(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];return t};n.set=function(t,e,r,a,n){t[0]=e;t[1]=r;t[2]=a;t[3]=n;return t};n.add=function(t,e,r){t[0]=e[0]+r[0];t[1]=e[1]+r[1];t[2]=e[2]+r[2];t[3]=e[3]+r[3];return t};n.subtract=function(t,e,r){t[0]=e[0]-r[0];t[1]=e[1]-r[1];t[2]=e[2]-r[2];t[3]=e[3]-r[3];return t};n.sub=n.subtract;n.multiply=function(t,e,r){t[0]=e[0]*r[0];t[1]=e[1]*r[1];t[2]=e[2]*r[2];t[3]=e[3]*r[3];return t};n.mul=n.multiply;n.divide=function(t,e,r){t[0]=e[0]/r[0];t[1]=e[1]/r[1];t[2]=e[2]/r[2];t[3]=e[3]/r[3];return t};n.div=n.divide;n.ceil=function(t,e){t[0]=Math.ceil(e[0]);t[1]=Math.ceil(e[1]);t[2]=Math.ceil(e[2]);t[3]=Math.ceil(e[3]);return t};n.floor=function(t,e){t[0]=Math.floor(e[0]);t[1]=Math.floor(e[1]);t[2]=Math.floor(e[2]);t[3]=Math.floor(e[3]);return t};n.min=function(t,e,r){t[0]=Math.min(e[0],r[0]);t[1]=Math.min(e[1],r[1]);t[2]=Math.min(e[2],r[2]);t[3]=Math.min(e[3],r[3]);return t};n.max=function(t,e,r){t[0]=Math.max(e[0],r[0]);t[1]=Math.max(e[1],r[1]);t[2]=Math.max(e[2],r[2]);t[3]=Math.max(e[3],r[3]);return t};n.round=function(t,e){t[0]=Math.round(e[0]);t[1]=Math.round(e[1]);t[2]=Math.round(e[2]);t[3]=Math.round(e[3]);return t};n.scale=function(t,e,r){t[0]=e[0]*r;t[1]=e[1]*r;t[2]=e[2]*r;t[3]=e[3]*r;return t};n.scaleAndAdd=function(t,e,r,a){t[0]=e[0]+r[0]*a;t[1]=e[1]+r[1]*a;t[2]=e[2]+r[2]*a;t[3]=e[3]+r[3]*a;return t};n.distance=function(t,e){var r=e[0]-t[0],a=e[1]-t[1],n=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(r*r+a*a+n*n+o*o)};n.dist=n.distance;n.squaredDistance=function(t,e){var r=e[0]-t[0],a=e[1]-t[1],n=e[2]-t[2],o=e[3]-t[3];return r*r+a*a+n*n+o*o};n.sqrDist=n.squaredDistance;n.length=function(t){var e=t[0],r=t[1],a=t[2],n=t[3];return Math.sqrt(e*e+r*r+a*a+n*n)};n.len=n.length;n.squaredLength=function(t){var e=t[0],r=t[1],a=t[2],n=t[3];return e*e+r*r+a*a+n*n};n.sqrLen=n.squaredLength;n.negate=function(t,e){t[0]=-e[0];t[1]=-e[1];t[2]=-e[2];t[3]=-e[3];return t};n.inverse=function(t,e){t[0]=1/e[0];t[1]=1/e[1];t[2]=1/e[2];t[3]=1/e[3];return t};n.normalize=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3];var i=r*r+a*a+n*n+o*o;if(i>0){i=1/Math.sqrt(i);t[0]=r*i;t[1]=a*i;t[2]=n*i;t[3]=o*i}return t};n.setLength=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3];var s=a*a+n*n+o*o+i*i;if(s>0){s=r/Math.sqrt(s);t[0]=a*s;t[1]=n*s;t[2]=o*s;t[3]=i*s}return t};n.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]};n.lerp=function(t,e,r,a){var n=e[0],o=e[1],i=e[2],s=e[3];t[0]=n+a*(r[0]-n);t[1]=o+a*(r[1]-o);t[2]=i+a*(r[2]-i);t[3]=s+a*(r[3]-s);return t};n.random=function(t,e){e=e||1;t[0]=a.RANDOM();t[1]=a.RANDOM();t[2]=a.RANDOM();t[3]=a.RANDOM();n.normalize(t,t);n.scale(t,t,e);return t};n.transformMat4=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3];t[0]=r[0]*a+r[4]*n+r[8]*o+r[12]*i;t[1]=r[1]*a+r[5]*n+r[9]*o+r[13]*i;t[2]=r[2]*a+r[6]*n+r[10]*o+r[14]*i;t[3]=r[3]*a+r[7]*n+r[11]*o+r[15]*i;return t};n.transformQuat=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=r[0],s=r[1],u=r[2],l=r[3],h=l*a+s*o-u*n,f=l*n+u*a-i*o,c=l*o+i*n-s*a,M=-i*a-s*n-u*o;t[0]=h*l+M*-i+f*-u-c*-s;t[1]=f*l+M*-s+c*-i-h*-u;t[2]=c*l+M*-u+h*-s-f*-i;t[3]=e[3];return t};n.forEach=function(){var t=n.create();return function(e,r,a,n,o,i){var s,u;if(!r){r=4}if(!a){a=0}if(n){u=Math.min(n*r+a,e.length)}else{u=e.length}for(s=a;s<u;s+=r){t[0]=e[s];t[1]=e[s+1];t[2]=e[s+2];t[3]=e[s+3];o(t,t,i);e[s]=t[0];e[s+1]=t[1];e[s+2]=t[2];e[s+3]=t[3]}return e}}();n.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"};n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]};n.equals=function(t,e){var r=t[0],n=t[1],o=t[2],i=t[3];var s=e[0],u=e[1],l=e[2],h=e[3];return Math.abs(r-s)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-u)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(o-l)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(i-h)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))};t.exports=n},function(t,e,r){var a=r(5);var n={};n.create=function(){var t=new a.ARRAY_TYPE(2);t[0]=0;t[1]=0;return t};n.clone=function(t){var e=new a.ARRAY_TYPE(2);e[0]=t[0];e[1]=t[1];return e};n.fromValues=function(t,e){var r=new a.ARRAY_TYPE(2);r[0]=t;r[1]=e;return r};n.copy=function(t,e){t[0]=e[0];t[1]=e[1];return t};n.set=function(t,e,r){t[0]=e;t[1]=r;return t};n.add=function(t,e,r){t[0]=e[0]+r[0];t[1]=e[1]+r[1];return t};n.subtract=function(t,e,r){t[0]=e[0]-r[0];t[1]=e[1]-r[1];return t};n.sub=n.subtract;n.multiply=function(t,e,r){t[0]=e[0]*r[0];t[1]=e[1]*r[1];return t};n.mul=n.multiply;n.divide=function(t,e,r){t[0]=e[0]/r[0];t[1]=e[1]/r[1];return t};n.div=n.divide;n.ceil=function(t,e){t[0]=Math.ceil(e[0]);t[1]=Math.ceil(e[1]);return t};n.floor=function(t,e){t[0]=Math.floor(e[0]);t[1]=Math.floor(e[1]);return t};n.min=function(t,e,r){t[0]=Math.min(e[0],r[0]);t[1]=Math.min(e[1],r[1]);return t};n.max=function(t,e,r){t[0]=Math.max(e[0],r[0]);t[1]=Math.max(e[1],r[1]);return t};n.round=function(t,e){t[0]=Math.round(e[0]);t[1]=Math.round(e[1]);return t};n.scale=function(t,e,r){t[0]=e[0]*r;t[1]=e[1]*r;return t};n.scaleAndAdd=function(t,e,r,a){t[0]=e[0]+r[0]*a;t[1]=e[1]+r[1]*a;return t};n.distance=function(t,e){var r=e[0]-t[0],a=e[1]-t[1];return Math.sqrt(r*r+a*a)};n.dist=n.distance;n.squaredDistance=function(t,e){var r=e[0]-t[0],a=e[1]-t[1];return r*r+a*a};n.sqrDist=n.squaredDistance;n.length=function(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)};n.len=n.length;n.squaredLength=function(t){var e=t[0],r=t[1];return e*e+r*r};n.sqrLen=n.squaredLength;n.negate=function(t,e){t[0]=-e[0];t[1]=-e[1];return t};n.inverse=function(t,e){t[0]=1/e[0];t[1]=1/e[1];return t};n.normalize=function(t,e){var r=e[0],a=e[1];var n=r*r+a*a;if(n>0){n=1/Math.sqrt(n);t[0]=e[0]*n;t[1]=e[1]*n}return t};n.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]};n.cross=function(t,e,r){var a=e[0]*r[1]-e[1]*r[0];t[0]=t[1]=0;t[2]=a;return t};n.lerp=function(t,e,r,a){var n=e[0],o=e[1];t[0]=n+a*(r[0]-n);t[1]=o+a*(r[1]-o);return t};n.random=function(t,e){e=e||1;var r=a.RANDOM()*2*Math.PI;t[0]=Math.cos(r)*e;t[1]=Math.sin(r)*e;return t};n.transformMat2=function(t,e,r){var a=e[0],n=e[1];t[0]=r[0]*a+r[2]*n;t[1]=r[1]*a+r[3]*n;return t};n.transformMat2d=function(t,e,r){var a=e[0],n=e[1];t[0]=r[0]*a+r[2]*n+r[4];t[1]=r[1]*a+r[3]*n+r[5];return t};n.transformMat3=function(t,e,r){var a=e[0],n=e[1];t[0]=r[0]*a+r[3]*n+r[6];t[1]=r[1]*a+r[4]*n+r[7];return t};n.transformMat4=function(t,e,r){var a=e[0],n=e[1];t[0]=r[0]*a+r[4]*n+r[12];t[1]=r[1]*a+r[5]*n+r[13];return t};n.forEach=function(){var t=n.create();return function(e,r,a,n,o,i){var s,u;if(!r){r=2}if(!a){a=0}if(n){u=Math.min(n*r+a,e.length)}else{u=e.length}for(s=a;s<u;s+=r){t[0]=e[s];t[1]=e[s+1];o(t,t,i);e[s]=t[0];e[s+1]=t[1]}return e}}();n.str=function(t){return"vec2("+t[0]+", "+t[1]+")"};n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]};n.equals=function(t,e){var r=t[0],n=t[1];var o=e[0],i=e[1];return Math.abs(r-o)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-i)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(i))};t.exports=n},function(t,e,r){t.exports=r(15)},function(t,e,r){if(true){}function a(t){this.files=null;this.finalCallback=null;this.store={};if(t){for(var e in t){if(t.hasOwnProperty(e)){this[e]=t[e]}}}}a.prototype.loadAllResources=function(t){this.numFilesToLoad=this.files.length;this.numFilesLoaded=0;this.finalCallback=t;var e,r;for(var a=0,n=this.files.length;a<n;a++){e=this.files[a].path;r=this.files[a].callback;if(this.files[a].type==="image"){this.loadImage(e,r)}else{this.loadText(e,r)}}};a.prototype.loadText=function(t,e){var r=new XMLHttpRequest;var a=this;r.onreadystatechange=function(){if(r.readyState==4&&r.status==200){this.store[t]=r.responseText;if(e){e(r)}a.numFilesLoaded++;if(this.finalCallback&&a.numFilesLoaded==a.numFilesToLoad){a.finalCallback()}}}.bind(this);r.open("GET",t,true);r.setRequestHeader("Content-Type","application/json;charset=UTF-8");r.send()};a.prototype.loadImage=function(t,e){var r=new Image;r.src=t;r.webglTexture=null;r.onload=function(a){this.store[t]=r;if(e){e(r)}this.numFilesLoaded++;if(this.finalCallback&&this.numFilesLoaded==this.numFilesToLoad){this.finalCallback()}}.bind(this)};a.prototype.getResource=function(t){if(!this.store[t]){console.log(" ResourceLoader.prototype.getResource : no such resource "+t);return}return this.store[t]};if(true){t.exports=a}},function(t,e,r){t.exports={Camera:r(17),SceneObject:r(18),Container:r(19),Scene:r(20),Mesh:r(21),Model:r(22)}},function(t,e,r){if(true){var a=r(2);var n=a.advenMath;var o=a.glMat}if(true){t.exports=i}function i(t){this.width=0;this.height=0;if(t){for(var e in t){if(t.hasOwnProperty(e)){this[e]=t[e]}}}}i.prototype.init=function(t,e){this.width=t;this.height=e;this.vMatrix=n.mat4Create();this.pMatrix=n.mat4Create();o.mat4.perspective(this.pMatrix,70,t/e,.1,100);o.mat4.translate(this.vMatrix,this.vMatrix,[0,0,-3])};i.prototype.processInput=function(t){var e=this.vMatrix;if(t.checkIsKeyDown(33,81)){n.mat4TranslateZ(this.vMatrix,-.01)}else if(t.checkIsKeyDown(34,69)){n.mat4TranslateZ(this.vMatrix,.01)}if(t.checkIsKeyDown(37,65)){n.mat4TranslateX(this.vMatrix,.01)}else if(t.checkIsKeyDown(39,68)){n.mat4TranslateX(this.vMatrix,-.01);
}if(t.checkIsKeyDown(38,87)){n.mat4TranslateY(this.vMatrix,-.01)}else if(t.checkIsKeyDown(40,83)){n.mat4TranslateY(this.vMatrix,+.01)}if(t.wheelDeltaY){n.mat4TranslateZ(this.vMatrix,t.wheelDeltaY/240);t.wheelDeltaY=0}}},function(t,e,r){if(true){}if(true){t.exports=a}function a(){this.matrix=this.mat4Create();this.parent=null;this.scene=null}a.prototype.set=function(t,e){if(!e||e==="simple"){for(var r in t){if(t.hasOwnProperty(r)){this[r]=t[r]}}}else if(e==="recursive"){}};a.prototype.getConcatenatedMatrix=function(){var t=this.mat4Create();var e=this;this.mat4Multiply(this.matrix,t);while(e=e.parent){this.mat4Multiply(e.matrix,t)}return t};a.prototype.searchTreeUp=function(t){var e=this[t],r=this.parent;while(typeof e==="undefined"){if(r){e=r[t];r=r.parent}else{break}}return e};a.prototype.setColor=function(t,e,r,a){if(this.color){this.color[0]=t;this.color[1]=e;this.color[2]=r;this.color[3]=a}else{this.color=[t,e,r,a]}};a.prototype.mat4Create=function(){return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};a.prototype.mat4Multiply=function(t,e,r){var a=t;var n=e;var o=r||e;var i=a[0],s=a[4],u=a[8],l=a[12];var h=a[1],f=a[5],c=a[9],M=a[13];var v=a[2],p=a[6],x=a[10],d=a[14];var m=a[3],S=a[7],I=a[11],g=a[15];var D=n[0],F=n[4],y=n[8],b=n[12];var E=n[1],w=n[5],A=n[9],T=n[13];var R=n[2],N=n[6],C=n[10],P=n[14];var L=n[3],z=n[7],_=n[11],O=n[15];o[0]=i*D+s*E+u*R+l*L;o[4]=i*F+s*w+u*N+l*z;o[8]=i*y+s*A+u*C+l*_;o[12]=i*b+s*T+u*P+l*O;o[1]=h*D+f*E+c*R+M*L;o[5]=h*F+f*w+c*N+M*z;o[9]=h*y+f*A+c*C+M*_;o[13]=h*b+f*T+c*P+M*O;o[2]=v*D+p*E+x*R+d*L;o[6]=v*F+p*w+x*N+d*z;o[10]=v*y+p*A+x*C+d*_;o[14]=v*b+p*T+x*P+d*O;o[3]=m*D+S*E+I*R+g*L;o[7]=m*F+S*w+I*N+g*z;o[11]=m*y+S*A+I*C+g*_;o[15]=m*b+S*T+I*P+g*O}},function(t,e,r){if(true){var a=r(18)}if(true){t.exports=n}function n(t){a.call(this);this.children=[];this.set(n.prototype.defaultProps);if(t){this.set(t)}}n.prototype=Object.create(a.prototype);n.prototype.defaultProps={};n.prototype.draw=function(t){var e;for(var r=0,a=this.children.length;r<a;r++){e=this.children[r];e.draw(t)}};n.prototype.createBuffers=function(){var t;for(var e=0,r=this.children.length;e<r;e++){t=this.children[e];t.createBuffers()}};n.prototype.update=function(){var t;for(var e=0,r=this.children.length;e<r;e++){t=this.children[e];t.update()}};n.prototype.addChild=function(t){if(t.parent){t.parent.removeChild(t)}this.children.push(t);t.parent=this;if(this.scene!=null){this.scene.onNodeAdded(t)}return t};n.prototype.removeChild=function(t){var e=this.children.indexOf(t);if(e!=-1){this.children.splice(e,1)[0];if(this.scene!=null){this.scene.onNodeRemoved(t)}t.parent=null;return t}return false};n.prototype.getChildById=function(t){for(var e=0,r=this.children.length;e<r;e++){if(this.children[e].id===t){return this.children[e]}}return null};n.prototype.modifyRecursively=function(t,e){if(t instanceof n){for(var r=0,a=t.children.length;r<a;r++){var o=t.children[r];e(o);if(o instanceof n){this.modifyRecursively(o,e)}}}else{e(t)}}},function(t,e,r){if(true){var a=r(19);var n=r(21)}if(true){t.exports=o}function o(t){a.call(this);this.children=[];this.meshes=[];this.camera=null;this.isMeshesChanged=false;this.inputManager=null;this.set(o.prototype.defaultProps);if(t){this.set(t)}}o.prototype=Object.create(a.prototype);o.prototype.constructor=o;o.prototype.addChild=function(t){if(t.parent){t.parent.removeChild(t)}this.children.push(t);t.parent=this;this.onNodeAdded(t);return t};o.prototype.removeChild=function(t){var e=this.children.indexOf(t);if(e!==-1){this.children.splice(e,1)}t.parent=null;this.onNodeRemoved(t);return t};o.prototype.onNodeAdded=function(t){t.scene=this;this.modifyRecursively(t,function(t){t.scene=this;this.addMesh(t)}.bind(this))};o.prototype.onNodeRemoved=function(t){t.scene=null;this.modifyRecursively(t,function(t){t.scene=null;this.removeMesh(t)}.bind(this))};o.prototype.addMesh=function(t){if(t instanceof n){this.meshes.push(t);this.isMeshesChanged=true}};o.prototype.removeMesh=function(t){if(t instanceof n){var e=this.meshes.indexOf(t);if(e!==-1){this.meshes.splice(e,1);this.isMeshesChanged=true}}};o.prototype.onMeshesChanged=function(t){var e=this.meshes,r=t.buffers,a=null,n=-1;e.sort(function(t,e){return t.model.index-e.model.index});for(var o=0;o<e.length;o++){a=e[o],n=a.model.index;if(!r[n]){t.allocateBuffers(a.model)}}e.sort(this.sortByProgramThenBuffers)};o.prototype.render=function(t,e){if(this.isMeshesChanged){this.onMeshesChanged(t);this.isMeshesChanged=false}var r=this.meshes,a=null,n=null,o=null,i=null,s=null,u=null;for(var l=0,h=r.length;l<h;l++){a=r[l];i=a.model;if(s!==a.programName){if(n){n.unuse()}n=t.getProgram(a.programName);n.use();gl.uniformMatrix4fv(n.UNIFORMS.uPMatrix,false,this.camera.pMatrix);gl.uniformMatrix4fv(n.UNIFORMS.uVMatrix,false,this.camera.vMatrix);s=a.programName}if(u!==i.index){o=t.getBuffersByIndex(i.index);n.prepareBuffers(i,o);u=i.index}n.loadUniforms(a,e);gl.uniformMatrix4fv(n.UNIFORMS.uMMatrix,false,a.getConcatenatedMatrix());gl.drawElements(gl[a.mode],i.indices.length,gl.UNSIGNED_SHORT,0)}};o.prototype.sortByProgramThenBuffers=function(t,e){var r=t.programName<e.programName?-1:t.programName>e.programName?1:0;var a=t.model.index-e.model.index;return r||a}},function(t,e,r){if(true){var a=r(18)}if(true){t.exports=n}function n(t){a.call(this);this.id=null;this.model=null;this.modelID=null;this.textureUrl=null;this.programName=null;this.mode="TRIANGLES";this.set(n.prototype.defaultProps);if(t){this.set(t)}return this}n.prototype=Object.create(a.prototype);n.prototype.constructor=n;n.prototype.defaultProps={}},function(t,e,r){if(true){var a=r(18)}if(true){t.exports=o}var n=null;function o(t){this.vertices=null;this.indices=null;this.index=null;if(t){this.set(t)}this.index=o.models.length;o.models.push(this);return this}o.models=[];o.prototype.set=function(t,e){if(!e||e==="simple"){for(var r in t){if(t.hasOwnProperty(r)){this[r]=t[r]}}}else if(e==="recursive"){}return this};o.prototype.remove=function(){var t=o.models.indexOf(this);if(t!==-1){o.models.splice(t,1);return true}return false};o.getByName=function(t){var e=o.models;for(var r=0;r<e.length;r++){var a=e[r];if(a.name===t){return a}}return null};o.cube=function(){return n};o.lattice=function(t,e){var r=new o({rows:t||8,columns:e||8,aPosition:3,aColor:0,aUV:0,vertices:[],indices:[]});var a,n,i,s;n=0;for(var s=0;s<=r.columns;s++){a=2/r.columns*s-1;r.vertices.push(a,n,-1);r.vertices.push(a,n,1)}for(var s=0;s<=r.rows;s++){i=2/r.rows*s-1;r.vertices.push(-1,n,i);r.vertices.push(1,n,i)}for(var s=0,u=r.vertices.length/3;s<u;s++){r.indices.push(s)}return r};n=new o({aPosition:3,aColor:0,aUV:2,vertices:[-1,-1,1,0,0,1,-1,1,1,0,1,1,1,1,1,-1,1,1,0,1,-1,-1,-1,1,0,-1,1,-1,1,1,1,1,-1,0,1,1,-1,-1,0,0,-1,1,-1,0,1,-1,1,1,0,0,1,1,1,1,0,1,1,-1,1,1,-1,-1,-1,1,1,1,-1,-1,0,1,1,-1,1,0,0,-1,-1,1,1,0,1,-1,-1,1,0,1,1,-1,1,1,1,1,1,0,1,1,-1,1,0,0,-1,-1,-1,0,0,-1,-1,1,1,0,-1,1,1,1,1,-1,1,-1,0,1],indices:[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]})},function(t,e,r){t.exports={mousePicker:r(24)}},function(t,e,r){if(true){}if(true){t.exports={ray_triangle_Akenine_Moller:i,check_each_face_of_object:c,create_mat4:S,invert_mat4:m,normalize_vec3:d,normalize_mouse:f,get_origin_eye_space:l,get_origin_model_space:h,get_direction_eye_space:s,get_direction_model_space:u,get_direction_and_origin:n,getObjectsUnderMouse:a,ray_plane:o}}function a(t,e,r,a,n,o,i,M,v,p){var x=t;var d=f(e,r,a,n);var I=S();var g=S();m(I,o);m(g,i);var D=S();var F=s(d.x,d.y,I,g);var y=l(g);var b=[];for(var E=0,w=x.length;E<w;E++){var A=x[E];var T;if(v){T=v(A)}else{T=A}if(!T){continue}var R;if(T.getConcatenatedMatrix){R=T.getConcatenatedMatrix()}else{R=T.matrix}m(D,R);var N=u(F,D);var C=h(y,D);var P=c(T,C,N,T.offset||M||3,p);if(P){b.push(A)}}return b}function n(t,e,r,a,n,o,i){var c=f(t,e,r,a);var M=S();var v=S();var p=S();m(M,n);m(v,o);m(p,i);var x=s(c.x,c.y,M,v);var d=l(v);var I=u(x,p);var g=h(d,p);return{origin:g,direction:I}}function o(t,e,r,a,n,o,i,c,I,g,D){var F=f(t,e,r,a);var y=S();var b=S();var E=S();m(y,n);m(b,o);m(E,i);var w=s(F.x,F.y,y,b);var A=l(b);var T=u(w,E);var R=h(A,E);var N=[0,0,0],C=[0,0,0],P=[0,0,0],L=[0,0,0],z=null,_=null,O=null,U=[0,0,0];x(C,I,c);x(P,D,c);v(N,C,P);d(N);z=p(T,N);if(z<M){console.log("parallel");return 0}x(L,c,R);_=p(L,N);O=_/z;return[R[0]+T[0]*O,R[1]+T[1]*O,R[2]+T[2]*O,1]}function i(t,e,r,a,n,o){var i,s,u;var l=[0,0,0],h=[0,0,0],f=[0,0,0],c=[0,0,0],d=[0,0,0],m=0,S=0;x(l,a,r);x(h,n,r);v(c,e,h);m=p(l,c);if(o){if(m<M){return 0}x(f,t,r);s=DOT(f,c);if(s<0||s>m){return 0}v(d,f,l);u=p(e,d);if(u<0||s+u>m){return 0}i=p(h,d);S=1/m;i*=S;s*=S;u*=S}else{if(m>-M&&m<M){return 0}S=1/m;x(f,t,r);s=p(f,c)*S;if(s<0||s>1){return 0}v(d,f,l);u=p(e,d)*S;if(u<0||s+u>1){return 0}i=p(h,d)*S}return{u:s,v:u,t:i}}function s(t,e,r,a){var n=[t,e,-1,0];I(n,r,n);n[2]=-1;n[3]=0;I(n,a,n);return n}function u(t,e){var r=t.slice(0);I(r,e,r);return r}function l(t){var e=[0,0,0,1];I(e,t,e);return e}function h(t,e){var r=t.slice(0);I(r,e,r);return r}function f(t,e,r,a){var n=t/(r/2)-1;var o=1-e/(a/2);return{x:n,y:o}}function c(t,e,r,a,n){var o=t.vertices||t.model.vertices;var s=t.indices||t.model.indices;var u,l,h,f,c,M;for(var v=0,p=s.length;v<p;v+=3){f=s[v];c=s[v+1];M=s[v+2];if(n){u=n(o[f*a],o[f*a+1],o[f*a+2]);l=n(o[c*a],o[c*a+1],o[c*a+2]);h=n(o[M*a],o[M*a+1],o[M*a+2])}else{u=[o[f*a],o[f*a+1],o[f*a+2]];l=[o[c*a],o[c*a+1],o[c*a+2]];h=[o[M*a],o[M*a+1],o[M*a+2]]}if(i(e,r,u,l,h,false)){return true}}}var M=1e-6;function v(t,e,r){t[0]=e[1]*r[2]-e[2]*r[1];t[1]=e[2]*r[0]-e[0]*r[2];t[2]=e[0]*r[1]-e[1]*r[0]}function p(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function x(t,e,r){t[0]=e[0]-r[0];t[1]=e[1]-r[1];t[2]=e[2]-r[2]}function d(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function m(t,e){var r=new Float32Array(16),a,n;r[0]=e[5]*e[10]*e[15]-e[5]*e[11]*e[14]-e[9]*e[6]*e[15]+e[9]*e[7]*e[14]+e[13]*e[6]*e[11]-e[13]*e[7]*e[10];r[4]=-e[4]*e[10]*e[15]+e[4]*e[11]*e[14]+e[8]*e[6]*e[15]-e[8]*e[7]*e[14]-e[12]*e[6]*e[11]+e[12]*e[7]*e[10];r[8]=e[4]*e[9]*e[15]-e[4]*e[11]*e[13]-e[8]*e[5]*e[15]+e[8]*e[7]*e[13]+e[12]*e[5]*e[11]-e[12]*e[7]*e[9];r[12]=-e[4]*e[9]*e[14]+e[4]*e[10]*e[13]+e[8]*e[5]*e[14]-e[8]*e[6]*e[13]-e[12]*e[5]*e[10]+e[12]*e[6]*e[9];r[1]=-e[1]*e[10]*e[15]+e[1]*e[11]*e[14]+e[9]*e[2]*e[15]-e[9]*e[3]*e[14]-e[13]*e[2]*e[11]+e[13]*e[3]*e[10];r[5]=e[0]*e[10]*e[15]-e[0]*e[11]*e[14]-e[8]*e[2]*e[15]+e[8]*e[3]*e[14]+e[12]*e[2]*e[11]-e[12]*e[3]*e[10];r[9]=-e[0]*e[9]*e[15]+e[0]*e[11]*e[13]+e[8]*e[1]*e[15]-e[8]*e[3]*e[13]-e[12]*e[1]*e[11]+e[12]*e[3]*e[9];r[13]=e[0]*e[9]*e[14]-e[0]*e[10]*e[13]-e[8]*e[1]*e[14]+e[8]*e[2]*e[13]+e[12]*e[1]*e[10]-e[12]*e[2]*e[9];r[2]=e[1]*e[6]*e[15]-e[1]*e[7]*e[14]-e[5]*e[2]*e[15]+e[5]*e[3]*e[14]+e[13]*e[2]*e[7]-e[13]*e[3]*e[6];r[6]=-e[0]*e[6]*e[15]+e[0]*e[7]*e[14]+e[4]*e[2]*e[15]-e[4]*e[3]*e[14]-e[12]*e[2]*e[7]+e[12]*e[3]*e[6];r[10]=e[0]*e[5]*e[15]-e[0]*e[7]*e[13]-e[4]*e[1]*e[15]+e[4]*e[3]*e[13]+e[12]*e[1]*e[7]-e[12]*e[3]*e[5];r[14]=-e[0]*e[5]*e[14]+e[0]*e[6]*e[13]+e[4]*e[1]*e[14]-e[4]*e[2]*e[13]-e[12]*e[1]*e[6]+e[12]*e[2]*e[5];r[3]=-e[1]*e[6]*e[11]+e[1]*e[7]*e[10]+e[5]*e[2]*e[11]-e[5]*e[3]*e[10]-e[9]*e[2]*e[7]+e[9]*e[3]*e[6];r[7]=e[0]*e[6]*e[11]-e[0]*e[7]*e[10]-e[4]*e[2]*e[11]+e[4]*e[3]*e[10]+e[8]*e[2]*e[7]-e[8]*e[3]*e[6];r[11]=-e[0]*e[5]*e[11]+e[0]*e[7]*e[9]+e[4]*e[1]*e[11]-e[4]*e[3]*e[9]-e[8]*e[1]*e[7]+e[8]*e[3]*e[5];r[15]=e[0]*e[5]*e[10]-e[0]*e[6]*e[9]-e[4]*e[1]*e[10]+e[4]*e[2]*e[9]+e[8]*e[1]*e[6]-e[8]*e[2]*e[5];n=e[0]*r[0]+e[1]*r[4]+e[2]*r[8]+e[3]*r[12];if(n==0)return false;n=1/n;for(a=0;a<16;a++)t[a]=r[a]*n;return true}function S(){return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function I(t,e,r){var a,n,o,i;a=e[0]*r[0]+e[4]*r[1]+e[8]*r[2]+e[12]*r[3];n=e[1]*r[0]+e[5]*r[1]+e[9]*r[2]+e[13]*r[3];o=e[2]*r[0]+e[6]*r[1]+e[10]*r[2]+e[14]*r[3];i=e[3]*r[0]+e[7]*r[1]+e[11]*r[2]+e[15]*r[3];t[0]=a;t[1]=n;t[2]=o;t[3]=i}function g(t,e,r){var a=e;var n=r;var o=t;var i=a[0],s=a[4],u=a[8],l=a[12];var h=a[1],f=a[5],c=a[9],M=a[13];var v=a[2],p=a[6],x=a[10],d=a[14];var m=a[3],S=a[7],I=a[11],g=a[15];var D=n[0],F=n[4],y=n[8],b=n[12];var E=n[1],w=n[5],A=n[9],T=n[13];var R=n[2],N=n[6],C=n[10],P=n[14];var L=n[3],z=n[7],_=n[11],O=n[15];o[0]=i*D+s*E+u*R+l*L;o[4]=i*F+s*w+u*N+l*z;o[8]=i*y+s*A+u*C+l*_;o[12]=i*b+s*T+u*P+l*O;o[1]=h*D+f*E+c*R+M*L;o[5]=h*F+f*w+c*N+M*z;o[9]=h*y+f*A+c*C+M*_;o[13]=h*b+f*T+c*P+M*O;o[2]=v*D+p*E+x*R+d*L;o[6]=v*F+p*w+x*N+d*z;o[10]=v*y+p*A+x*C+d*_;o[14]=v*b+p*T+x*P+d*O;o[3]=m*D+S*E+I*R+g*L;o[7]=m*F+S*w+I*N+g*z;o[11]=m*y+S*A+I*C+g*_;o[15]=m*b+S*T+I*P+g*O}},function(t,e,r){t.exports=r(26)},function(t,e,r){if(true){}if(true){t.exports=a}function a(){}a.prototype.init=function(t,e){this.keyMap={};this.subscribers={};this.domElement=t;this.camera=e;this.mouse={x:0,y:0};this.delta={x:0,y:0};this.wheelDeltaY=0;this.phi=0;this.theta=0;this.amortization=.95;this.zoomLevel=1;this.isMouseDownLeft=false;this.isMouseDownMiddle=false;this.isMouseDownRight=false};a.prototype.onContextMenu=function(t){};a.prototype.onWheel=function(t){this.wheelDeltaY=t.wheelDeltaY;this.computeZoomLevel();t.preventDefault()};a.prototype.checkIsKeyDown=function(t){if(typeof t==="object"){return this._checkIsKeyDownCommand.apply(this,arguments)}else{return this._checkIsKeyDownKeyCode.apply(this,arguments)}};a.prototype._checkIsKeyDownKeyCode=function(){for(var t=0,e=arguments.length;t<e;t++){var r=arguments[t];if(this.keyMap[r]==true){return true}}return false};a.prototype._checkIsKeyDownCommand=function(t){for(var e=0,r=t.length;e<r;e++){var a=t[e].keyCode;if(this.keyMap[a]==true){return true}}return false};a.prototype.pressKey=function(t){this.keyMap[t.keyCode]=true;this.notify("keydown",t,t.keyCode,this)};a.prototype.releaseKey=function(t){this.keyMap[event.keyCode]=false};a.prototype.mouseDown=function(t){var e=this.getStageMouse(t);this.mouse.x=e.x;this.mouse.y=e.y;switch(t.button){case 0:this.isMouseDownLeft=true;this.notify("mousedownleft",t,e,this);break;case 1:this.isMouseDownMiddle=true;this.notify("mousedownmiddle",t,e,this);break;case 2:this.isMouseDownRight=true;this.notify("mousedownright",t,e,this);break;default:break}t.preventDefault()};a.prototype.mouseUp=function(t){var e=this.getStageMouse(t);switch(t.button){case 0:this.isMouseDownLeft=false;this.notify("mouseupleft",t,e,this);break;case 1:this.isMouseDownMiddle=false;this.notify("mouseupmiddle",t,e,this);break;case 2:this.isMouseDownRight=false;this.notify("mouseupright",t,e,this);break;default:break}t.preventDefault()};a.prototype.mouseMove=function(t){var e=this.getStageMouse(t);this.notify("mousemove",t,e,this);if(!this.isMouseDownRight&&!this.isMouseDownLeft){return e}this.computeDelta(e);this.computeThetaPhi();this.mouse.x=e.x;this.mouse.y=e.y;t.preventDefault();return e};a.prototype.on=function(t,e){if(!this.subscribers[t]){this.subscribers[t]=[]}this.subscribers[t].push(e)};a.prototype.off=function(t,e){var r=this.subscribers[t];if(r){for(var a=0;a<r.length;a++){if(r[a]===e){this.subscribers.slice(a,1);return}}}};a.prototype.notify=function(t,e,r,a){var n=this.subscribers[t];if(n){for(var o=0;o<n.length;o++){n[o](e,r,a)}}};a.prototype.doInertia=function(){if(!this.isMouseDownRight){if(Math.abs(this.delta.x)>.001||Math.abs(this.delta.y)>.001){this.delta.x*=this.amortization;this.delta.y*=this.amortization;this.theta+=this.delta.x;this.phi+=this.delta.y}}};a.prototype.getNormalizedMouse=function(t){var e=t.x/(this.domElement.width/2)-1;var r=1-t.y/(this.domElement.height/2);return{x:e,y:r}};a.prototype.computeDelta=function(t){var e=this.zoomLevel>0?Math.min(this.zoomLevel,7):1;this.delta.x=(t.x-this.mouse.x)*4*Math.PI/this.domElement.width/e;this.delta.y=(t.y-this.mouse.y)*4*Math.PI/this.domElement.height/e};a.prototype.computeThetaPhi=function(){this.theta+=this.delta.x;this.phi+=this.delta.y};a.prototype.getPhi=function(){var t=this.phi;this.phi=0;return t};a.prototype.getTheta=function(){var t=this.theta;this.theta=0;return t};a.prototype.computeZoomLevel=function(){if(this.wheelDeltaY>0){this.zoomLevel++}else if(this.wheelDeltaY<0){this.zoomLevel--}};a.prototype.getStageMouse=function(t){var e=this.domElement.getBoundingClientRect(),r=e.left||0,a=e.top||0,n=0,o=0;if(t.targetTouches&&t.targetTouches.length>=1){n=t.targetTouches[0].clientX-r;o=t.targetTouches[0].clientY-a}else{n=t.clientX-r;o=t.clientY-a}return{x:n,y:o}}},function(t,e,r){t.exports=r(28)},function(t,e,r){if(true){}if(true){t.exports=a}function a(t){this.ioManager=null;this.store={};this.idCounter=0;if(t){for(var e in t){if(t.hasOwnProperty(e)){this[e]=t[e]}}}if(!this.ioManager){console.error("TextureManger was contructed without IOManager...")}}a.prototype.getTexture=function(t){var e=this.gl;var r=this.store[t];if(!r){var a=this.ioManager.getResource(t);if(!a){console.log("getTexture() : image "+t+" has not been loaded");return}var n=this.createStandardTexture(a);this.store[t]={texture:n,id:this.idCounter++};r=this.store[t]}return r};a.prototype.createStandardTexture=function(t){var e=this.gl;var r=e.createTexture();e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,true);e.activeTexture(e["TEXTURE"+this.idCounter]);e.bindTexture(e.TEXTURE_2D,r);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_LINEAR);e.generateMipmap(e.TEXTURE_2D);return r}},function(t,e,r){t.exports=r(30)},function(t,e,r){if(true){var a=r(31)}var n={getFeature:function(t){try{var e=[];for(var r=0,a=geojson.features.length;r<a;r++){var n=geojson.features[r];if(n.properties.name.indexOf(t)>-1||n.properties.name_long.indexOf(t)>-1||n.properties.admin.indexOf(t)>-1||n.properties.abbrev.indexOf(t)>-1){e.push(n)}}if(e.length===1){return e[0]}return e}catch(o){console.log(o)}},getPointsArrayMultiPoligon:function(t){var e=this.getFeature(t);if(Array.isArray(e)){console.log("Getfeature return array: ");console.log(e);return}return this.getCoordinates(e)},getCoordinates:function(t){var e=[];if(t.geometry.type==="MultiPolygon"){var r=t.geometry.coordinates;for(var a=0,n=r.length;a<n;a++){var o=r[a];for(var i=0,s=o.length;i<s;i++){var u=o[i];for(var l=0,h=v.length;l<h;l++){var f=v[l][0]/180;var c=v[l][1]/90;var M=0;e.push(f,c,M)}}}return e}else if(t.geometry.type==="Polygon"){var r=t.geometry.coordinates;for(var i=0,s=r.length;i<s;i++){var v=r[i];for(var l=0,h=v.length;l<h;l++){var f=v[l][0]/180;var c=v[l][1]/90;var M=0;e.push(f,c,M)}}return e}},getCoordinatesWithOffsets:function(t){var e=[];var r=[];var a=-3;if(t.geometry.type==="MultiPolygon"){var n=t.geometry.coordinates;for(var o=0,i=n.length;o<i;o++){var s=n[o];for(var u=0,l=s.length;u<l;u++){var h=s[u];r.push({offset:a+3,length:h.length-1});for(var f=0,c=h.length-1;f<c;f++){var M=h[f][0]/180;var v=h[f][1]/90;var p=0;e.push(M,v,p);a+=3}}}}else if(t.geometry.type==="Polygon"){var n=t.geometry.coordinates;var r=[];var a=-3;for(var u=0,l=n.length;u<l;u++){var h=n[u];r.push({offset:a+3,length:h.length-1});for(var f=0,c=h.length-1;f<c;f++){var M=h[f][0]/180;var v=h[f][1]/90;var p=0;e.push(M,v,p);a+=3}}}return{vertices:e,offsetMap:r}},getTriangulatedPolygon:function(t){if(t.geometry.type==="MultiPolygon"){return this.flattenMultiPolygonUsingPoligon(t.geometry.coordinates)}else if(t.geometry.type==="Polygon"){return this.flattenPolygon(t.geometry.coordinates)}},flattenPolygon:function(t){var e=[];var r=[];var n=null;var o=0;for(var i=0,s=t.length;i<s;i++){var u=t[i];for(var l=0,h=t[i].length;l<h;l++){var f=u[l][0]/180;var c=u[l][1]/90;var M=0;r.push(f,c,M)}if(i>0){o+=t[i-1].length;e.push(o)}}n=a(r,e,3);return{vertices:r,indices:n}},flattenMultiPolygon:function(t){var e=[];var r=[];var n=null;var o=0;for(var i=0,s=t.length;i<s;i++){var u=t[i];for(var l=0,h=u.length;l<h;l++){var f=u[l];for(var c=0,M=u[l].length;c<M;c++){var v=f[c][0]/180;var p=f[c][1]/90;var x=0;r.push(v,p,x)}if(l>0){o+=u[l-1].length;e.push(o)}}}n=a(r,e,3);return{vertices:r,indices:n}},flattenMultiPolygonUsingPoligon:function(t){var e=[];var r=[];for(var a=0,n=t.length;a<n;a++){var o=t[a];var i=this.flattenPolygon(o);var s=i.vertices;for(var u=0,l=s.length;u<l;u++){e.push(s[u])}var h=i.indices;var f=r.length/3+a*3;for(var c=0,l=h.length;c<l;c++){r.push(h[c]+f)}}return{vertices:e,indices:r}}};if(true){t.exports=n}},function(t,e){"use strict";t.exports=r;function r(t,e,r){r=r||2;var n=e&&e.length,i=n?e[0]*r:t.length,s=a(t,0,i,r,true),u=[];if(!s)return u;var l,f,c,M,v,p,x;if(n)s=h(t,e,s,r);if(t.length>80*r){l=c=t[0];f=M=t[1];for(var d=r;d<i;d+=r){v=t[d];p=t[d+1];if(v<l)l=v;if(p<f)f=p;if(v>c)c=v;if(p>M)M=p}x=Math.max(c-l,M-f)}o(s,u,r,l,f,x);return u}function a(t,e,r,a,n){var o=0,i,s,u;for(i=e,s=r-a;i<r;i+=a){o+=(t[s]-t[i])*(t[i+1]+t[s+1]);s=i}if(n===o>0){for(i=e;i<r;i+=a)u=w(i,t[i],t[i+1],u)}else{for(i=r-a;i>=e;i-=a)u=w(i,t[i],t[i+1],u)}return u}function n(t,e){if(!t)return t;if(!e)e=t;var r=t,a;do{a=false;if(!r.steiner&&(g(r,r.next)||I(r.prev,r,r.next)===0)){A(r);r=e=r.prev;if(r===r.next)return null;a=true}else{r=r.next}}while(a||r!==e);return e}function o(t,e,r,a,h,f,c){if(!t)return;if(!c&&f)v(t,a,h,f);var M=t,p,x;while(t.prev!==t.next){p=t.prev;x=t.next;if(f?s(t,a,h,f):i(t)){e.push(p.i/r);e.push(t.i/r);e.push(x.i/r);A(t);t=x.next;M=x.next;continue}t=x;if(t===M){if(!c){o(n(t),e,r,a,h,f,1)}else if(c===1){t=u(t,e,r);o(t,e,r,a,h,f,2)}else if(c===2){l(t,e,r,a,h,f)}break}}}function i(t){var e=t.prev,r=t,a=t.next;if(I(e,r,a)>=0)return false;var n=t.next.next;while(n!==t.prev){if(m(e.x,e.y,r.x,r.y,a.x,a.y,n.x,n.y)&&I(n.prev,n,n.next)>=0)return false;n=n.next}return true}function s(t,e,r,a){var n=t.prev,o=t,i=t.next;if(I(n,o,i)>=0)return false;var s=n.x<o.x?n.x<i.x?n.x:i.x:o.x<i.x?o.x:i.x,u=n.y<o.y?n.y<i.y?n.y:i.y:o.y<i.y?o.y:i.y,l=n.x>o.x?n.x>i.x?n.x:i.x:o.x>i.x?o.x:i.x,h=n.y>o.y?n.y>i.y?n.y:i.y:o.y>i.y?o.y:i.y;var f=x(s,u,e,r,a),c=x(l,h,e,r,a);var M=t.nextZ;while(M&&M.z<=c){if(M!==t.prev&&M!==t.next&&m(n.x,n.y,o.x,o.y,i.x,i.y,M.x,M.y)&&I(M.prev,M,M.next)>=0)return false;M=M.nextZ}M=t.prevZ;while(M&&M.z>=f){if(M!==t.prev&&M!==t.next&&m(n.x,n.y,o.x,o.y,i.x,i.y,M.x,M.y)&&I(M.prev,M,M.next)>=0)return false;M=M.prevZ}return true}function u(t,e,r){var a=t;do{var n=a.prev,o=a.next.next;if(D(n,a,a.next,o)&&y(n,o)&&y(o,n)){e.push(n.i/r);e.push(a.i/r);e.push(o.i/r);A(a);A(a.next);a=t=o}a=a.next}while(a!==t);return a}function l(t,e,r,a,i,s){var u=t;do{var l=u.next.next;while(l!==u.prev){if(u.i!==l.i&&S(u,l)){var h=E(u,l);u=n(u,u.next);h=n(h,h.next);o(u,e,r,a,i,s);o(h,e,r,a,i,s);return}l=l.next}u=u.next}while(u!==t)}function h(t,e,r,o){var i=[],s,u,l,h,M;for(s=0,u=e.length;s<u;s++){l=e[s]*o;h=s<u-1?e[s+1]*o:t.length;M=a(t,l,h,o,false);if(M===M.next)M.steiner=true;i.push(d(M))}i.sort(f);for(s=0;s<i.length;s++){c(i[s],r);r=n(r,r.next)}return r}function f(t,e){return t.x-e.x}function c(t,e){e=M(t,e);if(e){var r=E(e,t);n(r,r.next)}}function M(t,e){var r=e,a=t.x,n=t.y,o=-Infinity,i;do{if(n<=r.y&&n>=r.next.y){var s=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=a&&s>o){o=s;i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!i)return null;if(t.x===i.x)return i.prev;var u=i,l=Infinity,h;r=i.next;while(r!==u){if(a>=r.x&&r.x>=i.x&&m(n<i.y?a:o,n,i.x,i.y,n<i.y?o:a,n,r.x,r.y)){h=Math.abs(n-r.y)/(a-r.x);if((h<l||h===l&&r.x>i.x)&&y(r,t)){i=r;l=h}}r=r.next}return i}function v(t,e,r,a){var n=t;do{if(n.z===null)n.z=x(n.x,n.y,e,r,a);n.prevZ=n.prev;n.nextZ=n.next;n=n.next}while(n!==t);n.prevZ.nextZ=null;n.prevZ=null;p(n)}function p(t){var e,r,a,n,o,i,s,u,l=1;do{r=t;t=null;o=null;i=0;while(r){i++;a=r;s=0;for(e=0;e<l;e++){s++;a=a.nextZ;if(!a)break}u=l;while(s>0||u>0&&a){if(s===0){n=a;a=a.nextZ;u--}else if(u===0||!a){n=r;r=r.nextZ;s--}else if(r.z<=a.z){n=r;r=r.nextZ;s--}else{n=a;a=a.nextZ;u--}if(o)o.nextZ=n;else t=n;n.prevZ=o;o=n}r=a}o.nextZ=null;l*=2}while(i>1);return t}function x(t,e,r,a,n){t=32767*(t-r)/n;e=32767*(e-a)/n;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;t=(t|t<<1)&1431655765;e=(e|e<<8)&16711935;e=(e|e<<4)&252645135;e=(e|e<<2)&858993459;e=(e|e<<1)&1431655765;return t|e<<1}function d(t){var e=t,r=t;do{if(e.x<r.x)r=e;e=e.next}while(e!==t);return r}function m(t,e,r,a,n,o,i,s){return(n-i)*(e-s)-(t-i)*(o-s)>=0&&(t-i)*(a-s)-(r-i)*(e-s)>=0&&(r-i)*(o-s)-(n-i)*(a-s)>=0}function S(t,e){return g(t,e)||t.next.i!==e.i&&t.prev.i!==e.i&&!F(t,e)&&y(t,e)&&y(e,t)&&b(t,e)}function I(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function g(t,e){return t.x===e.x&&t.y===e.y}function D(t,e,r,a){return I(t,e,r)>0!==I(t,e,a)>0&&I(r,a,t)>0!==I(r,a,e)>0}function F(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&D(r,r.next,t,e))return true;r=r.next}while(r!==t);return false}function y(t,e){return I(t.prev,t,t.next)<0?I(t,e,t.next)>=0&&I(t,t.prev,e)>=0:I(t,e,t.prev)<0||I(t,t.next,e)<0}function b(t,e){var r=t,a=false,n=(t.x+e.x)/2,o=(t.y+e.y)/2;do{if(r.y>o!==r.next.y>o&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x)a=!a;r=r.next}while(r!==t);return a}function E(t,e){var r=new T(t.i,t.x,t.y),a=new T(e.i,e.x,e.y),n=t.next,o=e.prev;t.next=e;e.prev=t;r.next=n;n.prev=r;a.next=r;r.prev=a;o.next=a;a.prev=o;return a}function w(t,e,r,a){var n=new T(t,e,r);if(!a){n.prev=n;n.next=n}else{n.next=a.next;n.prev=a;a.next.prev=n;a.next=n}return n}function A(t){t.next.prev=t.prev;t.prev.next=t.next;if(t.prevZ)t.prevZ.nextZ=t.nextZ;if(t.nextZ)t.nextZ.prevZ=t.prevZ}function T(t,e,r){this.i=t;this.x=e;this.y=r;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false}},function(t,e,r){t.exports={WebGLContext:r(33),GLSLProgram:r(34)}},function(t,e,r){if(true){}if(true){t.exports=a}function a(t){this.canvas=t;this.programs={};this.buffers=[];this.activeProgram=null;if(!this.canvas){console.error("Couldn't find canvas element ");return null}this.canvas.width=this.canvas.clientWidth;this.canvas.height=this.canvas.clientHeight;try{this.gl=this.canvas.getContext("webgl",{antialias:true})||this.canvas.getContext("experimental-webgl",{antialias:true})}catch(e){alert("You are not webgl compatible :(");console.error("Couldn't inititalize webgl context...")}this.initGL()}a.prototype.initGL=function(){var t=this.gl,e=this.canvas;t.getExtension("OES_element_index_uint")||t.getExtension("MOZ_OES_element_index_uint")||t.getExtension("WEBKIT_OES_element_index_uint");t.viewport(0,0,e.width,e.height);t.clearColor(0,0,0,1);t.enable(t.DEPTH_TEST);t.depthFunc(t.LEQUAL);t.clearDepth(1);t.enable(t.BLEND);t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)};a.prototype.getProgram=function(t){return this.programs[t]};a.prototype.allocateBuffers=function(t){var e=this.gl,r={vbo:e.createBuffer(),ibo:e.createBuffer(),index:t.index};e.bindBuffer(e.ARRAY_BUFFER,r.vbo);e.bufferData(e.ARRAY_BUFFER,new Float32Array(t.vertices),e.STATIC_DRAW);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.ibo);e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(t.indices),e.STATIC_DRAW);this.buffers[t.index]=r;return r};a.prototype.getBuffersByIndex=function(t){return this.buffers[t]}},function(t,e,r){"use strict";if(true){}if(true){t.exports=a}function a(t){if(!t.gl){console.error("no context was passed to GLSLProgram constructor");return}this.name=t.name;this.gl=t.gl;this.attributeNames=t.attributeNames||[];this.uniformNames=t.uniformNames||[];this.UNIFORMS={};this.ATTRIBUTES={};this.vsCode=t.vsCode||"no vs code";this.fsCode=t.fsCode||"no fs code";this.vertexShader=null;this.fragmentShader=null;this.program=null;this.prepareBuffers=t.prepareBuffers;this.loadUniforms=t.loadUniforms;this.init()}a.prototype.init=function(){this.compileShaders();this.linkShaders();this.bindAttributes();this.getUniformLocations();console.info("GLSL program '"+this.name+"' created")};a.prototype.use=function(){this.gl.useProgram(this.program);for(var t=0,e=this.attributeNames.length;t<e;t++){this.gl.enableVertexAttribArray(t)}};a.prototype.unuse=function(){this.gl.useProgram(null);for(var t=0,e=this.attributeNames.length;t<e;t++){this.gl.disableVertexAttribArray(t)}};a.prototype.compileShaders=function(){var t=this.gl;this.program=t.createProgram();this.vertexShader=this.compileShader(t.VERTEX_SHADER,this.vsCode);this.fragmentShader=this.compileShader(t.FRAGMENT_SHADER,this.fsCode)};a.prototype.bindAttributes=function(){for(var t=0,e=this.attributeNames.length;t<e;t++){var r=this.attributeNames[t];this.gl.bindAttribLocation(this.program,t,this.attributeNames[t]);this.ATTRIBUTES[r]=this.gl.getAttribLocation(this.program,r)}};a.prototype.getUniformLocations=function(){for(var t=0,e=this.uniformNames.length;t<e;t++){var r=this.uniformNames[t];this.UNIFORMS[r]=this.gl.getUniformLocation(this.program,r)}};a.prototype.linkShaders=function(){var t=this.gl;t.attachShader(this.program,this.vertexShader);t.attachShader(this.program,this.fragmentShader);t.linkProgram(this.program);if(!t.getProgramParameter(this.program,t.LINK_STATUS)){console.log("couldn't initialize shaders")}};a.prototype.compileShader=function(t,e){var r=this.gl,a=r.createShader(t);r.shaderSource(a,e);r.compileShader(a);if(!r.getShaderParameter(a,r.COMPILE_STATUS)){throw r.getShaderInfoLog(a)}return a}},function(t,e,r){if(true){var a=r(1);var n=a.Graphics3D;var o=a.InputManager;var i=a.Math.advenMath;var s=n.Scene;var u=n.Camera;var l=r(36)}if(true){t.exports=h}function h(){s.call(this)}h.prototype=Object.create(s.prototype);h.prototype.constructor=h;h.prototype.processInput=function(){this.camera.processInput(this.inputManager);this.map.processInput(this.inputManager);this.inputManager.doInertia()};h.prototype.update=function(){this.map.updateMouseMoveTargets()};h.prototype.draw=function(t,e){var r=t.gl;r.clearColor(0,.15,.3,1);r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT);this.render(t,e)};h.prototype.init=function(t,e){this.camera=new u;this.camera.init(e.width,e.height);this.inputManager=new o;this.inputManager.init(e,this.camera);this.map=new l({countryFeatures:JSON.parse(t.getResource("resources/geoLOW-min.json")).features});this.addChild(this.map);this.inputManager.on("keydown",this.map.onKeyDown.bind(this.map));this.inputManager.on("mousemove",this.map.onMouseMove.bind(this.map));this.inputManager.on("mousedownleft",this.map.onMouseMove.bind(this.map));i.mat4TranslateX(this.map.matrix,.5)};h.prototype.onMouseMove=function(t){return;var e=this.inputManager.getStageMouse(t);var r=this.inputManager.getNormalizedMouse(e);this.map.onMouseMove(t,r,this.inputManager,this.camera)}},function(t,e,r){if(true){var a=r(1);var n=a.Graphics3D;var o=a.geoJSONParser;var i=a.Intersect;var s=a.Math.advenMath;var u=a.RESTManager;var l=n.Container;var h=i.mousePicker;var f=r(37)}if(true){t.exports=c}function c(t){l.call(this);this.uIsFlat=1;this.uCoeff=0;this.mouseMoveTargets=[];this.selectColor=[0,1,0,1];this.set(c.prototype.defaultProps);if(t){this.set(t)}this.init()}c.prototype=Object.create(l.prototype);c.prototype.constructor=c;c.prototype.defaultProps={};c.prototype.init=function(){var t=0;for(var e=0,r=this.countryFeatures.length;e<r;e++){var a=this.countryFeatures[e];var n=o.getTriangulatedPolygon(a);var i=new f({id:e,name:a.properties.name,name_long:a.properties.name_long,name_sort:a.properties.name_sort,admin:a.properties.admin,landColor:[Math.random(),Math.random(),Math.random(),1],landVertices:n.vertices,landIndices:n.indices});this.addChild(i);t+=this.children[this.children.length-1].landVertices.length}console.info("Countries' total vertices: "+t);this.onMouseMove=function(t,e,r){if(r.isDragging){return}var a=this;var n=h.getObjectsUnderMouse(this.children,e.x,e.y,r.domElement.width,r.domElement.height,r.camera.pMatrix,r.camera.vMatrix,3,c.prototype.processObject.bind(this),c.prototype.processVertex.bind(this));this.mouseMoveTargets.splice(0);for(var o=0,i=n.length;o<i;o++){this.mouseMoveTargets.push({id:n[o].id})}};this.onMouseDownLeft=function(t,e,r){if(r.isMouseDownRight){return}var a=h.getObjectsUnderMouse(this.children,e.x,e.y,r.domElement.width,r.domElement.height,r.camera.pMatrix,r.camera.vMatrix,3,c.prototype.processObject.bind(this),c.prototype.processVertex.bind(this))}};c.prototype.processInput=function(t){s.mat4SetIdentity(this.matrix);s.mat4Scale(this.matrix,[.5,.5,.5]);
if(this.uIsFlat==1){s.mat4RotateX(this.matrix,t.phi);s.mat4RotateY(this.matrix,t.theta);if(this.uCoeff>0){this.uCoeff-=.01}else{this.uCoeff=0}}else{s.mat4RotateY(this.matrix,t.theta);s.mat4RotateZ(this.matrix,23.5*Math.PI/180);if(this.uCoeff<1){this.uCoeff+=.01}else{this.uCoeff=1}}};c.prototype.updateMouseMoveTargets=function(){var t="";for(var e=0,r=this.mouseMoveTargets.length;e<r;e++){var a=this.mouseMoveTargets[e];var n=this.children[a.id];n.LAND.color=a.color||this.selectColor}};c.prototype.onKeyDown=function(t,e,r){if(e==70){this.uIsFlat=this.uIsFlat?0:1}};c.prototype.processObject=function(t){var e=t.LAND;e.color=t.landColor;return e};c.prototype.processVertex=function(t,e,r){if(this.uIsFlat==1){return[t*2,e,r]}else if(this.uIsFlat==0){var a=(t+1)*Math.PI;var n=(e+1)/2*Math.PI;var o=Math.cos(a)*Math.sin(n)*-1;var i=Math.cos(n)*-1;var s=Math.sin(a)*Math.sin(n);return[o,i,s]}}},function(t,e,r){if(true){var a=r(1);var n=a.Graphics3D;var o=n.Container;var i=n.Model;var s=n.Mesh}function u(t){o.call(this);this.set(u.prototype.defaultProps);if(t){this.set(t)}this.init()}u.prototype=Object.create(o.prototype);u.prototype.constructor=u;u.prototype.defaultProps={};u.prototype.init=function(){this.LAND=new s({color:this.landColor,model:new i({aPosition:3,aColor:0,aUV:0,vertices:this.landVertices,indices:this.landIndices}),programName:"geofeature program"});this.addChild(this.LAND)};u.prototype.update=function(){};if(true){t.exports=u}},function(t,e,r){if(true){var a=r(1).ResourceLoader}var n=new a({files:[{path:"shaders/geofeature.vs.cpp"},{path:"shaders/geofeature.fs.cpp"},{path:"resources/geoLOW-min.json"},{path:"shaders/octree.vs"},{path:"shaders/octree.fs"},{path:"shaders/mesh.vs.cpp"},{path:"shaders/mesh.fs.cpp"},{path:"shaders/dragon.vs.cpp"},{path:"shaders/dragon.fs.cpp"},{path:"resources/dragonDecimated.json"},{type:"image",path:"resources/dragon.png"},{type:"image",path:"resources/wood.png"}]});if(true){t.exports=n}},function(t,e,r){if(true){var a=r(1).WebGLManager;var n=a.WebGLContext;var o=a.GLSLProgram}if(true){t.exports=i}function i(t,e){var r=new n(t),a=r.gl,i=[];i.push(new o({name:"geofeature program",gl:a,attributeNames:["aPosition"],uniformNames:["uPMatrix","uMMatrix","uColor","uVMatrix","uIsFlat","uCoeff"],vsCode:e.getResource("shaders/geofeature.vs.cpp"),fsCode:e.getResource("shaders/geofeature.fs.cpp"),prepareBuffers:function(t,e){var r=this.gl,a=t.aPosition+t.aColor+t.aUV;r.bindBuffer(r.ARRAY_BUFFER,e.vbo);r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.ibo);r.vertexAttribPointer(0,t.aPosition,r.FLOAT,false,a*4,0*4)},loadUniforms:function(t){var e=this.gl;e.uniform4fv(this.UNIFORMS.uColor,t.searchTreeUp("color"));e.uniform1i(this.UNIFORMS.uIsFlat,t.searchTreeUp("uIsFlat"));e.uniform1f(this.UNIFORMS.uCoeff,t.searchTreeUp("uCoeff"))}}));i.push(new o({name:"mesh_position",gl:a,attributeNames:["aPosition"],uniformNames:["uPMatrix","uMMatrix","uColor","uVMatrix"],vsCode:e.getResource("shaders/mesh.vs.cpp"),fsCode:e.getResource("shaders/mesh.fs.cpp"),prepareBuffers:function(t,e){var r=this.gl,a=t.aPosition+t.aColor+t.aUV;r.bindBuffer(r.ARRAY_BUFFER,e.vbo);r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.ibo);r.vertexAttribPointer(0,t.aPosition,r.FLOAT,false,a*4,0*4)},loadUniforms:function(t){var e=this.gl;e.uniform4fv(this.UNIFORMS.uColor,t.searchTreeUp("color"))}}));i.push(new o({name:"mesh_position_uv",gl:a,attributeNames:["aPosition","aUV"],uniformNames:["uPMatrix","uMMatrix","uSampler","uVMatrix","uColor"],vsCode:e.getResource("shaders/dragon.vs.cpp"),fsCode:e.getResource("shaders/dragon.fs.cpp"),prepareBuffers:function(t,e){var r=this.gl,a=t.aPosition+t.aColor+t.aUV;r.bindBuffer(r.ARRAY_BUFFER,e.vbo);r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.ibo);r.vertexAttribPointer(0,t.aPosition,r.FLOAT,false,a*4,0*4);r.vertexAttribPointer(1,t.aUV,r.FLOAT,false,a*4,(t.aPosition+t.aColor)*4)},loadUniforms:function(t,e){var r=this.gl;r.uniform4fv(this.UNIFORMS.uColor,t.searchTreeUp("color"));var a=e.getTexture(t.textureUrl);r.uniform1i(this.UNIFORMS.uSampler,a.id)}}));var s=r.programs;for(var u=0,l=i.length;u<l;u++){var h=i[u];s[h.name]=h}return r}},function(t,e,r){t.exports={getPage:r(41),fetchPage:r(42),parsePage:r(45)}},function(t,e,r){var a=r(42);var n=r(45);var o=r(46);var i=r(47);t.exports=s;function s(t,e,r){a(t,function(t){var a=n(t);var s=o(a.sectionsArr);var u=i(s,r||10);e({firstPassage:a.firstPassage,sentences:u})}.bind(this))}},function(t,e,r){var a=r(43);t.exports=n;function n(t,e){var r="https://en.wikipedia.org/w/api.php?format=json"+"&action=query"+"&prop=images|extracts"+"&redirects&explaintext&titles="+encodeURIComponent(t);a.getJSONP(r,function(t){var r="";var a=t.query.pages;for(var n in a){r=a[n].extract}e(r)})}},function(t,e,r){t.exports={getJSONP:r(44)}},function(t,e){t.exports=r;function r(t,e){var r=document.body;var n=document.createElement("script");var o=a();n.id=o;window[o]=function(t){e(t);delete window[o];var r=document.getElementById(o);r.parentNode.removeChild(r)};t=t.concat("&callback=").concat(o);r.appendChild(n);n.src=t}function a(){return"callback_"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}},function(t,e){t.exports=r;function r(t){var e=t.indexOf("\n");var r=[t.slice(0,e),t.slice(e+1)];var n=r[0];var o=r[1];o=o.replace(/(?:\r\n|\r|\n)/g,"");var i=/(\={2}\s.+?\s\={2})(.+?(?=[^=]\=\=\s))/gi;var s=/(\={3}\s.+?\s\={3})(.+?(?=[^=]\=\=\=\s))/gi;var u=[];var l=[];var h=a(o,i);var f=["see also","further reading","references"];var c=["religion"];for(var M=0;M<h.length;M++){var v=h[M];var p=v[1];if(f.indexOf(p.replace(/(?:\s?\=\=\s?)/g,"").toLowerCase())!==-1){continue}var x=v[2];var d=a(x,s);u.push({title:p,content:x.replace(/(?:\={1,5}.+?\={1,5})/gi,""),subsections:d.filter(function(t){if(c.indexOf(t[1].replace(/(?:\s?\=\=\=\s?)/g,"").toLowerCase())!==-1){return false}return true}).map(function(t,e,r){return{title:t[1],content:t[2]}})})}return{firstPassage:n,sectionsArr:u}}function a(t,e){var r=[];var a;while(a=e.exec(t)){r.push(a)}return r}},function(t,e){t.exports=r;function r(t){var e=[];var r=/.*?((?:[!?]+|\.+(?!([0-9]|\.+))))|[\w\s\d\.\-\[\]\(\)\:\;\,]+$/gi;for(var a=0;a<t.length;a++){var n=t[a];var o=n.subsections;var i=o.length===0?n.content:"";for(var s=0;s<o.length;s++){i+=o[s].content}var u=i.match(r);u=u.filter(function(t,e,r){var a=t.match(/\d+/);return a?true:false});e=e.concat(u)}return e}},function(t,e){t.exports=r;function r(t,e){a(t);var r=[];for(var n=0;n<Math.min(t.length,e);n++){var o=t[n].replace(/\d+/,"__________");var i=t[n].match(/\d+/);r.push({data:[o,t[n]],answer:parseFloat(i)})}return r}function a(t){var e=t.length,r,a;while(0!==e){a=Math.floor(Math.random()*e);e-=1;r=t[e];t[e]=t[a];t[a]=r}return t}}])});