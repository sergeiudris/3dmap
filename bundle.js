(function t(e,r){if(typeof exports==="object"&&typeof module==="object")module.exports=r();else if(typeof define==="function"&&define.amd)define("worldmap3d",[],r);else if(typeof exports==="object")exports["worldmap3d"]=r();else e["worldmap3d"]=r()})(this,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var a=e[n]={exports:{},id:n,loaded:false};t[n].call(a.exports,a,a.exports,r);a.loaded=true;return a.exports}r.m=t;r.c=e;r.p="";return r(0)}([function(t,e,r){"use strict";var n=r(1);var a=r(30);var o=r(36);t.exports={init:function t(){var e=document.getElementById("target");var i=new o({canvas:e,programs:{sphere_plane:r(40),position:r(44),position_uv:r(47)},resources:["./resources/geoLOW-min.json","./resources/wood.png"],initWorld:function t(){this.scenes={WORLDSCENE:(new n).init(this.resourceManager,this.context.canvas),BOXSCENE:(new a).init(this.resourceManager,this.context.canvas)};this.scene=this.scenes.WORLDSCENE;document.querySelector("#btn-map").addEventListener("click",function(){this.scene=this.scenes.WORLDSCENE;document.querySelector("#info").style.display="initial"}.bind(this));document.querySelector("#btn-boxes").addEventListener("click",function(){this.scene=this.scenes.BOXSCENE;document.querySelector("#info").style.display="none"}.bind(this))},presskey:function t(e){var r=e.keyCode;if(this.scene){this.scene.inputManager.pressKey(e)}}});i.load().then(i.init.bind(i)).then(i.startRunnerLoop.bind(i))}}},function(t,e,r){"use strict";var n=r(2);var a=r(3);var o=r(6);var i=r(18);var s=r(19);var u=r(7);t.exports=l;function l(t){a.call(this);Object.assign(this,t);return this}l.prototype=Object.create(a.prototype);l.prototype.constructor=l;l.prototype.processInput=function(){this.camera.processInput(this.inputManager);this.worldMap.processInput(this.inputManager);this.inputManager.doInertia()};l.prototype.update=function(){this.worldMap.updateMouseMoveTargets()};l.prototype.draw=function(t,e){var r=t.gl;r.clearColor(0,.15,.3,1);r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT);this.render(t,e)};l.prototype.init=function(t,e){this.camera=new o;this.camera.init(e.width,e.height);this.inputManager=new n;this.inputManager.init(e,this.camera);this.worldMap=new s({countryFeatures:t.getResource("./resources/geoLOW-min.json").features});this.addChild(this.worldMap);this.inputManager.on("keydown",this.worldMap.onKeyDown.bind(this.worldMap));this.inputManager.on("mousemove",this.worldMap.onMouseMove.bind(this.worldMap));this.inputManager.on("mousedown0",this.worldMap.onMouseDownLeft.bind(this.worldMap));u.mat4TranslateX(this.worldMap.matrix,.5);return this};l.prototype.onMouseMove=function(t){return;var e=this.inputManager.getStageMouse(t);var r=this.inputManager.getNormalizedMouse(e);this.worldMap.onMouseMove(t,r,this.inputManager,this.camera)}},function(t,e){"use strict";var r=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports=n;function n(){}n.prototype.init=function(t,e){this.pressed=new Map;this.mice=new Map;this.subscribers={};this.domElement=t;this.camera=e;this.mouse={x:0,y:0};this.delta={x:0,y:0};this.wheelDeltaY=0;this.phi=0;this.theta=0;this.amortization=.95;this.zoomLevel=1};n.prototype.onContextMenu=function(t){};n.prototype.onWheel=function(t){this.wheelDeltaY=t.wheelDeltaY;this.computeZoomLevel();t.preventDefault()};n.prototype.checkIsKeyDown=function(t){if((typeof t==="undefined"?"undefined":r(t))==="object"){return this._checkIsKeyDownCommand.apply(this,arguments)}else{return this._checkIsKeyDownKeyCode.apply(this,arguments)}};n.prototype._checkIsKeyDownKeyCode=function(){for(var t=0,e=arguments.length;t<e;t++){var r=arguments[t];if(this.pressed.get(r)){return true}}return false};n.prototype._checkIsKeyDownCommand=function(t){for(var e=0,r=t.length;e<r;e++){var n=t[e].keyCode;if(this.pressed.get(n)){return true}}return false};n.prototype.keydown=function(t){this.pressed.set(t.keyCode,true);this.notify(t.type,t,t.keyCode,this)};n.prototype.keyup=function(t){this.pressed.delete(t.keyCode);this.notify(t.type,t,t.keyCode,this)};n.prototype.mouseDown=function(t){var e=this.getStageMouse(t);var r=t.type+t.button;this.pressed.set(r,true);this.mice.set(r,e);this.notify(r,t,e,this);this.mouse=e;t.preventDefault()};n.prototype.mouseUp=function(t){var e=this.getStageMouse(t);var r=t.type+t.button;this.mice.set(r,e);this.notify(r,t,e,this);this.mouse=e;this.pressed.delete("mousedown"+t.button);t.preventDefault()};n.prototype.mouseMove=function(t){var e=this.getStageMouse(t);this.notify("mousemove",t,e,this);if(!this.pressed.get("mousedown2")&&!this.pressed.get("mousedown0")){return e}this.computeDelta(e);this.computeThetaPhi();this.mouse.x=e.x;this.mouse.y=e.y;t.preventDefault();return e};n.prototype.on=function(t,e){if(!this.subscribers[t]){this.subscribers[t]=[]}this.subscribers[t].push(e)};n.prototype.off=function(t,e){var r=this.subscribers[t];if(r){for(var n=0;n<r.length;n++){if(r[n]===e){this.subscribers.slice(n,1);return}}}};n.prototype.notify=function(t,e,r,n){var a=this.subscribers[t];if(a){for(var o=0;o<a.length;o++){a[o](e,r,n)}}};n.prototype.doInertia=function(){if(!this.pressed.get("mousedown2")){if(Math.abs(this.delta.x)>.001||Math.abs(this.delta.y)>.001){this.delta.x*=this.amortization;this.delta.y*=this.amortization;this.theta+=this.delta.x;this.phi+=this.delta.y}}};n.prototype.getNormalizedMouse=function(t){var e=t.x/(this.domElement.width/2)-1;var r=1-t.y/(this.domElement.height/2);return{x:e,y:r}};n.prototype.computeDelta=function(t){var e=this.zoomLevel>0?Math.min(this.zoomLevel,7):1;this.delta.x=(t.x-this.mouse.x)*4*Math.PI/this.domElement.width/e;this.delta.y=(t.y-this.mouse.y)*4*Math.PI/this.domElement.height/e};n.prototype.computeThetaPhi=function(){this.theta+=this.delta.x;this.phi+=this.delta.y};n.prototype.getPhi=function(){var t=this.phi;this.phi=0;return t};n.prototype.getTheta=function(){var t=this.theta;this.theta=0;return t};n.prototype.computeZoomLevel=function(){if(this.wheelDeltaY>0){this.zoomLevel++}else if(this.wheelDeltaY<0){this.zoomLevel--}};n.prototype.getStageMouse=function(t){var e=this.domElement.getBoundingClientRect(),r=e.left||0,n=e.top||0,a=0,o=0;if(t.targetTouches&&t.targetTouches.length>=1){a=t.targetTouches[0].clientX-r;o=t.targetTouches[0].clientY-n}else{a=t.clientX-r;o=t.clientY-n}return{x:a,y:o}}},function(t,e,r){"use strict";var n=r(4);t.exports=a;function a(t){n.call(this);this.models=[];this.camera=null;this.newModels=[];Object.assign(this,t)}a.prototype=Object.create(n.prototype);a.prototype.constructor=a;Object.assign(a.prototype,{nodeAddedDeep:function t(e){e.goDown(function(t){if(t.mesh){this.newModels.push(t)}}.bind(this))},nodeRemovedDeep:function t(e){e.goDown(function(t){if(t.mesh){var e=this.model.indexof(t);if(e!==-1){this.models.splice(e,1)}}}.bind(this))},render:function t(e,r){var n=e.id;if(this.newModels.length){for(var a=this.newModels.length-1;a>=0;a--){var o=this.newModels[a];if(!o.mesh[n]){o.mesh[n]=(Math.random()*Math.pow(32,6)).toString(36).slice(0,5);e.meshes.set(o.mesh[n],o.mesh);e.allocateBuffers(o.mesh)}this.models.push(this.newModels.splice(a,1)[0])}this.models.sort(function(t,e){var r=t.mesh[n]<e.mesh[n]?-1:t.mesh[n]>e.mesh[n]?1:0;var a=t.programName<e.programName?-1:t.programName>e.programName?1:0;return a||r})}var i=this.models,s=null,u=null,l=null,c=null,h=null,f=null,M=e.gl;for(var a=0,v=i.length;a<v;a++){s=i[a];c=s.mesh;if(h!==s.programName){if(u){u.unuse()}u=e.getProgram(s.programName);u.use();M.uniformMatrix4fv(u.UNIFORMS.uPMatrix,false,this.camera.pMatrix);M.uniformMatrix4fv(u.UNIFORMS.uVMatrix,false,this.camera.vMatrix);h=s.programName}if(f!==c[n]){l=e.getBuffersById(c[n]);u.prepareBuffers(c,l);f=c[n]}u.loadUniforms(s,r);M.uniformMatrix4fv(u.UNIFORMS.uMMatrix,false,s.getConcatenatedMatrix());M.drawElements(M[s.mode||"TRIANGLES"],c.indices.length,M.UNSIGNED_SHORT,0)}}})},function(t,e,r){"use strict";var n=r(5);t.exports=a;function a(t){n.call(this);this.matrix=this.mat4Create();Object.assign(this,t)}a.prototype=Object.create(n.prototype);a.prototype.constructor=a;Object.assign(a.prototype,{getConcatenatedMatrix:function t(){var e=this.mat4Create();this.mat4Multiply(this.matrix,e);this.goUp(function(t){this.mat4Multiply(t.matrix,e)}.bind(this));return e},searchTreeUp:function t(e){var r=this[e],n=this.parent;while(typeof r==="undefined"){if(n){r=n[e];n=n.parent}else{break}}return r},mat4Create:function t(){return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])},mat4Multiply:function t(e,r,n){var a=e;var o=r;var i=n||r;var s=a[0],u=a[4],l=a[8],c=a[12];var h=a[1],f=a[5],M=a[9],v=a[13];var d=a[2],m=a[6],p=a[10],x=a[14];var S=a[3],g=a[7],I=a[11],y=a[15];var D=o[0],b=o[4],F=o[8],w=o[12];var E=o[1],P=o[5],A=o[9],R=o[13];var _=o[2],z=o[6],L=o[10],C=o[14];var O=o[3],T=o[7],N=o[11],U=o[15];i[0]=s*D+u*E+l*_+c*O;i[4]=s*b+u*P+l*z+c*T;i[8]=s*F+u*A+l*L+c*N;i[12]=s*w+u*R+l*C+c*U;i[1]=h*D+f*E+M*_+v*O;i[5]=h*b+f*P+M*z+v*T;i[9]=h*F+f*A+M*L+v*N;i[13]=h*w+f*R+M*C+v*U;i[2]=d*D+m*E+p*_+x*O;i[6]=d*b+m*P+p*z+x*T;i[10]=d*F+m*A+p*L+x*N;i[14]=d*w+m*R+p*C+x*U;i[3]=S*D+g*E+I*_+y*O;i[7]=S*b+g*P+I*z+y*T;i[11]=S*F+g*A+I*L+y*N;i[15]=S*w+g*R+I*C+y*U}})},function(t,e){"use strict";var r=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(t,n.key,n)}}return function(e,r,n){if(r)t(e.prototype,r);if(n)t(e,n);return e}}();function n(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}var a=function(){function t(e){n(this,t);this.query="";this.id="root";this.ids=1e3;this.children=new Map;this.parent=null;this.state={};this.subs={};this.echo={};Object.assign(this,e);this.location=this.id;this.address=this.location+"?"+this.query;return this}r(t,[{key:"addChild",value:function t(e){if(e.parent){e.parent.removeChild(e)}e.id=String(this.ids++);e.location=e.location.split("-").slice(0,-1).concat([e.id]).join("-");e.address=e.address.split("-").slice(0,-1).concat([e.id+"?"+e.query]).join("-");e.children.forEach(function(t,r,n){t.location=[e.id].concat(t.location.split("-").slice(1)).join("-");t.address=[e.id+"?"+e.query].concat(t.address.split("-").slice(1)).join("-")}.bind(this));this.children.set(e.id,e);e.parent=this;e.goDown(function(t){t.root=this.root||this;t.location=this.location+"-"+t.location;t.address=this.address+"-"+t.address}.bind(this));this.nodeAdded&&this.nodeAdded(e);e.root.nodeAddedDeep&&e.root.nodeAddedDeep(e);return e}},{key:"removeChild",value:function t(e){e.children.delete(e.id);e.address="";e.location="";e.parent=null;this.nodeRemoved&&this.nodeRemoved(e);e.root.nodeRemovedDeep&&e.root.nodeRemovedDeep(e);return e}},{key:"setState",value:function t(e){this.state=Object.assign({},this.state,e);if(this.root){var r=Object.assign({address:this.address,location:this.location},this.state);this.root.dispatch(r);this.root.pack(r)}}},{key:"setEcho",value:function t(e){this.state=Object.assign({},this.state,e);this.onEcho&&this.onEcho(e);this.root&&this.root.onEchoDeep&&this.root.onEchoDeep(e,this)}},{key:"goUp",value:function t(e){var r=this.parent;var n=undefined;while(r&&typeof n==="undefined"){n=e(r);r=r.parent}return n}},{key:"goDown",value:function t(e,r){r=e(this);if(typeof r!=="undefined"){return r}var n=true;var a=false;var o=undefined;try{for(var i=this.children[Symbol.iterator](),s;!(n=(s=i.next()).done);n=true){var u=s.value;r=u[1].goDown(e,r);if(typeof r!=="undefined"){return r}}}catch(t){a=true;o=t}finally{try{if(!n&&i.return){i.return()}}finally{if(a){throw o}}}return r}},{key:"on",value:function t(e,r){var n=new RegExp(e,"gi");this.subs[e]=this.subs[e]||{exp:new RegExp(e),fns:new Set};this.subs[e].fns.add(r);return r}},{key:"off",value:function t(e,r){this.subs[e].fns.delete(r)}},{key:"dispatch",value:function t(e){for(var r in this.subs){if(this.subs[r].exp.test(e.address)){this.subs[r].fns.forEach(function(t){t(e)})}}}},{key:"deliver",value:function t(e){var r=e.location;if(!r){console.log("warn: delivering with no location",e);return}var n=r.split("-").slice(1);var a=this;var o=true;var i=false;var s=undefined;try{for(var u=n[Symbol.iterator](),l;!(o=(l=u.next()).done);o=true){var c=l.value;a=a.children.get(c);if(!a){break}}}catch(t){i=true;s=t}finally{try{if(!o&&u.return){u.return()}}finally{if(i){throw s}}}if(a){console.log("delivering:",e);a.state=Object.assign({},a.state,e);if(a.root){Object.assign({address:a.address,location:a.location},a.state);var h=a.root.pack(e)}return true}return false}},{key:"pack",value:function t(e){var r=e.address;var n=e.location;var a=n.split("-").slice(1);var o=this.echo;var i=true;var s=false;var u=undefined;try{for(var l=a[Symbol.iterator](),c;!(i=(c=l.next()).done);i=true){var h=c.value;o.c=o.c||{};o=o.c[h]=o.c[h]||{}}}catch(t){s=true;u=t}finally{try{if(!i&&l.return){l.return()}}finally{if(s){throw u}}}Object.assign(o,e)}},{key:"unpack",value:function t(e){var r=e.c;var n;this.setEcho(e);for(var a in r){if(n=this.children.get(a)){n.unpack(r[a])}}}}]);return t}();t.exports=a},function(t,e,r){"use strict";var n=r(7);var a=r(8);t.exports=o;function o(t){this.width=0;this.height=0;Object.assign(this,t)}o.prototype.init=function(t,e){this.width=t;this.height=e;this.vMatrix=n.mat4Create();this.pMatrix=n.mat4Create();a.mat4.perspective(this.pMatrix,70,t/e,.1,100);a.mat4.translate(this.vMatrix,this.vMatrix,[0,0,-3])};o.prototype.processInput=function(t){var e=this.vMatrix;if(t.checkIsKeyDown(33,81)){n.mat4TranslateZ(this.vMatrix,-.01)}else if(t.checkIsKeyDown(34,69)){n.mat4TranslateZ(this.vMatrix,.01)}if(t.checkIsKeyDown(37,65)){n.mat4TranslateX(this.vMatrix,.01)}else if(t.checkIsKeyDown(39,68)){n.mat4TranslateX(this.vMatrix,-.01)}if(t.checkIsKeyDown(38,87)){n.mat4TranslateY(this.vMatrix,-.01)}else if(t.checkIsKeyDown(40,83)){n.mat4TranslateY(this.vMatrix,+.01)}if(t.wheelDeltaY){n.mat4TranslateZ(this.vMatrix,t.wheelDeltaY/240);t.wheelDeltaY=0}}},function(t,e,r){"use strict";var n={_multiByMatrixInv:function t(e,r){return new Float32Array([r[0]*e[0]+r[1]*e[1]+r[2]*e[2]-(r[12]*r[0]+r[13]*r[1]+r[14]*r[2])*e[3],r[4]*e[0]+r[5]*e[1]+r[6]*e[2]-(r[12]*r[4]+r[13]*r[5]+r[14]*r[6])*e[3],r[8]*e[0]+r[9]*e[1]+r[10]*e[2]-(r[12]*r[8]+r[13]*r[9]+r[14]*r[10])*e[3]])},multPoint3ByMat4Inv:function t(e,r){e.push(1);return this._multiByMatrixInv(e,r)},multVec3ByMat4Inv:function t(e,r){e.push(0);return this._multiByMatrixInv(e,r)},degToRad:function t(e){return e*Math.PI/180},m4_x_v4:function t(e,r){return[e[0]*r[0]+e[4]*r[1]+e[8]*r[2]+e[12]*r[3],e[1]*r[0]+e[5]*r[1]+e[9]*r[2]+e[13]*r[3],e[2]*r[0]+e[6]*r[1]+e[10]*r[2]+e[14]*r[3],e[3]*r[0]+e[7]*r[1]+e[11]*r[2]+e[15]*r[3]]},mat4GetProjection:function t(e,r,n,a){var o=Math.tan(this.degToRad(.5*e)),i=-(a+n)/(a-n),s=-2*a*n/(a-n);return new Float32Array([.5/o,0,0,0,0,.5*r/o,0,0,0,0,i,-1,0,0,s,0])},mat4GetVec4:function t(e,r){e[0]=r[12];e[1]=r[13];e[2]=r[14];e[3]=r[15]},mat4TranslateRaw:function t(e,r){e[12]+=r[0];e[13]+=r[1];e[14]+=r[2]},mat4Create:function t(){return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])},mat4SetIdentity:function t(e){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1},mat3Create:function t(){return new Float32Array([1,0,0,0,1,0,0,0,1])},mat4RotateX:function t(e,r){var n=Math.cos(r);var a=Math.sin(r);var o=e[1],i=e[5],s=e[9];e[1]=e[1]*n-e[2]*a;e[5]=e[5]*n-e[6]*a;e[9]=e[9]*n-e[10]*a;e[2]=e[2]*n+o*a;e[6]=e[6]*n+i*a;e[10]=e[10]*n+s*a},mat4RotateY:function t(e,r){var n=Math.cos(r);var a=Math.sin(r);var o=e[0],i=e[4],s=e[8];e[0]=n*e[0]+a*e[2];e[4]=n*e[4]+a*e[6];e[8]=n*e[8]+a*e[10];e[2]=n*e[2]-a*o;e[6]=n*e[6]-a*i;e[10]=n*e[10]-a*s},mat4RotateZ:function t(e,r){var n=Math.cos(r);var a=Math.sin(r);var o=e[0],i=e[4],s=e[8];e[0]=n*e[0]-a*e[1];e[4]=n*e[4]-a*e[5];e[8]=n*e[8]-a*e[9];e[1]=n*e[1]+a*o;e[5]=n*e[5]+a*i;e[9]=n*e[9]+a*s},mat4TranslateZ:function t(e,r){e[14]+=r},mat4TranslateY:function t(e,r){e[13]+=r},mat4TranslateX:function t(e,r){e[12]+=r},mat4SetPosition:function t(e,r,n,a){e[12]=r,e[13]=n,e[14]=a},vec3Square:function t(e){return e[0]*e[0]+e[1]*e[1]+e[2]*e[2]},vec3GetUnit:function t(e){var r=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return r===0?[0,0,0]:[e[0]/r,e[1]/r,e[2]/r]},mat4Transpose43:function t(e,r){r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[1],r[4]=e[5],r[5]=e[9],r[6]=e[2],r[7]=e[6],r[8]=e[10]},vec3Normalize:function t(e){var r=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=r,e[1]/=r,e[2]/=r},mat4GetTranslationVec3:function t(e){return new Float32Array([e[12],e[13],e[14]])},vec3MultiplyByMat4:function t(e,r){return[e[0]*r[0]+e[4]*r[1]+e[8]*r[2]+e[12],e[1]*r[0]+e[5]*r[1]+e[9]*r[2]+e[13],e[2]*r[0]+e[6]*r[1]+e[10]*r[2]+e[14]]},vec3Sub:function t(e,r){return new Float32Array([r[0]-e[0],r[1]-e[1],r[2]-e[2]])},vec3SubNew:function t(e,r){return[r[0]-e[0],r[1]-e[1],r[2]-e[2]]},vec3Dot:function t(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]},vec3Size:function t(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])},vec3Cross:function t(e,r){return new Float32Array([e[1]*r[2]-e[2]*r[1],-e[0]*r[2]+e[2]*r[0],e[0]*r[1]-e[1]*r[0]])},vec3SquareNorm:function t(e){return e[0]*e[0]+e[1]*e[1]+e[2]*e[2]},mat4Multiply:function t(e,r,n){var a=r;var o=n;var i=e;var s=a[0],u=a[4],l=a[8],c=a[12];var h=a[1],f=a[5],M=a[9],v=a[13];var d=a[2],m=a[6],p=a[10],x=a[14];var S=a[3],g=a[7],I=a[11],y=a[15];var D=o[0],b=o[4],F=o[8],w=o[12];var E=o[1],P=o[5],A=o[9],R=o[13];var _=o[2],z=o[6],L=o[10],C=o[14];var O=o[3],T=o[7],N=o[11],U=o[15];i[0]=s*D+u*E+l*_+c*O;i[4]=s*b+u*P+l*z+c*T;i[8]=s*F+u*A+l*L+c*N;i[12]=s*w+u*R+l*C+c*U;i[1]=h*D+f*E+M*_+v*O;i[5]=h*b+f*P+M*z+v*T;i[9]=h*F+f*A+M*L+v*N;i[13]=h*w+f*R+M*C+v*U;i[2]=d*D+m*E+p*_+x*O;i[6]=d*b+m*P+p*z+x*T;i[10]=d*F+m*A+p*L+x*N;i[14]=d*w+m*R+p*C+x*U;i[3]=S*D+g*E+I*_+y*O;i[7]=S*b+g*P+I*z+y*T;i[11]=S*F+g*A+I*L+y*N;i[15]=S*w+g*R+I*C+y*U},mat4Scale:function t(e,r){var n=e;var a=r[0],o=r[1],i=r[2];n[0]*=a;n[5]*=o;n[10]*=i},mat4Inverse:function t(e,r){var n=new Float32Array(16),a,o;n[0]=e[5]*e[10]*e[15]-e[5]*e[11]*e[14]-e[9]*e[6]*e[15]+e[9]*e[7]*e[14]+e[13]*e[6]*e[11]-e[13]*e[7]*e[10];n[4]=-e[4]*e[10]*e[15]+e[4]*e[11]*e[14]+e[8]*e[6]*e[15]-e[8]*e[7]*e[14]-e[12]*e[6]*e[11]+e[12]*e[7]*e[10];n[8]=e[4]*e[9]*e[15]-e[4]*e[11]*e[13]-e[8]*e[5]*e[15]+e[8]*e[7]*e[13]+e[12]*e[5]*e[11]-e[12]*e[7]*e[9];n[12]=-e[4]*e[9]*e[14]+e[4]*e[10]*e[13]+e[8]*e[5]*e[14]-e[8]*e[6]*e[13]-e[12]*e[5]*e[10]+e[12]*e[6]*e[9];n[1]=-e[1]*e[10]*e[15]+e[1]*e[11]*e[14]+e[9]*e[2]*e[15]-e[9]*e[3]*e[14]-e[13]*e[2]*e[11]+e[13]*e[3]*e[10];n[5]=e[0]*e[10]*e[15]-e[0]*e[11]*e[14]-e[8]*e[2]*e[15]+e[8]*e[3]*e[14]+e[12]*e[2]*e[11]-e[12]*e[3]*e[10];n[9]=-e[0]*e[9]*e[15]+e[0]*e[11]*e[13]+e[8]*e[1]*e[15]-e[8]*e[3]*e[13]-e[12]*e[1]*e[11]+e[12]*e[3]*e[9];n[13]=e[0]*e[9]*e[14]-e[0]*e[10]*e[13]-e[8]*e[1]*e[14]+e[8]*e[2]*e[13]+e[12]*e[1]*e[10]-e[12]*e[2]*e[9];n[2]=e[1]*e[6]*e[15]-e[1]*e[7]*e[14]-e[5]*e[2]*e[15]+e[5]*e[3]*e[14]+e[13]*e[2]*e[7]-e[13]*e[3]*e[6];n[6]=-e[0]*e[6]*e[15]+e[0]*e[7]*e[14]+e[4]*e[2]*e[15]-e[4]*e[3]*e[14]-e[12]*e[2]*e[7]+e[12]*e[3]*e[6];n[10]=e[0]*e[5]*e[15]-e[0]*e[7]*e[13]-e[4]*e[1]*e[15]+e[4]*e[3]*e[13]+e[12]*e[1]*e[7]-e[12]*e[3]*e[5];n[14]=-e[0]*e[5]*e[14]+e[0]*e[6]*e[13]+e[4]*e[1]*e[14]-e[4]*e[2]*e[13]-e[12]*e[1]*e[6]+e[12]*e[2]*e[5];n[3]=-e[1]*e[6]*e[11]+e[1]*e[7]*e[10]+e[5]*e[2]*e[11]-e[5]*e[3]*e[10]-e[9]*e[2]*e[7]+e[9]*e[3]*e[6];n[7]=e[0]*e[6]*e[11]-e[0]*e[7]*e[10]-e[4]*e[2]*e[11]+e[4]*e[3]*e[10]+e[8]*e[2]*e[7]-e[8]*e[3]*e[6];n[11]=-e[0]*e[5]*e[11]+e[0]*e[7]*e[9]+e[4]*e[1]*e[11]-e[4]*e[3]*e[9]-e[8]*e[1]*e[7]+e[8]*e[3]*e[5];n[15]=e[0]*e[5]*e[10]-e[0]*e[6]*e[9]-e[4]*e[1]*e[10]+e[4]*e[2]*e[9]+e[8]*e[1]*e[6]-e[8]*e[2]*e[5];o=e[0]*n[0]+e[1]*n[4]+e[2]*n[8]+e[3]*n[12];if(o==0)return false;o=1/o;for(a=0;a<16;a++){r[a]=n[a]*o}return true}};if(true){t.exports=n}},function(t,e,r){e.glMatrix=r(9);e.mat2=r(10);e.mat2d=r(11);e.mat3=r(12);e.mat4=r(13);e.quat=r(14);e.vec2=r(17);e.vec3=r(15);e.vec4=r(16)},function(t,e){var r={};r.EPSILON=1e-6;r.ARRAY_TYPE=typeof Float32Array!=="undefined"?Float32Array:Array;r.RANDOM=Math.random;r.ENABLE_SIMD=false;r.SIMD_AVAILABLE=r.ARRAY_TYPE===Float32Array&&"SIMD"in this;r.USE_SIMD=r.ENABLE_SIMD&&r.SIMD_AVAILABLE;r.setMatrixArrayType=function(t){r.ARRAY_TYPE=t};var n=Math.PI/180;r.toRadian=function(t){return t*n};r.equals=function(t,e){return Math.abs(t-e)<=r.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))};t.exports=r},function(t,e,r){var n=r(9);var a={};a.create=function(){var t=new n.ARRAY_TYPE(4);t[0]=1;t[1]=0;t[2]=0;t[3]=1;return t};a.clone=function(t){var e=new n.ARRAY_TYPE(4);e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];return e};a.copy=function(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];return t};a.identity=function(t){t[0]=1;t[1]=0;t[2]=0;t[3]=1;return t};a.fromValues=function(t,e,r,a){var o=new n.ARRAY_TYPE(4);o[0]=t;o[1]=e;o[2]=r;o[3]=a;return o};a.set=function(t,e,r,n,a){t[0]=e;t[1]=r;t[2]=n;t[3]=a;return t};a.transpose=function(t,e){if(t===e){var r=e[1];t[1]=e[2];t[2]=r}else{t[0]=e[0];t[1]=e[2];t[2]=e[1];t[3]=e[3]}return t};a.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r*o-a*n;if(!i){return null}i=1/i;t[0]=o*i;t[1]=-n*i;t[2]=-a*i;t[3]=r*i;return t};a.adjoint=function(t,e){var r=e[0];t[0]=e[3];t[1]=-e[1];t[2]=-e[2];t[3]=r;return t};a.determinant=function(t){return t[0]*t[3]-t[2]*t[1]};a.multiply=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3];var s=r[0],u=r[1],l=r[2],c=r[3];t[0]=n*s+o*u;t[1]=a*s+i*u;t[2]=n*l+o*c;t[3]=a*l+i*c;return t};a.mul=a.multiply;a.rotate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=Math.sin(r),u=Math.cos(r);t[0]=n*u+o*s;t[1]=a*u+i*s;t[2]=n*-s+o*u;t[3]=a*-s+i*u;return t};a.scale=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=r[0],u=r[1];t[0]=n*s;t[1]=a*s;t[2]=o*u;t[3]=i*u;return t};a.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);t[0]=n;t[1]=r;t[2]=-r;t[3]=n;return t};a.fromScaling=function(t,e){t[0]=e[0];t[1]=0;t[2]=0;t[3]=e[1];return t};a.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"};a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))};a.LDU=function(t,e,r,n){t[2]=n[2]/n[0];r[0]=n[0];r[1]=n[1];r[3]=n[3]-t[2]*r[1];return[t,e,r]};a.add=function(t,e,r){t[0]=e[0]+r[0];t[1]=e[1]+r[1];t[2]=e[2]+r[2];t[3]=e[3]+r[3];return t};a.subtract=function(t,e,r){t[0]=e[0]-r[0];t[1]=e[1]-r[1];t[2]=e[2]-r[2];t[3]=e[3]-r[3];return t};a.sub=a.subtract;a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]};a.equals=function(t,e){var r=t[0],a=t[1],o=t[2],i=t[3];var s=e[0],u=e[1],l=e[2],c=e[3];return Math.abs(r-s)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(a-u)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(o-l)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(i-c)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))};a.multiplyScalar=function(t,e,r){t[0]=e[0]*r;t[1]=e[1]*r;t[2]=e[2]*r;t[3]=e[3]*r;return t};a.multiplyScalarAndAdd=function(t,e,r,n){t[0]=e[0]+r[0]*n;t[1]=e[1]+r[1]*n;t[2]=e[2]+r[2]*n;t[3]=e[3]+r[3]*n;return t};t.exports=a},function(t,e,r){var n=r(9);var a={};a.create=function(){var t=new n.ARRAY_TYPE(6);t[0]=1;t[1]=0;t[2]=0;t[3]=1;t[4]=0;t[5]=0;return t};a.clone=function(t){var e=new n.ARRAY_TYPE(6);e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[4]=t[4];e[5]=t[5];return e};a.copy=function(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];return t};a.identity=function(t){t[0]=1;t[1]=0;t[2]=0;t[3]=1;t[4]=0;t[5]=0;return t};a.fromValues=function(t,e,r,a,o,i){var s=new n.ARRAY_TYPE(6);s[0]=t;s[1]=e;s[2]=r;s[3]=a;s[4]=o;s[5]=i;return s};a.set=function(t,e,r,n,a,o,i){t[0]=e;t[1]=r;t[2]=n;t[3]=a;t[4]=o;t[5]=i;return t};a.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],s=e[5];var u=r*o-n*a;if(!u){return null}u=1/u;t[0]=o*u;t[1]=-n*u;t[2]=-a*u;t[3]=r*u;t[4]=(a*s-o*i)*u;t[5]=(n*i-r*s)*u;return t};a.determinant=function(t){return t[0]*t[3]-t[1]*t[2]};a.multiply=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],u=e[5],l=r[0],c=r[1],h=r[2],f=r[3],M=r[4],v=r[5];t[0]=n*l+o*c;t[1]=a*l+i*c;t[2]=n*h+o*f;t[3]=a*h+i*f;t[4]=n*M+o*v+s;t[5]=a*M+i*v+u;return t};a.mul=a.multiply;a.rotate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],u=e[5],l=Math.sin(r),c=Math.cos(r);t[0]=n*c+o*l;t[1]=a*c+i*l;t[2]=n*-l+o*c;t[3]=a*-l+i*c;t[4]=s;t[5]=u;return t};a.scale=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],u=e[5],l=r[0],c=r[1];t[0]=n*l;t[1]=a*l;t[2]=o*c;t[3]=i*c;t[4]=s;t[5]=u;return t};a.translate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],u=e[5],l=r[0],c=r[1];t[0]=n;t[1]=a;t[2]=o;t[3]=i;t[4]=n*l+o*c+s;t[5]=a*l+i*c+u;return t};a.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);t[0]=n;t[1]=r;t[2]=-r;t[3]=n;t[4]=0;t[5]=0;return t};a.fromScaling=function(t,e){t[0]=e[0];t[1]=0;t[2]=0;t[3]=e[1];t[4]=0;t[5]=0;return t};a.fromTranslation=function(t,e){t[0]=1;t[1]=0;t[2]=0;t[3]=1;t[4]=e[0];t[5]=e[1];return t};a.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"};a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)};a.add=function(t,e,r){t[0]=e[0]+r[0];t[1]=e[1]+r[1];t[2]=e[2]+r[2];t[3]=e[3]+r[3];t[4]=e[4]+r[4];t[5]=e[5]+r[5];return t};a.subtract=function(t,e,r){t[0]=e[0]-r[0];t[1]=e[1]-r[1];t[2]=e[2]-r[2];t[3]=e[3]-r[3];t[4]=e[4]-r[4];t[5]=e[5]-r[5];return t};a.sub=a.subtract;a.multiplyScalar=function(t,e,r){t[0]=e[0]*r;t[1]=e[1]*r;t[2]=e[2]*r;t[3]=e[3]*r;t[4]=e[4]*r;t[5]=e[5]*r;return t};a.multiplyScalarAndAdd=function(t,e,r,n){t[0]=e[0]+r[0]*n;t[1]=e[1]+r[1]*n;t[2]=e[2]+r[2]*n;t[3]=e[3]+r[3]*n;t[4]=e[4]+r[4]*n;t[5]=e[5]+r[5]*n;return t};a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]};a.equals=function(t,e){var r=t[0],a=t[1],o=t[2],i=t[3],s=t[4],u=t[5];var l=e[0],c=e[1],h=e[2],f=e[3],M=e[4],v=e[5];return Math.abs(r-l)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(a-c)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(o-h)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(i-f)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(s-M)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(u-v)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))};t.exports=a},function(t,e,r){var n=r(9);var a={};a.create=function(){var t=new n.ARRAY_TYPE(9);t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=1;t[5]=0;t[6]=0;t[7]=0;t[8]=1;return t};a.fromMat4=function(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[4];t[4]=e[5];t[5]=e[6];t[6]=e[8];t[7]=e[9];t[8]=e[10];return t};a.clone=function(t){var e=new n.ARRAY_TYPE(9);e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];e[8]=t[8];return e};a.copy=function(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];return t};a.fromValues=function(t,e,r,a,o,i,s,u,l){var c=new n.ARRAY_TYPE(9);c[0]=t;c[1]=e;c[2]=r;c[3]=a;c[4]=o;c[5]=i;c[6]=s;c[7]=u;c[8]=l;return c};a.set=function(t,e,r,n,a,o,i,s,u,l){t[0]=e;t[1]=r;t[2]=n;t[3]=a;t[4]=o;t[5]=i;t[6]=s;t[7]=u;t[8]=l;return t};a.identity=function(t){t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=1;t[5]=0;t[6]=0;t[7]=0;t[8]=1;return t};a.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],a=e[5];t[1]=e[3];t[2]=e[6];t[3]=r;t[5]=e[7];t[6]=n;t[7]=a}else{t[0]=e[0];t[1]=e[3];t[2]=e[6];t[3]=e[1];t[4]=e[4];t[5]=e[7];t[6]=e[2];t[7]=e[5];t[8]=e[8]}return t};a.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=c*i-s*l,f=-c*o+s*u,M=l*o-i*u,v=r*h+n*f+a*M;if(!v){return null}v=1/v;t[0]=h*v;t[1]=(-c*n+a*l)*v;t[2]=(s*n-a*i)*v;t[3]=f*v;t[4]=(c*r-a*u)*v;t[5]=(-s*r+a*o)*v;t[6]=M*v;t[7]=(-l*r+n*u)*v;t[8]=(i*r-n*o)*v;return t};a.adjoint=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],s=e[5],u=e[6],l=e[7],c=e[8];t[0]=i*c-s*l;t[1]=a*l-n*c;t[2]=n*s-a*i;t[3]=s*u-o*c;t[4]=r*c-a*u;t[5]=a*o-r*s;t[6]=o*l-i*u;t[7]=n*u-r*l;t[8]=r*i-n*o;return t};a.determinant=function(t){var e=t[0],r=t[1],n=t[2],a=t[3],o=t[4],i=t[5],s=t[6],u=t[7],l=t[8];return e*(l*o-i*u)+r*(-l*a+i*s)+n*(u*a-o*s)};a.multiply=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=r[0],M=r[1],v=r[2],d=r[3],m=r[4],p=r[5],x=r[6],S=r[7],g=r[8];t[0]=f*n+M*i+v*l;t[1]=f*a+M*s+v*c;t[2]=f*o+M*u+v*h;t[3]=d*n+m*i+p*l;t[4]=d*a+m*s+p*c;t[5]=d*o+m*u+p*h;t[6]=x*n+S*i+g*l;t[7]=x*a+S*s+g*c;t[8]=x*o+S*u+g*h;return t};a.mul=a.multiply;a.translate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=r[0],M=r[1];t[0]=n;t[1]=a;t[2]=o;t[3]=i;t[4]=s;t[5]=u;t[6]=f*n+M*i+l;t[7]=f*a+M*s+c;t[8]=f*o+M*u+h;return t};a.rotate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=Math.sin(r),M=Math.cos(r);t[0]=M*n+f*i;t[1]=M*a+f*s;t[2]=M*o+f*u;t[3]=M*i-f*n;t[4]=M*s-f*a;t[5]=M*u-f*o;t[6]=l;t[7]=c;t[8]=h;return t};a.scale=function(t,e,r){var n=r[0],a=r[1];t[0]=n*e[0];t[1]=n*e[1];t[2]=n*e[2];t[3]=a*e[3];t[4]=a*e[4];t[5]=a*e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];return t};a.fromTranslation=function(t,e){t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=1;t[5]=0;t[6]=e[0];t[7]=e[1];t[8]=1;return t};a.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);t[0]=n;t[1]=r;t[2]=0;t[3]=-r;t[4]=n;t[5]=0;t[6]=0;t[7]=0;t[8]=1;return t};a.fromScaling=function(t,e){t[0]=e[0];t[1]=0;t[2]=0;t[3]=0;t[4]=e[1];t[5]=0;t[6]=0;t[7]=0;t[8]=1;return t};a.fromMat2d=function(t,e){t[0]=e[0];t[1]=e[1];t[2]=0;t[3]=e[2];t[4]=e[3];t[5]=0;t[6]=e[4];t[7]=e[5];t[8]=1;return t};a.fromQuat=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r+r,s=n+n,u=a+a,l=r*i,c=n*i,h=n*s,f=a*i,M=a*s,v=a*u,d=o*i,m=o*s,p=o*u;t[0]=1-h-v;t[3]=c-p;t[6]=f+m;t[1]=c+p;t[4]=1-l-v;t[7]=M-d;t[2]=f-m;t[5]=M+d;t[8]=1-l-h;return t};a.normalFromMat4=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],M=e[11],v=e[12],d=e[13],m=e[14],p=e[15],x=r*s-n*i,S=r*u-a*i,g=r*l-o*i,I=n*u-a*s,y=n*l-o*s,D=a*l-o*u,b=c*d-h*v,F=c*m-f*v,w=c*p-M*v,E=h*m-f*d,P=h*p-M*d,A=f*p-M*m,R=x*A-S*P+g*E+I*w-y*F+D*b;if(!R){return null}R=1/R;t[0]=(s*A-u*P+l*E)*R;t[1]=(u*w-i*A-l*F)*R;t[2]=(i*P-s*w+l*b)*R;t[3]=(a*P-n*A-o*E)*R;t[4]=(r*A-a*w+o*F)*R;t[5]=(n*w-r*P-o*b)*R;t[6]=(d*D-m*y+p*I)*R;t[7]=(m*g-v*D-p*S)*R;t[8]=(v*y-d*g+p*x)*R;return t};a.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"};a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))};a.add=function(t,e,r){t[0]=e[0]+r[0];t[1]=e[1]+r[1];t[2]=e[2]+r[2];t[3]=e[3]+r[3];t[4]=e[4]+r[4];t[5]=e[5]+r[5];t[6]=e[6]+r[6];t[7]=e[7]+r[7];t[8]=e[8]+r[8];return t};a.subtract=function(t,e,r){t[0]=e[0]-r[0];t[1]=e[1]-r[1];t[2]=e[2]-r[2];t[3]=e[3]-r[3];t[4]=e[4]-r[4];t[5]=e[5]-r[5];t[6]=e[6]-r[6];t[7]=e[7]-r[7];t[8]=e[8]-r[8];return t};a.sub=a.subtract;a.multiplyScalar=function(t,e,r){t[0]=e[0]*r;t[1]=e[1]*r;t[2]=e[2]*r;t[3]=e[3]*r;t[4]=e[4]*r;t[5]=e[5]*r;t[6]=e[6]*r;t[7]=e[7]*r;t[8]=e[8]*r;return t};a.multiplyScalarAndAdd=function(t,e,r,n){t[0]=e[0]+r[0]*n;t[1]=e[1]+r[1]*n;t[2]=e[2]+r[2]*n;t[3]=e[3]+r[3]*n;t[4]=e[4]+r[4]*n;t[5]=e[5]+r[5]*n;t[6]=e[6]+r[6]*n;t[7]=e[7]+r[7]*n;t[8]=e[8]+r[8]*n;return t};a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]};a.equals=function(t,e){var r=t[0],a=t[1],o=t[2],i=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8];var f=e[0],M=e[1],v=e[2],d=e[3],m=e[4],p=e[5],x=t[6],S=e[7],g=e[8];return Math.abs(r-f)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(a-M)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(o-v)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(i-d)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(s-m)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(u-p)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))&&Math.abs(l-x)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(x))&&Math.abs(c-S)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(h-g)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(g));
};t.exports=a},function(t,e,r){var n=r(9);var a={scalar:{},SIMD:{}};a.create=function(){var t=new n.ARRAY_TYPE(16);t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=1;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=1;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};a.clone=function(t){var e=new n.ARRAY_TYPE(16);e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];e[8]=t[8];e[9]=t[9];e[10]=t[10];e[11]=t[11];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15];return e};a.copy=function(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t};a.fromValues=function(t,e,r,a,o,i,s,u,l,c,h,f,M,v,d,m){var p=new n.ARRAY_TYPE(16);p[0]=t;p[1]=e;p[2]=r;p[3]=a;p[4]=o;p[5]=i;p[6]=s;p[7]=u;p[8]=l;p[9]=c;p[10]=h;p[11]=f;p[12]=M;p[13]=v;p[14]=d;p[15]=m;return p};a.set=function(t,e,r,n,a,o,i,s,u,l,c,h,f,M,v,d,m){t[0]=e;t[1]=r;t[2]=n;t[3]=a;t[4]=o;t[5]=i;t[6]=s;t[7]=u;t[8]=l;t[9]=c;t[10]=h;t[11]=f;t[12]=M;t[13]=v;t[14]=d;t[15]=m;return t};a.identity=function(t){t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=1;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=1;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};a.scalar.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],a=e[3],o=e[6],i=e[7],s=e[11];t[1]=e[4];t[2]=e[8];t[3]=e[12];t[4]=r;t[6]=e[9];t[7]=e[13];t[8]=n;t[9]=o;t[11]=e[14];t[12]=a;t[13]=i;t[14]=s}else{t[0]=e[0];t[1]=e[4];t[2]=e[8];t[3]=e[12];t[4]=e[1];t[5]=e[5];t[6]=e[9];t[7]=e[13];t[8]=e[2];t[9]=e[6];t[10]=e[10];t[11]=e[14];t[12]=e[3];t[13]=e[7];t[14]=e[11];t[15]=e[15]}return t};a.SIMD.transpose=function(t,e){var r,n,a,o,i,s,u,l,c,h;r=SIMD.Float32x4.load(e,0);n=SIMD.Float32x4.load(e,4);a=SIMD.Float32x4.load(e,8);o=SIMD.Float32x4.load(e,12);i=SIMD.Float32x4.shuffle(r,n,0,1,4,5);s=SIMD.Float32x4.shuffle(a,o,0,1,4,5);u=SIMD.Float32x4.shuffle(i,s,0,2,4,6);l=SIMD.Float32x4.shuffle(i,s,1,3,5,7);SIMD.Float32x4.store(t,0,u);SIMD.Float32x4.store(t,4,l);i=SIMD.Float32x4.shuffle(r,n,2,3,6,7);s=SIMD.Float32x4.shuffle(a,o,2,3,6,7);c=SIMD.Float32x4.shuffle(i,s,0,2,4,6);h=SIMD.Float32x4.shuffle(i,s,1,3,5,7);SIMD.Float32x4.store(t,8,c);SIMD.Float32x4.store(t,12,h);return t};a.transpose=n.USE_SIMD?a.SIMD.transpose:a.scalar.transpose;a.scalar.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],M=e[11],v=e[12],d=e[13],m=e[14],p=e[15],x=r*s-n*i,S=r*u-a*i,g=r*l-o*i,I=n*u-a*s,y=n*l-o*s,D=a*l-o*u,b=c*d-h*v,F=c*m-f*v,w=c*p-M*v,E=h*m-f*d,P=h*p-M*d,A=f*p-M*m,R=x*A-S*P+g*E+I*w-y*F+D*b;if(!R){return null}R=1/R;t[0]=(s*A-u*P+l*E)*R;t[1]=(a*P-n*A-o*E)*R;t[2]=(d*D-m*y+p*I)*R;t[3]=(f*y-h*D-M*I)*R;t[4]=(u*w-i*A-l*F)*R;t[5]=(r*A-a*w+o*F)*R;t[6]=(m*g-v*D-p*S)*R;t[7]=(c*D-f*g+M*S)*R;t[8]=(i*P-s*w+l*b)*R;t[9]=(n*w-r*P-o*b)*R;t[10]=(v*y-d*g+p*x)*R;t[11]=(h*g-c*y-M*x)*R;t[12]=(s*F-i*E-u*b)*R;t[13]=(r*E-n*F+a*b)*R;t[14]=(d*S-v*I-m*x)*R;t[15]=(c*I-h*S+f*x)*R;return t};a.SIMD.invert=function(t,e){var r,n,a,o,i,s,u,l,c,h,f=SIMD.Float32x4.load(e,0),M=SIMD.Float32x4.load(e,4),v=SIMD.Float32x4.load(e,8),d=SIMD.Float32x4.load(e,12);i=SIMD.Float32x4.shuffle(f,M,0,1,4,5);n=SIMD.Float32x4.shuffle(v,d,0,1,4,5);r=SIMD.Float32x4.shuffle(i,n,0,2,4,6);n=SIMD.Float32x4.shuffle(n,i,1,3,5,7);i=SIMD.Float32x4.shuffle(f,M,2,3,6,7);o=SIMD.Float32x4.shuffle(v,d,2,3,6,7);a=SIMD.Float32x4.shuffle(i,o,0,2,4,6);o=SIMD.Float32x4.shuffle(o,i,1,3,5,7);i=SIMD.Float32x4.mul(a,o);i=SIMD.Float32x4.swizzle(i,1,0,3,2);s=SIMD.Float32x4.mul(n,i);u=SIMD.Float32x4.mul(r,i);i=SIMD.Float32x4.swizzle(i,2,3,0,1);s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,i),s);u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),u);u=SIMD.Float32x4.swizzle(u,2,3,0,1);i=SIMD.Float32x4.mul(n,a);i=SIMD.Float32x4.swizzle(i,1,0,3,2);s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),s);c=SIMD.Float32x4.mul(r,i);i=SIMD.Float32x4.swizzle(i,2,3,0,1);s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(o,i));c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),c);c=SIMD.Float32x4.swizzle(c,2,3,0,1);i=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n,2,3,0,1),o);i=SIMD.Float32x4.swizzle(i,1,0,3,2);a=SIMD.Float32x4.swizzle(a,2,3,0,1);s=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),s);l=SIMD.Float32x4.mul(r,i);i=SIMD.Float32x4.swizzle(i,2,3,0,1);s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(a,i));l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),l);l=SIMD.Float32x4.swizzle(l,2,3,0,1);i=SIMD.Float32x4.mul(r,n);i=SIMD.Float32x4.swizzle(i,1,0,3,2);l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),l);c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),c);i=SIMD.Float32x4.swizzle(i,2,3,0,1);l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,i),l);c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(a,i));i=SIMD.Float32x4.mul(r,o);i=SIMD.Float32x4.swizzle(i,1,0,3,2);u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(a,i));l=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,i),l);i=SIMD.Float32x4.swizzle(i,2,3,0,1);u=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),u);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(n,i));i=SIMD.Float32x4.mul(r,a);i=SIMD.Float32x4.swizzle(i,1,0,3,2);u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),u);c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(n,i));i=SIMD.Float32x4.swizzle(i,2,3,0,1);u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(o,i));c=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,i),c);h=SIMD.Float32x4.mul(r,s);h=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(h,2,3,0,1),h);h=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(h,1,0,3,2),h);i=SIMD.Float32x4.reciprocalApproximation(h);h=SIMD.Float32x4.sub(SIMD.Float32x4.add(i,i),SIMD.Float32x4.mul(h,SIMD.Float32x4.mul(i,i)));h=SIMD.Float32x4.swizzle(h,0,0,0,0);if(!h){return null}SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(h,s));SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(h,u));SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(h,l));SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(h,c));return t};a.invert=n.USE_SIMD?a.SIMD.invert:a.scalar.invert;a.scalar.adjoint=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],M=e[11],v=e[12],d=e[13],m=e[14],p=e[15];t[0]=s*(f*p-M*m)-h*(u*p-l*m)+d*(u*M-l*f);t[1]=-(n*(f*p-M*m)-h*(a*p-o*m)+d*(a*M-o*f));t[2]=n*(u*p-l*m)-s*(a*p-o*m)+d*(a*l-o*u);t[3]=-(n*(u*M-l*f)-s*(a*M-o*f)+h*(a*l-o*u));t[4]=-(i*(f*p-M*m)-c*(u*p-l*m)+v*(u*M-l*f));t[5]=r*(f*p-M*m)-c*(a*p-o*m)+v*(a*M-o*f);t[6]=-(r*(u*p-l*m)-i*(a*p-o*m)+v*(a*l-o*u));t[7]=r*(u*M-l*f)-i*(a*M-o*f)+c*(a*l-o*u);t[8]=i*(h*p-M*d)-c*(s*p-l*d)+v*(s*M-l*h);t[9]=-(r*(h*p-M*d)-c*(n*p-o*d)+v*(n*M-o*h));t[10]=r*(s*p-l*d)-i*(n*p-o*d)+v*(n*l-o*s);t[11]=-(r*(s*M-l*h)-i*(n*M-o*h)+c*(n*l-o*s));t[12]=-(i*(h*m-f*d)-c*(s*m-u*d)+v*(s*f-u*h));t[13]=r*(h*m-f*d)-c*(n*m-a*d)+v*(n*f-a*h);t[14]=-(r*(s*m-u*d)-i*(n*m-a*d)+v*(n*u-a*s));t[15]=r*(s*f-u*h)-i*(n*f-a*h)+c*(n*u-a*s);return t};a.SIMD.adjoint=function(t,e){var r,n,a,o;var i,s,u,l;var c;var h,f,M,v;var r=SIMD.Float32x4.load(e,0);var n=SIMD.Float32x4.load(e,4);var a=SIMD.Float32x4.load(e,8);var o=SIMD.Float32x4.load(e,12);c=SIMD.Float32x4.shuffle(r,n,0,1,4,5);s=SIMD.Float32x4.shuffle(a,o,0,1,4,5);i=SIMD.Float32x4.shuffle(c,s,0,2,4,6);s=SIMD.Float32x4.shuffle(s,c,1,3,5,7);c=SIMD.Float32x4.shuffle(r,n,2,3,6,7);l=SIMD.Float32x4.shuffle(a,o,2,3,6,7);u=SIMD.Float32x4.shuffle(c,l,0,2,4,6);l=SIMD.Float32x4.shuffle(l,c,1,3,5,7);c=SIMD.Float32x4.mul(u,l);c=SIMD.Float32x4.swizzle(c,1,0,3,2);h=SIMD.Float32x4.mul(s,c);f=SIMD.Float32x4.mul(i,c);c=SIMD.Float32x4.swizzle(c,2,3,0,1);h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),h);f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),f);f=SIMD.Float32x4.swizzle(f,2,3,0,1);c=SIMD.Float32x4.mul(s,u);c=SIMD.Float32x4.swizzle(c,1,0,3,2);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),h);v=SIMD.Float32x4.mul(i,c);c=SIMD.Float32x4.swizzle(c,2,3,0,1);h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(l,c));v=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),v);v=SIMD.Float32x4.swizzle(v,2,3,0,1);c=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,3,0,1),l);c=SIMD.Float32x4.swizzle(c,1,0,3,2);u=SIMD.Float32x4.swizzle(u,2,3,0,1);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),h);M=SIMD.Float32x4.mul(i,c);c=SIMD.Float32x4.swizzle(c,2,3,0,1);h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(u,c));M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),M);M=SIMD.Float32x4.swizzle(M,2,3,0,1);c=SIMD.Float32x4.mul(i,s);c=SIMD.Float32x4.swizzle(c,1,0,3,2);M=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),M);v=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,c),v);c=SIMD.Float32x4.swizzle(c,2,3,0,1);M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,c),M);v=SIMD.Float32x4.sub(v,SIMD.Float32x4.mul(u,c));c=SIMD.Float32x4.mul(i,l);c=SIMD.Float32x4.swizzle(c,1,0,3,2);f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(u,c));M=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),M);c=SIMD.Float32x4.swizzle(c,2,3,0,1);f=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),f);M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(s,c));c=SIMD.Float32x4.mul(i,u);c=SIMD.Float32x4.swizzle(c,1,0,3,2);f=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),f);v=SIMD.Float32x4.sub(v,SIMD.Float32x4.mul(s,c));c=SIMD.Float32x4.swizzle(c,2,3,0,1);f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(l,c));v=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),v);SIMD.Float32x4.store(t,0,h);SIMD.Float32x4.store(t,4,f);SIMD.Float32x4.store(t,8,M);SIMD.Float32x4.store(t,12,v);return t};a.adjoint=n.USE_SIMD?a.SIMD.adjoint:a.scalar.adjoint;a.determinant=function(t){var e=t[0],r=t[1],n=t[2],a=t[3],o=t[4],i=t[5],s=t[6],u=t[7],l=t[8],c=t[9],h=t[10],f=t[11],M=t[12],v=t[13],d=t[14],m=t[15],p=e*i-r*o,x=e*s-n*o,S=e*u-a*o,g=r*s-n*i,I=r*u-a*i,y=n*u-a*s,D=l*v-c*M,b=l*d-h*M,F=l*m-f*M,w=c*d-h*v,E=c*m-f*v,P=h*m-f*d;return p*P-x*E+S*w+g*F-I*b+y*D};a.SIMD.multiply=function(t,e,r){var n=SIMD.Float32x4.load(e,0);var a=SIMD.Float32x4.load(e,4);var o=SIMD.Float32x4.load(e,8);var i=SIMD.Float32x4.load(e,12);var s=SIMD.Float32x4.load(r,0);var u=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),i))));SIMD.Float32x4.store(t,0,u);var l=SIMD.Float32x4.load(r,4);var c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,3,3,3,3),i))));SIMD.Float32x4.store(t,4,c);var h=SIMD.Float32x4.load(r,8);var f=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),i))));SIMD.Float32x4.store(t,8,f);var M=SIMD.Float32x4.load(r,12);var v=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(M,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(M,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(M,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(M,3,3,3,3),i))));SIMD.Float32x4.store(t,12,v);return t};a.scalar.multiply=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=e[9],M=e[10],v=e[11],d=e[12],m=e[13],p=e[14],x=e[15];var S=r[0],g=r[1],I=r[2],y=r[3];t[0]=S*n+g*s+I*h+y*d;t[1]=S*a+g*u+I*f+y*m;t[2]=S*o+g*l+I*M+y*p;t[3]=S*i+g*c+I*v+y*x;S=r[4];g=r[5];I=r[6];y=r[7];t[4]=S*n+g*s+I*h+y*d;t[5]=S*a+g*u+I*f+y*m;t[6]=S*o+g*l+I*M+y*p;t[7]=S*i+g*c+I*v+y*x;S=r[8];g=r[9];I=r[10];y=r[11];t[8]=S*n+g*s+I*h+y*d;t[9]=S*a+g*u+I*f+y*m;t[10]=S*o+g*l+I*M+y*p;t[11]=S*i+g*c+I*v+y*x;S=r[12];g=r[13];I=r[14];y=r[15];t[12]=S*n+g*s+I*h+y*d;t[13]=S*a+g*u+I*f+y*m;t[14]=S*o+g*l+I*M+y*p;t[15]=S*i+g*c+I*v+y*x;return t};a.multiply=n.USE_SIMD?a.SIMD.multiply:a.scalar.multiply;a.mul=a.multiply;a.scalar.translate=function(t,e,r){var n=r[0],a=r[1],o=r[2],i,s,u,l,c,h,f,M,v,d,m,p;if(e===t){t[12]=e[0]*n+e[4]*a+e[8]*o+e[12];t[13]=e[1]*n+e[5]*a+e[9]*o+e[13];t[14]=e[2]*n+e[6]*a+e[10]*o+e[14];t[15]=e[3]*n+e[7]*a+e[11]*o+e[15]}else{i=e[0];s=e[1];u=e[2];l=e[3];c=e[4];h=e[5];f=e[6];M=e[7];v=e[8];d=e[9];m=e[10];p=e[11];t[0]=i;t[1]=s;t[2]=u;t[3]=l;t[4]=c;t[5]=h;t[6]=f;t[7]=M;t[8]=v;t[9]=d;t[10]=m;t[11]=p;t[12]=i*n+c*a+v*o+e[12];t[13]=s*n+h*a+d*o+e[13];t[14]=u*n+f*a+m*o+e[14];t[15]=l*n+M*a+p*o+e[15]}return t};a.SIMD.translate=function(t,e,r){var n=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4(r[0],r[1],r[2],0);if(e!==t){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11]}n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(s,0,0,0,0));a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(s,1,1,1,1));o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(s,2,2,2,2));var u=SIMD.Float32x4.add(n,SIMD.Float32x4.add(a,SIMD.Float32x4.add(o,i)));SIMD.Float32x4.store(t,12,u);return t};a.translate=n.USE_SIMD?a.SIMD.translate:a.scalar.translate;a.scalar.scale=function(t,e,r){var n=r[0],a=r[1],o=r[2];t[0]=e[0]*n;t[1]=e[1]*n;t[2]=e[2]*n;t[3]=e[3]*n;t[4]=e[4]*a;t[5]=e[5]*a;t[6]=e[6]*a;t[7]=e[7]*a;t[8]=e[8]*o;t[9]=e[9]*o;t[10]=e[10]*o;t[11]=e[11]*o;t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t};a.SIMD.scale=function(t,e,r){var n,a,o;var i=SIMD.Float32x4(r[0],r[1],r[2],0);n=SIMD.Float32x4.load(e,0);SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(i,0,0,0,0)));a=SIMD.Float32x4.load(e,4);SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(i,1,1,1,1)));o=SIMD.Float32x4.load(e,8);SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(i,2,2,2,2)));t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t};a.scale=n.USE_SIMD?a.SIMD.scale:a.scalar.scale;a.rotate=function(t,e,r,a){var o=a[0],i=a[1],s=a[2],u=Math.sqrt(o*o+i*i+s*s),l,c,h,f,M,v,d,m,p,x,S,g,I,y,D,b,F,w,E,P,A,R,_,z;if(Math.abs(u)<n.EPSILON){return null}u=1/u;o*=u;i*=u;s*=u;l=Math.sin(r);c=Math.cos(r);h=1-c;f=e[0];M=e[1];v=e[2];d=e[3];m=e[4];p=e[5];x=e[6];S=e[7];g=e[8];I=e[9];y=e[10];D=e[11];b=o*o*h+c;F=i*o*h+s*l;w=s*o*h-i*l;E=o*i*h-s*l;P=i*i*h+c;A=s*i*h+o*l;R=o*s*h+i*l;_=i*s*h-o*l;z=s*s*h+c;t[0]=f*b+m*F+g*w;t[1]=M*b+p*F+I*w;t[2]=v*b+x*F+y*w;t[3]=d*b+S*F+D*w;t[4]=f*E+m*P+g*A;t[5]=M*E+p*P+I*A;t[6]=v*E+x*P+y*A;t[7]=d*E+S*P+D*A;t[8]=f*R+m*_+g*z;t[9]=M*R+p*_+I*z;t[10]=v*R+x*_+y*z;t[11]=d*R+S*_+D*z;if(e!==t){t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15]}return t};a.scalar.rotateX=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),o=e[4],i=e[5],s=e[6],u=e[7],l=e[8],c=e[9],h=e[10],f=e[11];if(e!==t){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15]}t[4]=o*a+l*n;t[5]=i*a+c*n;t[6]=s*a+h*n;t[7]=u*a+f*n;t[8]=l*a-o*n;t[9]=c*a-i*n;t[10]=h*a-s*n;t[11]=f*a-u*n;return t};a.SIMD.rotateX=function(t,e,r){var n=SIMD.Float32x4.splat(Math.sin(r)),a=SIMD.Float32x4.splat(Math.cos(r));if(e!==t){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15]}var o=SIMD.Float32x4.load(e,4);var i=SIMD.Float32x4.load(e,8);SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,n)));SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,n)));return t};a.rotateX=n.USE_SIMD?a.SIMD.rotateX:a.scalar.rotateX;a.scalar.rotateY=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),o=e[0],i=e[1],s=e[2],u=e[3],l=e[8],c=e[9],h=e[10],f=e[11];if(e!==t){t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15]}t[0]=o*a-l*n;t[1]=i*a-c*n;t[2]=s*a-h*n;t[3]=u*a-f*n;t[8]=o*n+l*a;t[9]=i*n+c*a;t[10]=s*n+h*a;t[11]=u*n+f*a;return t};a.SIMD.rotateY=function(t,e,r){var n=SIMD.Float32x4.splat(Math.sin(r)),a=SIMD.Float32x4.splat(Math.cos(r));if(e!==t){t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15]}var o=SIMD.Float32x4.load(e,0);var i=SIMD.Float32x4.load(e,8);SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,n)));SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(i,a)));return t};a.rotateY=n.USE_SIMD?a.SIMD.rotateY:a.scalar.rotateY;a.scalar.rotateZ=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),o=e[0],i=e[1],s=e[2],u=e[3],l=e[4],c=e[5],h=e[6],f=e[7];if(e!==t){t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15]}t[0]=o*a+l*n;t[1]=i*a+c*n;t[2]=s*a+h*n;t[3]=u*a+f*n;t[4]=l*a-o*n;t[5]=c*a-i*n;t[6]=h*a-s*n;t[7]=f*a-u*n;return t};a.SIMD.rotateZ=function(t,e,r){var n=SIMD.Float32x4.splat(Math.sin(r)),a=SIMD.Float32x4.splat(Math.cos(r));if(e!==t){t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15]}var o=SIMD.Float32x4.load(e,0);var i=SIMD.Float32x4.load(e,4);SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,n)));SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,n)));return t};a.rotateZ=n.USE_SIMD?a.SIMD.rotateZ:a.scalar.rotateZ;a.fromTranslation=function(t,e){t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=1;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=1;t[11]=0;t[12]=e[0];t[13]=e[1];t[14]=e[2];t[15]=1;return t};a.fromScaling=function(t,e){t[0]=e[0];t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=e[1];t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=e[2];t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};a.fromRotation=function(t,e,r){var a=r[0],o=r[1],i=r[2],s=Math.sqrt(a*a+o*o+i*i),u,l,c;if(Math.abs(s)<n.EPSILON){return null}s=1/s;a*=s;o*=s;i*=s;u=Math.sin(e);l=Math.cos(e);c=1-l;t[0]=a*a*c+l;t[1]=o*a*c+i*u;t[2]=i*a*c-o*u;t[3]=0;t[4]=a*o*c-i*u;t[5]=o*o*c+l;t[6]=i*o*c+a*u;t[7]=0;t[8]=a*i*c+o*u;t[9]=o*i*c-a*u;t[10]=i*i*c+l;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};a.fromXRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=n;t[6]=r;t[7]=0;t[8]=0;t[9]=-r;t[10]=n;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};a.fromYRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);t[0]=n;t[1]=0;t[2]=-r;t[3]=0;t[4]=0;t[5]=1;t[6]=0;t[7]=0;t[8]=r;t[9]=0;t[10]=n;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};a.fromZRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);t[0]=n;t[1]=r;t[2]=0;t[3]=0;t[4]=-r;t[5]=n;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=1;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};a.fromRotationTranslation=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=n+n,u=a+a,l=o+o,c=n*s,h=n*u,f=n*l,M=a*u,v=a*l,d=o*l,m=i*s,p=i*u,x=i*l;t[0]=1-(M+d);t[1]=h+x;t[2]=f-p;t[3]=0;t[4]=h-x;t[5]=1-(c+d);t[6]=v+m;t[7]=0;t[8]=f+p;t[9]=v-m;t[10]=1-(c+M);t[11]=0;t[12]=r[0];t[13]=r[1];t[14]=r[2];t[15]=1;return t};a.getTranslation=function(t,e){t[0]=e[12];t[1]=e[13];t[2]=e[14];return t};a.getRotation=function(t,e){var r=e[0]+e[5]+e[10];var n=0;if(r>0){n=Math.sqrt(r+1)*2;t[3]=.25*n;t[0]=(e[6]-e[9])/n;t[1]=(e[8]-e[2])/n;t[2]=(e[1]-e[4])/n}else if(e[0]>e[5]&e[0]>e[10]){n=Math.sqrt(1+e[0]-e[5]-e[10])*2;t[3]=(e[6]-e[9])/n;t[0]=.25*n;t[1]=(e[1]+e[4])/n;t[2]=(e[8]+e[2])/n}else if(e[5]>e[10]){n=Math.sqrt(1+e[5]-e[0]-e[10])*2;t[3]=(e[8]-e[2])/n;t[0]=(e[1]+e[4])/n;t[1]=.25*n;t[2]=(e[6]+e[9])/n}else{n=Math.sqrt(1+e[10]-e[0]-e[5])*2;t[3]=(e[1]-e[4])/n;t[0]=(e[8]+e[2])/n;t[1]=(e[6]+e[9])/n;t[2]=.25*n}return t};a.fromRotationTranslationScale=function(t,e,r,n){var a=e[0],o=e[1],i=e[2],s=e[3],u=a+a,l=o+o,c=i+i,h=a*u,f=a*l,M=a*c,v=o*l,d=o*c,m=i*c,p=s*u,x=s*l,S=s*c,g=n[0],I=n[1],y=n[2];t[0]=(1-(v+m))*g;t[1]=(f+S)*g;t[2]=(M-x)*g;t[3]=0;t[4]=(f-S)*I;t[5]=(1-(h+m))*I;t[6]=(d+p)*I;t[7]=0;t[8]=(M+x)*y;t[9]=(d-p)*y;t[10]=(1-(h+v))*y;t[11]=0;t[12]=r[0];t[13]=r[1];t[14]=r[2];t[15]=1;return t};a.fromRotationTranslationScaleOrigin=function(t,e,r,n,a){var o=e[0],i=e[1],s=e[2],u=e[3],l=o+o,c=i+i,h=s+s,f=o*l,M=o*c,v=o*h,d=i*c,m=i*h,p=s*h,x=u*l,S=u*c,g=u*h,I=n[0],y=n[1],D=n[2],b=a[0],F=a[1],w=a[2];t[0]=(1-(d+p))*I;t[1]=(M+g)*I;t[2]=(v-S)*I;t[3]=0;t[4]=(M-g)*y;t[5]=(1-(f+p))*y;t[6]=(m+x)*y;t[7]=0;t[8]=(v+S)*D;t[9]=(m-x)*D;t[10]=(1-(f+d))*D;t[11]=0;t[12]=r[0]+b-(t[0]*b+t[4]*F+t[8]*w);t[13]=r[1]+F-(t[1]*b+t[5]*F+t[9]*w);t[14]=r[2]+w-(t[2]*b+t[6]*F+t[10]*w);t[15]=1;return t};a.fromQuat=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r+r,s=n+n,u=a+a,l=r*i,c=n*i,h=n*s,f=a*i,M=a*s,v=a*u,d=o*i,m=o*s,p=o*u;t[0]=1-h-v;t[1]=c+p;t[2]=f-m;t[3]=0;t[4]=c-p;t[5]=1-l-v;t[6]=M+d;t[7]=0;t[8]=f+m;t[9]=M-d;t[10]=1-l-h;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};a.frustum=function(t,e,r,n,a,o,i){var s=1/(r-e),u=1/(a-n),l=1/(o-i);t[0]=o*2*s;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=o*2*u;t[6]=0;t[7]=0;t[8]=(r+e)*s;t[9]=(a+n)*u;t[10]=(i+o)*l;t[11]=-1;t[12]=0;t[13]=0;t[14]=i*o*2*l;t[15]=0;return t};a.perspective=function(t,e,r,n,a){var o=1/Math.tan(e/2),i=1/(n-a);t[0]=o/r;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=o;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=(a+n)*i;t[11]=-1;t[12]=0;t[13]=0;t[14]=2*a*n*i;t[15]=0;return t};a.perspectiveFromFieldOfView=function(t,e,r,n){var a=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(i+s),l=2/(a+o);t[0]=u;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=l;t[6]=0;t[7]=0;t[8]=-((i-s)*u*.5);t[9]=(a-o)*l*.5;t[10]=n/(r-n);t[11]=-1;t[12]=0;t[13]=0;t[14]=n*r/(r-n);t[15]=0;return t};a.ortho=function(t,e,r,n,a,o,i){var s=1/(e-r),u=1/(n-a),l=1/(o-i);t[0]=-2*s;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=-2*u;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=2*l;t[11]=0;t[12]=(e+r)*s;t[13]=(a+n)*u;t[14]=(i+o)*l;t[15]=1;return t};a.lookAt=function(t,e,r,o){var i,s,u,l,c,h,f,M,v,d,m=e[0],p=e[1],x=e[2],S=o[0],g=o[1],I=o[2],y=r[0],D=r[1],b=r[2];if(Math.abs(m-y)<n.EPSILON&&Math.abs(p-D)<n.EPSILON&&Math.abs(x-b)<n.EPSILON){return a.identity(t)}f=m-y;M=p-D;v=x-b;d=1/Math.sqrt(f*f+M*M+v*v);f*=d;M*=d;v*=d;i=g*v-I*M;s=I*f-S*v;u=S*M-g*f;d=Math.sqrt(i*i+s*s+u*u);if(!d){i=0;s=0;u=0}else{d=1/d;i*=d;s*=d;u*=d}l=M*u-v*s;c=v*i-f*u;h=f*s-M*i;d=Math.sqrt(l*l+c*c+h*h);if(!d){l=0;c=0;h=0}else{d=1/d;l*=d;c*=d;h*=d}t[0]=i;t[1]=l;t[2]=f;t[3]=0;t[4]=s;t[5]=c;t[6]=M;t[7]=0;t[8]=u;t[9]=h;t[10]=v;t[11]=0;t[12]=-(i*m+s*p+u*x);t[13]=-(l*m+c*p+h*x);t[14]=-(f*m+M*p+v*x);t[15]=1;return t};a.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"};a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))};a.add=function(t,e,r){t[0]=e[0]+r[0];t[1]=e[1]+r[1];t[2]=e[2]+r[2];t[3]=e[3]+r[3];t[4]=e[4]+r[4];t[5]=e[5]+r[5];t[6]=e[6]+r[6];t[7]=e[7]+r[7];t[8]=e[8]+r[8];t[9]=e[9]+r[9];t[10]=e[10]+r[10];t[11]=e[11]+r[11];t[12]=e[12]+r[12];t[13]=e[13]+r[13];t[14]=e[14]+r[14];t[15]=e[15]+r[15];return t};a.subtract=function(t,e,r){t[0]=e[0]-r[0];t[1]=e[1]-r[1];t[2]=e[2]-r[2];t[3]=e[3]-r[3];t[4]=e[4]-r[4];t[5]=e[5]-r[5];t[6]=e[6]-r[6];t[7]=e[7]-r[7];t[8]=e[8]-r[8];t[9]=e[9]-r[9];t[10]=e[10]-r[10];t[11]=e[11]-r[11];t[12]=e[12]-r[12];t[13]=e[13]-r[13];t[14]=e[14]-r[14];t[15]=e[15]-r[15];return t};a.sub=a.subtract;a.multiplyScalar=function(t,e,r){t[0]=e[0]*r;t[1]=e[1]*r;t[2]=e[2]*r;t[3]=e[3]*r;t[4]=e[4]*r;t[5]=e[5]*r;t[6]=e[6]*r;t[7]=e[7]*r;t[8]=e[8]*r;t[9]=e[9]*r;t[10]=e[10]*r;t[11]=e[11]*r;t[12]=e[12]*r;t[13]=e[13]*r;t[14]=e[14]*r;t[15]=e[15]*r;return t};a.multiplyScalarAndAdd=function(t,e,r,n){t[0]=e[0]+r[0]*n;t[1]=e[1]+r[1]*n;t[2]=e[2]+r[2]*n;t[3]=e[3]+r[3]*n;t[4]=e[4]+r[4]*n;t[5]=e[5]+r[5]*n;t[6]=e[6]+r[6]*n;t[7]=e[7]+r[7]*n;t[8]=e[8]+r[8]*n;t[9]=e[9]+r[9]*n;t[10]=e[10]+r[10]*n;t[11]=e[11]+r[11]*n;t[12]=e[12]+r[12]*n;t[13]=e[13]+r[13]*n;t[14]=e[14]+r[14]*n;t[15]=e[15]+r[15]*n;return t};a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]};a.equals=function(t,e){var r=t[0],a=t[1],o=t[2],i=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],f=t[9],M=t[10],v=t[11],d=t[12],m=t[13],p=t[14],x=t[15];var S=e[0],g=e[1],I=e[2],y=e[3],D=e[4],b=e[5],F=e[6],w=e[7],E=e[8],P=e[9],A=e[10],R=e[11],_=e[12],z=e[13],L=e[14],C=e[15];return Math.abs(r-S)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(S))&&Math.abs(a-g)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(o-I)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(I))&&Math.abs(i-y)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(s-D)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(D))&&Math.abs(u-b)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(b))&&Math.abs(l-F)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(c-w)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(h-E)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(f-P)<=n.EPSILON*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(M-A)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(A))&&Math.abs(v-R)<=n.EPSILON*Math.max(1,Math.abs(v),Math.abs(R))&&Math.abs(d-_)<=n.EPSILON*Math.max(1,Math.abs(d),Math.abs(_))&&Math.abs(m-z)<=n.EPSILON*Math.max(1,Math.abs(m),Math.abs(z))&&Math.abs(p-L)<=n.EPSILON*Math.max(1,Math.abs(p),Math.abs(L))&&Math.abs(x-C)<=n.EPSILON*Math.max(1,Math.abs(x),Math.abs(C))};t.exports=a},function(t,e,r){var n=r(9);var a=r(12);var o=r(15);var i=r(16);var s={};s.create=function(){var t=new n.ARRAY_TYPE(4);t[0]=0;t[1]=0;t[2]=0;t[3]=1;return t};s.rotationTo=function(){var t=o.create();var e=o.fromValues(1,0,0);var r=o.fromValues(0,1,0);return function(n,a,i){var u=o.dot(a,i);if(u<-.999999){o.cross(t,e,a);if(o.length(t)<1e-6)o.cross(t,r,a);o.normalize(t,t);s.setAxisAngle(n,t,Math.PI);return n}else if(u>.999999){n[0]=0;n[1]=0;n[2]=0;n[3]=1;return n}else{o.cross(t,a,i);n[0]=t[0];n[1]=t[1];n[2]=t[2];n[3]=1+u;return s.normalize(n,n)}}}();s.setAxes=function(){var t=a.create();return function(e,r,n,a){t[0]=n[0];t[3]=n[1];t[6]=n[2];t[1]=a[0];t[4]=a[1];t[7]=a[2];t[2]=-r[0];t[5]=-r[1];t[8]=-r[2];return s.normalize(e,s.fromMat3(e,t))}}();s.clone=i.clone;s.fromValues=i.fromValues;s.copy=i.copy;s.set=i.set;s.identity=function(t){t[0]=0;t[1]=0;t[2]=0;t[3]=1;return t};s.setAxisAngle=function(t,e,r){r=r*.5;var n=Math.sin(r);t[0]=n*e[0];t[1]=n*e[1];t[2]=n*e[2];t[3]=Math.cos(r);return t};s.getAxisAngle=function(t,e){var r=Math.acos(e[3])*2;var n=Math.sin(r/2);if(n!=0){t[0]=e[0]/n;t[1]=e[1]/n;t[2]=e[2]/n}else{t[0]=1;t[1]=0;t[2]=0}return r};s.add=i.add;s.multiply=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=r[0],u=r[1],l=r[2],c=r[3];t[0]=n*c+i*s+a*l-o*u;t[1]=a*c+i*u+o*s-n*l;t[2]=o*c+i*l+n*u-a*s;t[3]=i*c-n*s-a*u-o*l;return t};s.mul=s.multiply;s.scale=i.scale;s.rotateX=function(t,e,r){r*=.5;var n=e[0],a=e[1],o=e[2],i=e[3],s=Math.sin(r),u=Math.cos(r);t[0]=n*u+i*s;t[1]=a*u+o*s;t[2]=o*u-a*s;t[3]=i*u-n*s;return t};s.rotateY=function(t,e,r){r*=.5;var n=e[0],a=e[1],o=e[2],i=e[3],s=Math.sin(r),u=Math.cos(r);t[0]=n*u-o*s;t[1]=a*u+i*s;t[2]=o*u+n*s;t[3]=i*u-a*s;return t};s.rotateZ=function(t,e,r){r*=.5;var n=e[0],a=e[1],o=e[2],i=e[3],s=Math.sin(r),u=Math.cos(r);t[0]=n*u+a*s;t[1]=a*u-n*s;t[2]=o*u+i*s;t[3]=i*u-o*s;return t};s.calculateW=function(t,e){var r=e[0],n=e[1],a=e[2];t[0]=r;t[1]=n;t[2]=a;t[3]=Math.sqrt(Math.abs(1-r*r-n*n-a*a));return t};s.dot=i.dot;s.lerp=i.lerp;s.slerp=function(t,e,r,n){var a=e[0],o=e[1],i=e[2],s=e[3],u=r[0],l=r[1],c=r[2],h=r[3];var f,M,v,d,m;M=a*u+o*l+i*c+s*h;if(M<0){M=-M;u=-u;l=-l;c=-c;h=-h}if(1-M>1e-6){f=Math.acos(M);v=Math.sin(f);d=Math.sin((1-n)*f)/v;m=Math.sin(n*f)/v}else{d=1-n;m=n}t[0]=d*a+m*u;t[1]=d*o+m*l;t[2]=d*i+m*c;t[3]=d*s+m*h;return t};s.sqlerp=function(){var t=s.create();var e=s.create();return function(r,n,a,o,i,u){s.slerp(t,n,i,u);s.slerp(e,a,o,u);s.slerp(r,t,e,2*u*(1-u));return r}}();s.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r*r+n*n+a*a+o*o,s=i?1/i:0;t[0]=-r*s;t[1]=-n*s;t[2]=-a*s;t[3]=o*s;return t};s.conjugate=function(t,e){t[0]=-e[0];t[1]=-e[1];t[2]=-e[2];t[3]=e[3];return t};s.length=i.length;s.len=s.length;s.squaredLength=i.squaredLength;s.sqrLen=s.squaredLength;s.normalize=i.normalize;s.fromMat3=function(t,e){var r=e[0]+e[4]+e[8];var n;if(r>0){n=Math.sqrt(r+1);t[3]=.5*n;n=.5/n;t[0]=(e[5]-e[7])*n;t[1]=(e[6]-e[2])*n;t[2]=(e[1]-e[3])*n}else{var a=0;if(e[4]>e[0])a=1;if(e[8]>e[a*3+a])a=2;var o=(a+1)%3;var i=(a+2)%3;n=Math.sqrt(e[a*3+a]-e[o*3+o]-e[i*3+i]+1);t[a]=.5*n;n=.5/n;t[3]=(e[o*3+i]-e[i*3+o])*n;t[o]=(e[o*3+a]+e[a*3+o])*n;t[i]=(e[i*3+a]+e[a*3+i])*n}return t};s.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"};s.exactEquals=i.exactEquals;s.equals=i.equals;t.exports=s},function(t,e,r){var n=r(9);var a={};a.create=function(){var t=new n.ARRAY_TYPE(3);t[0]=0;t[1]=0;t[2]=0;return t};a.clone=function(t){var e=new n.ARRAY_TYPE(3);e[0]=t[0];e[1]=t[1];e[2]=t[2];return e};a.fromValues=function(t,e,r){var a=new n.ARRAY_TYPE(3);a[0]=t;a[1]=e;a[2]=r;return a};a.copy=function(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];return t};a.set=function(t,e,r,n){t[0]=e;t[1]=r;t[2]=n;return t};a.add=function(t,e,r){t[0]=e[0]+r[0];t[1]=e[1]+r[1];t[2]=e[2]+r[2];return t};a.subtract=function(t,e,r){t[0]=e[0]-r[0];t[1]=e[1]-r[1];t[2]=e[2]-r[2];return t};a.sub=a.subtract;a.multiply=function(t,e,r){t[0]=e[0]*r[0];t[1]=e[1]*r[1];t[2]=e[2]*r[2];return t};a.mul=a.multiply;a.divide=function(t,e,r){t[0]=e[0]/r[0];t[1]=e[1]/r[1];t[2]=e[2]/r[2];return t};a.div=a.divide;a.ceil=function(t,e){t[0]=Math.ceil(e[0]);t[1]=Math.ceil(e[1]);t[2]=Math.ceil(e[2]);return t};a.floor=function(t,e){t[0]=Math.floor(e[0]);t[1]=Math.floor(e[1]);t[2]=Math.floor(e[2]);return t};a.min=function(t,e,r){t[0]=Math.min(e[0],r[0]);t[1]=Math.min(e[1],r[1]);t[2]=Math.min(e[2],r[2]);return t};a.max=function(t,e,r){t[0]=Math.max(e[0],r[0]);t[1]=Math.max(e[1],r[1]);t[2]=Math.max(e[2],r[2]);return t};a.round=function(t,e){t[0]=Math.round(e[0]);t[1]=Math.round(e[1]);t[2]=Math.round(e[2]);return t};a.scale=function(t,e,r){t[0]=e[0]*r;t[1]=e[1]*r;t[2]=e[2]*r;return t};a.scaleAndAdd=function(t,e,r,n){t[0]=e[0]+r[0]*n;t[1]=e[1]+r[1]*n;t[2]=e[2]+r[2]*n;return t};a.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return Math.sqrt(r*r+n*n+a*a)};a.dist=a.distance;a.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return r*r+n*n+a*a};a.sqrDist=a.squaredDistance;a.length=function(t){var e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)};a.len=a.length;a.squaredLength=function(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n};a.sqrLen=a.squaredLength;a.negate=function(t,e){t[0]=-e[0];t[1]=-e[1];t[2]=-e[2];return t};a.inverse=function(t,e){t[0]=1/e[0];t[1]=1/e[1];t[2]=1/e[2];return t};a.normalize=function(t,e){var r=e[0],n=e[1],a=e[2];var o=r*r+n*n+a*a;if(o>0){o=1/Math.sqrt(o);t[0]=e[0]*o;t[1]=e[1]*o;t[2]=e[2]*o}return t};a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]};a.cross=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=r[0],s=r[1],u=r[2];t[0]=a*u-o*s;t[1]=o*i-n*u;t[2]=n*s-a*i;return t};a.lerp=function(t,e,r,n){var a=e[0],o=e[1],i=e[2];t[0]=a+n*(r[0]-a);t[1]=o+n*(r[1]-o);t[2]=i+n*(r[2]-i);return t};a.hermite=function(t,e,r,n,a,o){var i=o*o,s=i*(2*o-3)+1,u=i*(o-2)+o,l=i*(o-1),c=i*(3-2*o);t[0]=e[0]*s+r[0]*u+n[0]*l+a[0]*c;t[1]=e[1]*s+r[1]*u+n[1]*l+a[1]*c;t[2]=e[2]*s+r[2]*u+n[2]*l+a[2]*c;return t};a.bezier=function(t,e,r,n,a,o){var i=1-o,s=i*i,u=o*o,l=s*i,c=3*o*s,h=3*u*i,f=u*o;t[0]=e[0]*l+r[0]*c+n[0]*h+a[0]*f;t[1]=e[1]*l+r[1]*c+n[1]*h+a[1]*f;t[2]=e[2]*l+r[2]*c+n[2]*h+a[2]*f;return t};a.random=function(t,e){e=e||1;var r=n.RANDOM()*2*Math.PI;var a=n.RANDOM()*2-1;var o=Math.sqrt(1-a*a)*e;t[0]=Math.cos(r)*o;t[1]=Math.sin(r)*o;t[2]=a*e;return t};a.transformMat4=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=r[3]*n+r[7]*a+r[11]*o+r[15];i=i||1;t[0]=(r[0]*n+r[4]*a+r[8]*o+r[12])/i;t[1]=(r[1]*n+r[5]*a+r[9]*o+r[13])/i;t[2]=(r[2]*n+r[6]*a+r[10]*o+r[14])/i;return t};a.transformMat3=function(t,e,r){var n=e[0],a=e[1],o=e[2];t[0]=n*r[0]+a*r[3]+o*r[6];t[1]=n*r[1]+a*r[4]+o*r[7];t[2]=n*r[2]+a*r[5]+o*r[8];return t};a.transformQuat=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=r[0],s=r[1],u=r[2],l=r[3],c=l*n+s*o-u*a,h=l*a+u*n-i*o,f=l*o+i*a-s*n,M=-i*n-s*a-u*o;t[0]=c*l+M*-i+h*-u-f*-s;t[1]=h*l+M*-s+f*-i-c*-u;t[2]=f*l+M*-u+c*-s-h*-i;
return t};a.rotateX=function(t,e,r,n){var a=[],o=[];a[0]=e[0]-r[0];a[1]=e[1]-r[1];a[2]=e[2]-r[2];o[0]=a[0];o[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n);o[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n);t[0]=o[0]+r[0];t[1]=o[1]+r[1];t[2]=o[2]+r[2];return t};a.rotateY=function(t,e,r,n){var a=[],o=[];a[0]=e[0]-r[0];a[1]=e[1]-r[1];a[2]=e[2]-r[2];o[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n);o[1]=a[1];o[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n);t[0]=o[0]+r[0];t[1]=o[1]+r[1];t[2]=o[2]+r[2];return t};a.rotateZ=function(t,e,r,n){var a=[],o=[];a[0]=e[0]-r[0];a[1]=e[1]-r[1];a[2]=e[2]-r[2];o[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n);o[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n);o[2]=a[2];t[0]=o[0]+r[0];t[1]=o[1]+r[1];t[2]=o[2]+r[2];return t};a.forEach=function(){var t=a.create();return function(e,r,n,a,o,i){var s,u;if(!r){r=3}if(!n){n=0}if(a){u=Math.min(a*r+n,e.length)}else{u=e.length}for(s=n;s<u;s+=r){t[0]=e[s];t[1]=e[s+1];t[2]=e[s+2];o(t,t,i);e[s]=t[0];e[s+1]=t[1];e[s+2]=t[2]}return e}}();a.angle=function(t,e){var r=a.fromValues(t[0],t[1],t[2]);var n=a.fromValues(e[0],e[1],e[2]);a.normalize(r,r);a.normalize(n,n);var o=a.dot(r,n);if(o>1){return 0}else{return Math.acos(o)}};a.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"};a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]};a.equals=function(t,e){var r=t[0],a=t[1],o=t[2];var i=e[0],s=e[1],u=e[2];return Math.abs(r-i)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(a-s)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(o-u)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))};t.exports=a},function(t,e,r){var n=r(9);var a={};a.create=function(){var t=new n.ARRAY_TYPE(4);t[0]=0;t[1]=0;t[2]=0;t[3]=0;return t};a.clone=function(t){var e=new n.ARRAY_TYPE(4);e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];return e};a.fromValues=function(t,e,r,a){var o=new n.ARRAY_TYPE(4);o[0]=t;o[1]=e;o[2]=r;o[3]=a;return o};a.copy=function(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];return t};a.set=function(t,e,r,n,a){t[0]=e;t[1]=r;t[2]=n;t[3]=a;return t};a.add=function(t,e,r){t[0]=e[0]+r[0];t[1]=e[1]+r[1];t[2]=e[2]+r[2];t[3]=e[3]+r[3];return t};a.subtract=function(t,e,r){t[0]=e[0]-r[0];t[1]=e[1]-r[1];t[2]=e[2]-r[2];t[3]=e[3]-r[3];return t};a.sub=a.subtract;a.multiply=function(t,e,r){t[0]=e[0]*r[0];t[1]=e[1]*r[1];t[2]=e[2]*r[2];t[3]=e[3]*r[3];return t};a.mul=a.multiply;a.divide=function(t,e,r){t[0]=e[0]/r[0];t[1]=e[1]/r[1];t[2]=e[2]/r[2];t[3]=e[3]/r[3];return t};a.div=a.divide;a.ceil=function(t,e){t[0]=Math.ceil(e[0]);t[1]=Math.ceil(e[1]);t[2]=Math.ceil(e[2]);t[3]=Math.ceil(e[3]);return t};a.floor=function(t,e){t[0]=Math.floor(e[0]);t[1]=Math.floor(e[1]);t[2]=Math.floor(e[2]);t[3]=Math.floor(e[3]);return t};a.min=function(t,e,r){t[0]=Math.min(e[0],r[0]);t[1]=Math.min(e[1],r[1]);t[2]=Math.min(e[2],r[2]);t[3]=Math.min(e[3],r[3]);return t};a.max=function(t,e,r){t[0]=Math.max(e[0],r[0]);t[1]=Math.max(e[1],r[1]);t[2]=Math.max(e[2],r[2]);t[3]=Math.max(e[3],r[3]);return t};a.round=function(t,e){t[0]=Math.round(e[0]);t[1]=Math.round(e[1]);t[2]=Math.round(e[2]);t[3]=Math.round(e[3]);return t};a.scale=function(t,e,r){t[0]=e[0]*r;t[1]=e[1]*r;t[2]=e[2]*r;t[3]=e[3]*r;return t};a.scaleAndAdd=function(t,e,r,n){t[0]=e[0]+r[0]*n;t[1]=e[1]+r[1]*n;t[2]=e[2]+r[2]*n;t[3]=e[3]+r[3]*n;return t};a.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(r*r+n*n+a*a+o*o)};a.dist=a.distance;a.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],o=e[3]-t[3];return r*r+n*n+a*a+o*o};a.sqrDist=a.squaredDistance;a.length=function(t){var e=t[0],r=t[1],n=t[2],a=t[3];return Math.sqrt(e*e+r*r+n*n+a*a)};a.len=a.length;a.squaredLength=function(t){var e=t[0],r=t[1],n=t[2],a=t[3];return e*e+r*r+n*n+a*a};a.sqrLen=a.squaredLength;a.negate=function(t,e){t[0]=-e[0];t[1]=-e[1];t[2]=-e[2];t[3]=-e[3];return t};a.inverse=function(t,e){t[0]=1/e[0];t[1]=1/e[1];t[2]=1/e[2];t[3]=1/e[3];return t};a.normalize=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3];var i=r*r+n*n+a*a+o*o;if(i>0){i=1/Math.sqrt(i);t[0]=r*i;t[1]=n*i;t[2]=a*i;t[3]=o*i}return t};a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]};a.lerp=function(t,e,r,n){var a=e[0],o=e[1],i=e[2],s=e[3];t[0]=a+n*(r[0]-a);t[1]=o+n*(r[1]-o);t[2]=i+n*(r[2]-i);t[3]=s+n*(r[3]-s);return t};a.random=function(t,e){e=e||1;t[0]=n.RANDOM();t[1]=n.RANDOM();t[2]=n.RANDOM();t[3]=n.RANDOM();a.normalize(t,t);a.scale(t,t,e);return t};a.transformMat4=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3];t[0]=r[0]*n+r[4]*a+r[8]*o+r[12]*i;t[1]=r[1]*n+r[5]*a+r[9]*o+r[13]*i;t[2]=r[2]*n+r[6]*a+r[10]*o+r[14]*i;t[3]=r[3]*n+r[7]*a+r[11]*o+r[15]*i;return t};a.transformQuat=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=r[0],s=r[1],u=r[2],l=r[3],c=l*n+s*o-u*a,h=l*a+u*n-i*o,f=l*o+i*a-s*n,M=-i*n-s*a-u*o;t[0]=c*l+M*-i+h*-u-f*-s;t[1]=h*l+M*-s+f*-i-c*-u;t[2]=f*l+M*-u+c*-s-h*-i;t[3]=e[3];return t};a.forEach=function(){var t=a.create();return function(e,r,n,a,o,i){var s,u;if(!r){r=4}if(!n){n=0}if(a){u=Math.min(a*r+n,e.length)}else{u=e.length}for(s=n;s<u;s+=r){t[0]=e[s];t[1]=e[s+1];t[2]=e[s+2];t[3]=e[s+3];o(t,t,i);e[s]=t[0];e[s+1]=t[1];e[s+2]=t[2];e[s+3]=t[3]}return e}}();a.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"};a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]};a.equals=function(t,e){var r=t[0],a=t[1],o=t[2],i=t[3];var s=e[0],u=e[1],l=e[2],c=e[3];return Math.abs(r-s)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(a-u)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(o-l)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(i-c)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))};t.exports=a},function(t,e,r){var n=r(9);var a={};a.create=function(){var t=new n.ARRAY_TYPE(2);t[0]=0;t[1]=0;return t};a.clone=function(t){var e=new n.ARRAY_TYPE(2);e[0]=t[0];e[1]=t[1];return e};a.fromValues=function(t,e){var r=new n.ARRAY_TYPE(2);r[0]=t;r[1]=e;return r};a.copy=function(t,e){t[0]=e[0];t[1]=e[1];return t};a.set=function(t,e,r){t[0]=e;t[1]=r;return t};a.add=function(t,e,r){t[0]=e[0]+r[0];t[1]=e[1]+r[1];return t};a.subtract=function(t,e,r){t[0]=e[0]-r[0];t[1]=e[1]-r[1];return t};a.sub=a.subtract;a.multiply=function(t,e,r){t[0]=e[0]*r[0];t[1]=e[1]*r[1];return t};a.mul=a.multiply;a.divide=function(t,e,r){t[0]=e[0]/r[0];t[1]=e[1]/r[1];return t};a.div=a.divide;a.ceil=function(t,e){t[0]=Math.ceil(e[0]);t[1]=Math.ceil(e[1]);return t};a.floor=function(t,e){t[0]=Math.floor(e[0]);t[1]=Math.floor(e[1]);return t};a.min=function(t,e,r){t[0]=Math.min(e[0],r[0]);t[1]=Math.min(e[1],r[1]);return t};a.max=function(t,e,r){t[0]=Math.max(e[0],r[0]);t[1]=Math.max(e[1],r[1]);return t};a.round=function(t,e){t[0]=Math.round(e[0]);t[1]=Math.round(e[1]);return t};a.scale=function(t,e,r){t[0]=e[0]*r;t[1]=e[1]*r;return t};a.scaleAndAdd=function(t,e,r,n){t[0]=e[0]+r[0]*n;t[1]=e[1]+r[1]*n;return t};a.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)};a.dist=a.distance;a.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n};a.sqrDist=a.squaredDistance;a.length=function(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)};a.len=a.length;a.squaredLength=function(t){var e=t[0],r=t[1];return e*e+r*r};a.sqrLen=a.squaredLength;a.negate=function(t,e){t[0]=-e[0];t[1]=-e[1];return t};a.inverse=function(t,e){t[0]=1/e[0];t[1]=1/e[1];return t};a.normalize=function(t,e){var r=e[0],n=e[1];var a=r*r+n*n;if(a>0){a=1/Math.sqrt(a);t[0]=e[0]*a;t[1]=e[1]*a}return t};a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]};a.cross=function(t,e,r){var n=e[0]*r[1]-e[1]*r[0];t[0]=t[1]=0;t[2]=n;return t};a.lerp=function(t,e,r,n){var a=e[0],o=e[1];t[0]=a+n*(r[0]-a);t[1]=o+n*(r[1]-o);return t};a.random=function(t,e){e=e||1;var r=n.RANDOM()*2*Math.PI;t[0]=Math.cos(r)*e;t[1]=Math.sin(r)*e;return t};a.transformMat2=function(t,e,r){var n=e[0],a=e[1];t[0]=r[0]*n+r[2]*a;t[1]=r[1]*n+r[3]*a;return t};a.transformMat2d=function(t,e,r){var n=e[0],a=e[1];t[0]=r[0]*n+r[2]*a+r[4];t[1]=r[1]*n+r[3]*a+r[5];return t};a.transformMat3=function(t,e,r){var n=e[0],a=e[1];t[0]=r[0]*n+r[3]*a+r[6];t[1]=r[1]*n+r[4]*a+r[7];return t};a.transformMat4=function(t,e,r){var n=e[0],a=e[1];t[0]=r[0]*n+r[4]*a+r[12];t[1]=r[1]*n+r[5]*a+r[13];return t};a.forEach=function(){var t=a.create();return function(e,r,n,a,o,i){var s,u;if(!r){r=2}if(!n){n=0}if(a){u=Math.min(a*r+n,e.length)}else{u=e.length}for(s=n;s<u;s+=r){t[0]=e[s];t[1]=e[s+1];o(t,t,i);e[s]=t[0];e[s+1]=t[1]}return e}}();a.str=function(t){return"vec2("+t[0]+", "+t[1]+")"};a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]};a.equals=function(t,e){var r=t[0],a=t[1];var o=e[0],i=e[1];return Math.abs(r-o)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(a-i)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(i))};t.exports=a},function(t,e){"use strict";t.exports={ray_triangle_Akenine_Moller:s,check_each_face_of_object:M,create_mat4:g,invert_mat4:S,normalize_vec3:x,normalize_mouse:f,get_origin_eye_space:c,get_origin_model_space:h,get_direction_eye_space:u,get_direction_model_space:l,get_direction_and_origin:a,get_direction_and_origin_eyespace:o,getObjectsUnderMouse:r,getIntersections:n,ray_plane:i};function r(t,e,r,n,a,o,i,s,v,d){var m=t;var p=f(e,r,n,a);var x=g();var I=g();S(x,o);S(I,i);var y=g();var D=u(p.x,p.y,x,I);var b=c(I);var F=[];for(var w=0,E=m.length;w<E;w++){var P=m[w];var A;if(v){A=v(P)}else{A=P}if(!A){continue}var R;if(A.getConcatenatedMatrix){R=A.getConcatenatedMatrix()}else{R=A.matrix}S(y,R);var _=l(D,y);var z=h(b,y);var L=M(A,z,_,A.offset||s||3,d);if(L){F.push(P)}}return F}function n(t,e,r,n,a,o){var i=[];for(var s=0,u=t.length;s<u;s++){var c=t[s];var f;if(a){f=a(c)}else{f=c}if(!f){continue}var v;var d=g();if(f.getConcatenatedMatrix){v=f.getConcatenatedMatrix()}else{v=f.matrix}S(d,v);var m=l(r,d);var p=h(e,d);var x=M(f,p,m,f.offset||n||3,o);if(x){i.push(c)}}return i}function a(t,e,r,n,a,o,i){var s=f(t,e,r,n);var M=g();var v=g();var d=g();S(M,a);S(v,o);S(d,i);var m=u(s.x,s.y,M,v);var p=c(v);var x=l(m,d);var I=h(p,d);return{origin:I,direction:x}}function o(t,e,r,n,a,o){var i=f(t,e,r,n);var s=g();var l=g();var h=g();S(s,a);S(l,o);var M=u(i.x,i.y,s,l);var v=c(l);return{origin:v,direction:M}}function i(t,e,r,n,a,o,i,s,M,I,y){var D=f(t,e,r,n);var b=g();var F=g();var w=g();S(b,a);S(F,o);S(w,i);var E=u(D.x,D.y,b,F);var P=c(F);var A=l(E,w);var R=h(P,w);var _=[0,0,0],z=[0,0,0],L=[0,0,0],C=[0,0,0],O=null,T=null,N=null,U=[0,0,0];p(z,M,s);p(L,y,s);d(_,z,L);x(_);O=m(A,_);if(O<v){console.log("parallel");return 0}p(C,s,R);T=m(C,_);N=T/O;return[R[0]+A[0]*N,R[1]+A[1]*N,R[2]+A[2]*N,1]}function s(t,e,r,n,a,o){var i,s,u;var l=[0,0,0],c=[0,0,0],h=[0,0,0],f=[0,0,0],M=[0,0,0],x=0,S=0;p(l,n,r);p(c,a,r);d(f,e,c);x=m(l,f);if(o){if(x<v){return 0}p(h,t,r);s=DOT(h,f);if(s<0||s>x){return 0}d(M,h,l);u=m(e,M);if(u<0||s+u>x){return 0}i=m(c,M);S=1/x;i*=S;s*=S;u*=S}else{if(x>-v&&x<v){return 0}S=1/x;p(h,t,r);s=m(h,f)*S;if(s<0||s>1){return 0}d(M,h,l);u=m(e,M)*S;if(u<0||s+u>1){return 0}i=m(c,M)*S}return{u:s,v:u,t:i}}function u(t,e,r,n){var a=[t,e,-1,0];I(a,r,a);a[2]=-1;a[3]=0;I(a,n,a);return a}function l(t,e){var r=t.slice(0);I(r,e,r);return r}function c(t){var e=[0,0,0,1];I(e,t,e);return e}function h(t,e){var r=t.slice(0);I(r,e,r);return r}function f(t,e,r,n){var a=t/(r/2)-1;var o=1-e/(n/2);return{x:a,y:o}}function M(t,e,r,n,a){var o=t.vertices||t.mesh.vertices;var i=t.indices||t.mesh.indices;var u,l,c,h,f,M;for(var v=0,d=i.length;v<d;v+=3){h=i[v];f=i[v+1];M=i[v+2];if(a){u=a(o[h*n],o[h*n+1],o[h*n+2]);l=a(o[f*n],o[f*n+1],o[f*n+2]);c=a(o[M*n],o[M*n+1],o[M*n+2])}else{u=[o[h*n],o[h*n+1],o[h*n+2]];l=[o[f*n],o[f*n+1],o[f*n+2]];c=[o[M*n],o[M*n+1],o[M*n+2]]}if(s(e,r,u,l,c,false)){return true}}}var v=1e-6;function d(t,e,r){t[0]=e[1]*r[2]-e[2]*r[1];t[1]=e[2]*r[0]-e[0]*r[2];t[2]=e[0]*r[1]-e[1]*r[0]}function m(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function p(t,e,r){t[0]=e[0]-r[0];t[1]=e[1]-r[1];t[2]=e[2]-r[2]}function x(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function S(t,e){var r=new Float32Array(16),n,a;r[0]=e[5]*e[10]*e[15]-e[5]*e[11]*e[14]-e[9]*e[6]*e[15]+e[9]*e[7]*e[14]+e[13]*e[6]*e[11]-e[13]*e[7]*e[10];r[4]=-e[4]*e[10]*e[15]+e[4]*e[11]*e[14]+e[8]*e[6]*e[15]-e[8]*e[7]*e[14]-e[12]*e[6]*e[11]+e[12]*e[7]*e[10];r[8]=e[4]*e[9]*e[15]-e[4]*e[11]*e[13]-e[8]*e[5]*e[15]+e[8]*e[7]*e[13]+e[12]*e[5]*e[11]-e[12]*e[7]*e[9];r[12]=-e[4]*e[9]*e[14]+e[4]*e[10]*e[13]+e[8]*e[5]*e[14]-e[8]*e[6]*e[13]-e[12]*e[5]*e[10]+e[12]*e[6]*e[9];r[1]=-e[1]*e[10]*e[15]+e[1]*e[11]*e[14]+e[9]*e[2]*e[15]-e[9]*e[3]*e[14]-e[13]*e[2]*e[11]+e[13]*e[3]*e[10];r[5]=e[0]*e[10]*e[15]-e[0]*e[11]*e[14]-e[8]*e[2]*e[15]+e[8]*e[3]*e[14]+e[12]*e[2]*e[11]-e[12]*e[3]*e[10];r[9]=-e[0]*e[9]*e[15]+e[0]*e[11]*e[13]+e[8]*e[1]*e[15]-e[8]*e[3]*e[13]-e[12]*e[1]*e[11]+e[12]*e[3]*e[9];r[13]=e[0]*e[9]*e[14]-e[0]*e[10]*e[13]-e[8]*e[1]*e[14]+e[8]*e[2]*e[13]+e[12]*e[1]*e[10]-e[12]*e[2]*e[9];r[2]=e[1]*e[6]*e[15]-e[1]*e[7]*e[14]-e[5]*e[2]*e[15]+e[5]*e[3]*e[14]+e[13]*e[2]*e[7]-e[13]*e[3]*e[6];r[6]=-e[0]*e[6]*e[15]+e[0]*e[7]*e[14]+e[4]*e[2]*e[15]-e[4]*e[3]*e[14]-e[12]*e[2]*e[7]+e[12]*e[3]*e[6];r[10]=e[0]*e[5]*e[15]-e[0]*e[7]*e[13]-e[4]*e[1]*e[15]+e[4]*e[3]*e[13]+e[12]*e[1]*e[7]-e[12]*e[3]*e[5];r[14]=-e[0]*e[5]*e[14]+e[0]*e[6]*e[13]+e[4]*e[1]*e[14]-e[4]*e[2]*e[13]-e[12]*e[1]*e[6]+e[12]*e[2]*e[5];r[3]=-e[1]*e[6]*e[11]+e[1]*e[7]*e[10]+e[5]*e[2]*e[11]-e[5]*e[3]*e[10]-e[9]*e[2]*e[7]+e[9]*e[3]*e[6];r[7]=e[0]*e[6]*e[11]-e[0]*e[7]*e[10]-e[4]*e[2]*e[11]+e[4]*e[3]*e[10]+e[8]*e[2]*e[7]-e[8]*e[3]*e[6];r[11]=-e[0]*e[5]*e[11]+e[0]*e[7]*e[9]+e[4]*e[1]*e[11]-e[4]*e[3]*e[9]-e[8]*e[1]*e[7]+e[8]*e[3]*e[5];r[15]=e[0]*e[5]*e[10]-e[0]*e[6]*e[9]-e[4]*e[1]*e[10]+e[4]*e[2]*e[9]+e[8]*e[1]*e[6]-e[8]*e[2]*e[5];a=e[0]*r[0]+e[1]*r[4]+e[2]*r[8]+e[3]*r[12];if(a==0)return false;a=1/a;for(n=0;n<16;n++){t[n]=r[n]*a}return true}function g(){return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function I(t,e,r){var n,a,o,i;n=e[0]*r[0]+e[4]*r[1]+e[8]*r[2]+e[12]*r[3];a=e[1]*r[0]+e[5]*r[1]+e[9]*r[2]+e[13]*r[3];o=e[2]*r[0]+e[6]*r[1]+e[10]*r[2]+e[14]*r[3];i=e[3]*r[0]+e[7]*r[1]+e[11]*r[2]+e[15]*r[3];t[0]=n;t[1]=a;t[2]=o;t[3]=i}function y(t,e,r){var n=e;var a=r;var o=t;var i=n[0],s=n[4],u=n[8],l=n[12];var c=n[1],h=n[5],f=n[9],M=n[13];var v=n[2],d=n[6],m=n[10],p=n[14];var x=n[3],S=n[7],g=n[11],I=n[15];var y=a[0],D=a[4],b=a[8],F=a[12];var w=a[1],E=a[5],P=a[9],A=a[13];var R=a[2],_=a[6],z=a[10],L=a[14];var C=a[3],O=a[7],T=a[11],N=a[15];o[0]=i*y+s*w+u*R+l*C;o[4]=i*D+s*E+u*_+l*O;o[8]=i*b+s*P+u*z+l*T;o[12]=i*F+s*A+u*L+l*N;o[1]=c*y+h*w+f*R+M*C;o[5]=c*D+h*E+f*_+M*O;o[9]=c*b+h*P+f*z+M*T;o[13]=c*F+h*A+f*L+M*N;o[2]=v*y+d*w+m*R+p*C;o[6]=v*D+d*E+m*_+p*O;o[10]=v*b+d*P+m*z+p*T;o[14]=v*F+d*A+m*L+p*N;o[3]=x*y+S*w+g*R+I*C;o[7]=x*D+S*E+g*_+I*O;o[11]=x*b+S*P+g*z+I*T;o[15]=x*F+S*A+g*L+I*N}},function(t,e,r){"use strict";var n=r(20);var a=r(4);var o=r(7);var i=r(18);var s=r(21);var u=r(23);t.exports=l;function l(t){a.call(this);this.uIsFlat=1;this.uCoeff=0;this.mouseMoveTargets=[];this.selectColor=[0,1,0,1];Object.assign(this,t);this.init()}l.prototype=Object.create(a.prototype);l.prototype.constructor=l;l.prototype.init=function(){var t=0;for(var e=0,r=this.countryFeatures.length;e<r;e++){var a=this.countryFeatures[e];var o=s.getTriangulatedPolygon(a);var c=new n({id:e,name:a.properties.name,name_long:a.properties.name_long,name_sort:a.properties.name_sort,admin:a.properties.admin,landColor:[Math.random(),Math.random(),Math.random(),1],landVertices:o.vertices,landIndices:o.indices});this.addChild(c);t+=Array.from(this.children.values())[this.children.size-1].landVertices.length}console.info("Countries' total vertices: "+t);this.onMouseMove=function(t,e,r){if(r.isDragging){return}var n=i.getObjectsUnderMouse(Array.from(this.children.values()),e.x,e.y,r.domElement.width,r.domElement.height,r.camera.pMatrix,r.camera.vMatrix,3,l.prototype.processObject.bind(this),l.prototype.processVertex.bind(this));this.mouseMoveTargets.splice(0);for(var a=0,o=n.length;a<o;a++){this.mouseMoveTargets.push({id:n[a].id})}};this.onMouseDownLeft=function(t,e,r){if(r.isMouseDownRight){return}var n=i.getObjectsUnderMouse(Array.from(this.children.values()),e.x,e.y,r.domElement.width,r.domElement.height,r.camera.pMatrix,r.camera.vMatrix,3,l.prototype.processObject.bind(this),l.prototype.processVertex.bind(this));if(n.length>0){u.getPage(this.children.get(n[0].id).admin,function(t){document.getElementById("info").innerHTML=t.firstPassage},10)}}};l.prototype.processInput=function(t){o.mat4SetIdentity(this.matrix);o.mat4Scale(this.matrix,[.5,.5,.5]);if(this.uIsFlat==1){o.mat4RotateX(this.matrix,t.phi);o.mat4RotateY(this.matrix,t.theta);if(this.uCoeff>0){this.uCoeff-=.01}else{this.uCoeff=0}}else{o.mat4RotateY(this.matrix,t.theta);o.mat4RotateZ(this.matrix,23.5*Math.PI/180);if(this.uCoeff<1){this.uCoeff+=.01}else{this.uCoeff=1}}};l.prototype.updateMouseMoveTargets=function(){var t="";for(var e=0,r=this.mouseMoveTargets.length;e<r;e++){var n=this.mouseMoveTargets[e];var a=this.children.get(n.id);a.LAND.color=n.color||this.selectColor}};l.prototype.onKeyDown=function(t,e,r){if(e==70){this.uIsFlat=this.uIsFlat?0:1}};l.prototype.processObject=function(t){var e=t.LAND;e.color=t.landColor;return e};l.prototype.processVertex=function(t,e,r){if(this.uIsFlat==1){return[t*2,e,r]}else if(this.uIsFlat==0){var n=(t+1)*Math.PI;var a=(e+1)/2*Math.PI;var o=Math.cos(n)*Math.sin(a)*-1;var i=Math.cos(a)*-1;var s=Math.sin(n)*Math.sin(a);return[o,i,s]}}},function(t,e,r){"use strict";var n=r(4);t.exports=a;function a(t){n.call(this);Object.assign(this,t);this.init()}a.prototype=Object.create(n.prototype);a.prototype.constructor=a;a.prototype.init=function(){this.LAND=new n({color:this.landColor,mesh:{aPosition:3,aColor:0,aUV:0,vertices:this.landVertices,indices:this.landIndices},programName:"sphere_plane"});this.addChild(this.LAND)};a.prototype.update=function(){}},function(t,e,r){"use strict";var n=r(22);var a={getFeature:function t(e){try{var r=[];for(var n=0,a=geojson.features.length;n<a;n++){var o=geojson.features[n];if(o.properties.name.indexOf(e)>-1||o.properties.name_long.indexOf(e)>-1||o.properties.admin.indexOf(e)>-1||o.properties.abbrev.indexOf(e)>-1){r.push(o)}}if(r.length===1){return r[0]}return r}catch(t){console.log(t)}},getPointsArrayMultiPoligon:function t(e){var r=this.getFeature(e);if(Array.isArray(r)){console.log("Getfeature return array: ");console.log(r);return}return this.getCoordinates(r)},getCoordinates:function t(e){var r=[];if(e.geometry.type==="MultiPolygon"){var n=e.geometry.coordinates;for(var a=0,o=n.length;a<o;a++){var i=n[a];for(var s=0,u=i.length;s<u;s++){var l=i[s];for(var c=0,h=d.length;c<h;c++){var f=d[c][0]/180;var M=d[c][1]/90;var v=0;r.push(f,M,v)}}}return r}else if(e.geometry.type==="Polygon"){var n=e.geometry.coordinates;for(var s=0,u=n.length;s<u;s++){var d=n[s];for(var c=0,h=d.length;c<h;c++){var f=d[c][0]/180;var M=d[c][1]/90;var v=0;r.push(f,M,v)}}return r}},getCoordinatesWithOffsets:function t(e){var r=[];var n=[];var a=-3;if(e.geometry.type==="MultiPolygon"){var o=e.geometry.coordinates;for(var i=0,s=o.length;i<s;i++){var u=o[i];for(var l=0,c=u.length;l<c;l++){var h=u[l];n.push({offset:a+3,length:h.length-1});for(var f=0,M=h.length-1;f<M;f++){var v=h[f][0]/180;var d=h[f][1]/90;var m=0;r.push(v,d,m);a+=3}}}}else if(e.geometry.type==="Polygon"){var o=e.geometry.coordinates;var n=[];var a=-3;for(var l=0,c=o.length;l<c;l++){var h=o[l];n.push({offset:a+3,length:h.length-1});for(var f=0,M=h.length-1;f<M;f++){var v=h[f][0]/180;var d=h[f][1]/90;var m=0;r.push(v,d,m);a+=3}}}return{vertices:r,offsetMap:n}},getTriangulatedPolygon:function t(e){if(e.geometry.type==="MultiPolygon"){return this.flattenMultiPolygonUsingPoligon(e.geometry.coordinates)}else if(e.geometry.type==="Polygon"){return this.flattenPolygon(e.geometry.coordinates)}},flattenPolygon:function t(e){var r=[];var a=[];var o=null;var i=0;for(var s=0,u=e.length;s<u;s++){var l=e[s];for(var c=0,h=e[s].length;c<h;c++){var f=l[c][0]/180;var M=l[c][1]/90;var v=0;a.push(f,M,v)}if(s>0){i+=e[s-1].length;r.push(i)}}o=n(a,r,3);return{vertices:a,indices:o}},flattenMultiPolygon:function t(e){var r=[];var a=[];var o=null;var i=0;for(var s=0,u=e.length;s<u;s++){var l=e[s];for(var c=0,h=l.length;c<h;c++){var f=l[c];for(var M=0,v=l[c].length;M<v;M++){var d=f[M][0]/180;var m=f[M][1]/90;var p=0;a.push(d,m,p)}if(c>0){i+=l[c-1].length;r.push(i)}}}o=n(a,r,3);return{vertices:a,indices:o}},flattenMultiPolygonUsingPoligon:function t(e){var r=[];var n=[];for(var a=0,o=e.length;a<o;a++){var i=e[a];var s=this.flattenPolygon(i);var u=s.vertices;for(var l=0,c=u.length;l<c;l++){r.push(u[l])}var h=s.indices;var f=n.length/3+a*3;for(var M=0,c=h.length;M<c;M++){n.push(h[M]+f)}}return{vertices:r,indices:n}}};t.exports=a},function(t,e){"use strict";t.exports=r;function r(t,e,r){r=r||2;var a=e&&e.length,i=a?e[0]*r:t.length,s=n(t,0,i,r,true),u=[];if(!s)return u;var l,h,f,M,v,d,m;if(a)s=c(t,e,s,r);if(t.length>80*r){l=f=t[0];h=M=t[1];for(var p=r;p<i;p+=r){v=t[p];d=t[p+1];if(v<l)l=v;if(d<h)h=d;if(v>f)f=v;if(d>M)M=d}m=Math.max(f-l,M-h)}o(s,u,r,l,h,m);return u}function n(t,e,r,n,a){var o=0,i,s,u;for(i=e,s=r-n;i<r;i+=n){o+=(t[s]-t[i])*(t[i+1]+t[s+1]);s=i}if(a===o>0){for(i=e;i<r;i+=n){u=E(i,t[i],t[i+1],u)}}else{for(i=r-n;i>=e;i-=n){u=E(i,t[i],t[i+1],u)}}return u}function a(t,e){if(!t)return t;if(!e)e=t;var r=t,n;do{n=false;if(!r.steiner&&(I(r,r.next)||g(r.prev,r,r.next)===0)){P(r);r=e=r.prev;if(r===r.next)return null;n=true}else{r=r.next}}while(n||r!==e);return e}function o(t,e,r,n,c,h,f){if(!t)return;if(!f&&h)v(t,n,c,h);var M=t,d,m;while(t.prev!==t.next){d=t.prev;m=t.next;if(h?s(t,n,c,h):i(t)){e.push(d.i/r);e.push(t.i/r);e.push(m.i/r);P(t);t=m.next;M=m.next;continue}t=m;if(t===M){if(!f){o(a(t),e,r,n,c,h,1)}else if(f===1){t=u(t,e,r);o(t,e,r,n,c,h,2)}else if(f===2){l(t,e,r,n,c,h)}break}}}function i(t){var e=t.prev,r=t,n=t.next;if(g(e,r,n)>=0)return false;var a=t.next.next;while(a!==t.prev){if(x(e.x,e.y,r.x,r.y,n.x,n.y,a.x,a.y)&&g(a.prev,a,a.next)>=0)return false;a=a.next}return true}function s(t,e,r,n){var a=t.prev,o=t,i=t.next;if(g(a,o,i)>=0)return false;var s=a.x<o.x?a.x<i.x?a.x:i.x:o.x<i.x?o.x:i.x,u=a.y<o.y?a.y<i.y?a.y:i.y:o.y<i.y?o.y:i.y,l=a.x>o.x?a.x>i.x?a.x:i.x:o.x>i.x?o.x:i.x,c=a.y>o.y?a.y>i.y?a.y:i.y:o.y>i.y?o.y:i.y;var h=m(s,u,e,r,n),f=m(l,c,e,r,n);var M=t.nextZ;while(M&&M.z<=f){if(M!==t.prev&&M!==t.next&&x(a.x,a.y,o.x,o.y,i.x,i.y,M.x,M.y)&&g(M.prev,M,M.next)>=0)return false;M=M.nextZ}M=t.prevZ;while(M&&M.z>=h){if(M!==t.prev&&M!==t.next&&x(a.x,a.y,o.x,o.y,i.x,i.y,M.x,M.y)&&g(M.prev,M,M.next)>=0)return false;M=M.prevZ}return true}function u(t,e,r){var n=t;do{var a=n.prev,o=n.next.next;if(y(a,n,n.next,o)&&b(a,o)&&b(o,a)){e.push(a.i/r);e.push(n.i/r);e.push(o.i/r);P(n);P(n.next);n=t=o}n=n.next}while(n!==t);return n}function l(t,e,r,n,i,s){var u=t;do{var l=u.next.next;while(l!==u.prev){if(u.i!==l.i&&S(u,l)){var c=w(u,l);u=a(u,u.next);c=a(c,c.next);o(u,e,r,n,i,s);o(c,e,r,n,i,s);return}l=l.next}u=u.next}while(u!==t)}function c(t,e,r,o){var i=[],s,u,l,c,M;for(s=0,u=e.length;s<u;s++){l=e[s]*o;c=s<u-1?e[s+1]*o:t.length;M=n(t,l,c,o,false);if(M===M.next)M.steiner=true;i.push(p(M))}i.sort(h);for(s=0;s<i.length;s++){f(i[s],r);r=a(r,r.next)}return r}function h(t,e){return t.x-e.x}function f(t,e){e=M(t,e);if(e){var r=w(e,t);a(r,r.next)}}function M(t,e){var r=e,n=t.x,a=t.y,o=-Infinity,i;do{if(a<=r.y&&a>=r.next.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&s>o){o=s;i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!i)return null;if(t.x===i.x)return i.prev;var u=i,l=Infinity,c;r=i.next;while(r!==u){if(n>=r.x&&r.x>=i.x&&x(a<i.y?n:o,a,i.x,i.y,a<i.y?o:n,a,r.x,r.y)){c=Math.abs(a-r.y)/(n-r.x);if((c<l||c===l&&r.x>i.x)&&b(r,t)){i=r;l=c}}r=r.next}return i}function v(t,e,r,n){var a=t;do{if(a.z===null)a.z=m(a.x,a.y,e,r,n);a.prevZ=a.prev;a.nextZ=a.next;a=a.next}while(a!==t);a.prevZ.nextZ=null;a.prevZ=null;d(a)}function d(t){var e,r,n,a,o,i,s,u,l=1;do{r=t;t=null;o=null;i=0;while(r){i++;n=r;s=0;for(e=0;e<l;e++){s++;n=n.nextZ;if(!n)break}u=l;while(s>0||u>0&&n){if(s===0){a=n;n=n.nextZ;u--}else if(u===0||!n){a=r;r=r.nextZ;s--}else if(r.z<=n.z){a=r;r=r.nextZ;s--}else{a=n;n=n.nextZ;u--}if(o)o.nextZ=a;else t=a;a.prevZ=o;o=a}r=n}o.nextZ=null;l*=2}while(i>1);return t}function m(t,e,r,n,a){t=32767*(t-r)/a;e=32767*(e-n)/a;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;t=(t|t<<1)&1431655765;e=(e|e<<8)&16711935;e=(e|e<<4)&252645135;e=(e|e<<2)&858993459;e=(e|e<<1)&1431655765;return t|e<<1}function p(t){var e=t,r=t;do{if(e.x<r.x)r=e;e=e.next}while(e!==t);return r}function x(t,e,r,n,a,o,i,s){return(a-i)*(e-s)-(t-i)*(o-s)>=0&&(t-i)*(n-s)-(r-i)*(e-s)>=0&&(r-i)*(o-s)-(a-i)*(n-s)>=0}function S(t,e){return I(t,e)||t.next.i!==e.i&&t.prev.i!==e.i&&!D(t,e)&&b(t,e)&&b(e,t)&&F(t,e)}function g(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function I(t,e){return t.x===e.x&&t.y===e.y}function y(t,e,r,n){return g(t,e,r)>0!==g(t,e,n)>0&&g(r,n,t)>0!==g(r,n,e)>0}function D(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&y(r,r.next,t,e))return true;r=r.next}while(r!==t);return false}function b(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function F(t,e){var r=t,n=false,a=(t.x+e.x)/2,o=(t.y+e.y)/2;do{if(r.y>o!==r.next.y>o&&a<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x)n=!n;r=r.next}while(r!==t);return n}function w(t,e){var r=new A(t.i,t.x,t.y),n=new A(e.i,e.x,e.y),a=t.next,o=e.prev;t.next=e;e.prev=t;r.next=a;a.prev=r;n.next=r;r.prev=n;o.next=n;n.prev=o;return n}function E(t,e,r,n){var a=new A(t,e,r);if(!n){a.prev=a;a.next=a}else{a.next=n.next;a.prev=n;n.next.prev=a;n.next=a}return a}function P(t){t.next.prev=t.prev;t.prev.next=t.next;if(t.prevZ)t.prevZ.nextZ=t.nextZ;if(t.nextZ)t.nextZ.prevZ=t.prevZ}function A(t,e,r){this.i=t;this.x=e;this.y=r;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false}},function(t,e,r){"use strict";t.exports={getPage:r(24),fetchPage:r(25),parsePage:r(27)}},function(t,e,r){"use strict";var n=r(25);var a=r(27);var o=r(28);var i=r(29);t.exports=s;function s(t,e,r){n(t,function(t){var n=a(t);var s=o(n.sectionsArr);var u=i(s,r||10);e({firstPassage:n.firstPassage,sentences:u})}.bind(this))}},function(t,e,r){"use strict";var n=r(26);t.exports=a;function a(t,e){var r="https://en.wikipedia.org/w/api.php?format=json"+"&action=query"+"&prop=images|extracts"+"&redirects&explaintext&titles="+encodeURIComponent(t);n(r,function(t){var r="";var n=t.query.pages;for(var a in n){r=n[a].extract}e(r)})}},function(t,e){"use strict";t.exports=r;function r(t,e){var r=document.body;var a=document.createElement("script");var o=n();a.id=o;window[o]=function(t){e(t);delete window[o];var r=document.getElementById(o);r.parentNode.removeChild(r)};t=t.concat("&callback=").concat(o);r.appendChild(a);a.src=t}function n(){return"callback_"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}},function(t,e){"use strict";t.exports=r;function r(t){var e=t.indexOf("\n");var r=[t.slice(0,e),t.slice(e+1)];var a=r[0];var o=r[1];o=o.replace(/(?:\r\n|\r|\n)/g,"");var i=/(\={2}\s.+?\s\={2})(.+?(?=[^=]\=\=\s))/gi;var s=/(\={3}\s.+?\s\={3})(.+?(?=[^=]\=\=\=\s))/gi;var u=[];var l=[];var c=n(o,i);var h=["see also","further reading","references"];var f=["religion"];for(var M=0;M<c.length;M++){var v=c[M];var d=v[1];if(h.indexOf(d.replace(/(?:\s?\=\=\s?)/g,"").toLowerCase())!==-1){continue}var m=v[2];var p=n(m,s);u.push({title:d,content:m.replace(/(?:\={1,5}.+?\={1,5})/gi,""),subsections:p.filter(function(t){if(f.indexOf(t[1].replace(/(?:\s?\=\=\=\s?)/g,"").toLowerCase())!==-1){return false}return true}).map(function(t,e,r){return{title:t[1],content:t[2]}})})}return{firstPassage:a,sectionsArr:u}}function n(t,e){var r=[];var n;while(n=e.exec(t)){r.push(n)}return r}},function(t,e){"use strict";t.exports=r;function r(t){var e=[];var r=/.*?((?:[!?]+|\.+(?!([0-9]|\.+))))|[\w\s\d\.\-\[\]\(\)\:\;\,]+$/gi;for(var n=0;n<t.length;n++){var a=t[n];var o=a.subsections;var i=o.length===0?a.content:"";for(var s=0;s<o.length;s++){i+=o[s].content}var u=i.match(r);u=u.filter(function(t,e,r){var n=t.match(/\d+/);return n?true:false});e=e.concat(u)}return e}},function(t,e){"use strict";t.exports=r;function r(t,e){n(t);var r=[];for(var a=0;a<Math.min(t.length,e);a++){var o=t[a].replace(/\d+/,"__________");var i=t[a].match(/\d+/);r.push({data:[o,t[a]],answer:parseFloat(i)})}return r}function n(t){var e=t.length,r,n;while(0!==e){n=Math.floor(Math.random()*e);e-=1;r=t[e];t[e]=t[n];t[n]=r}return t}},function(t,e,r){"use strict";var n=r(8);var a=r(7);var o=r(2);var i=r(3);var s=r(4);var u=r(6);var l=r(31);var c=r(18);var h=r(32);t.exports=f;function f(t){i.call(this);this.hotkeys={move_left:[{code:"ArrowLeft",keyCode:37},{code:"KeyA",keyCode:65}],move_right:[{code:"ArrowRight",keyCode:39},{code:"KeyA",keyCode:68}],move_up:[{code:"PageDown",keyCode:34},{code:"KeyQ",keyCode:81}],move_down:[{code:"PageUp",keyCode:33},{code:"KeyE",keyCode:69}],move_forward:[{code:"ArrowUp",keyCode:38},{code:"KeyA",keyCode:87}],move_backward:[{code:"ArrowDown",keyCode:40},{code:"KeyS",keyCode:83}]};Object.assign(this,t);return this}f.prototype=Object.create(i.prototype);f.prototype.constructor=f;f.prototype.processInput=function(){var t=this.camera.vMatrix,e=this.inputManager;if(e.checkIsKeyDown(this.hotkeys["move_forward"])){n.mat4.translate(t,t,[0,0,+.02])}else if(e.checkIsKeyDown(this.hotkeys["move_backward"])){n.mat4.translate(t,t,[0,0,-.02])}if(e.checkIsKeyDown(this.hotkeys["move_left"])){n.mat4.translate(t,t,[.02,0,0])}else if(e.checkIsKeyDown(this.hotkeys["move_right"])){n.mat4.translate(t,t,[-.02,0,0])}if(e.checkIsKeyDown(this.hotkeys["move_up"])){n.mat4.translate(t,t,[0,-.02,0])}else if(e.checkIsKeyDown(this.hotkeys["move_down"])){n.mat4.translate(t,t,[0,.02,0])}if(e.wheelDeltaY){a.mat4TranslateZ(t,e.wheelDeltaY/240);e.wheelDeltaY=0}if(e.checkIsKeyDown(17)){if(e.isMouseDownLeft){n.mat4.rotate(this.matrix,this.matrix,this.inputManager.getTheta(),[0,1,0]);this.inputManager.getPhi()}else if(e.isMouseDownRight){a.mat4RotateX(t,this.inputManager.getPhi());this.inputManager.getTheta()}}else{this.inputManager.getTheta();this.inputManager.getPhi()}};f.prototype.update=function(){var t=this.entities;for(var e=0,r=t.length;e<r;e++){t[e].update()}};f.prototype.draw=function(t,e){var r=t.gl;r.clearColor(.3,.3,.3,1);r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT);this.render(t,e)};f.prototype.init=function(t,e){this.camera=new u;this.camera.init(e.width,e.height);this.inputManager=new o;this.inputManager.init(e,this.camera);this.selectedEntities=[];this.entities=[];this.rows=25;this.columns=25;this.localPlayer=new s({query:"localPlayer"});this.addChild(this.localPlayer);for(var r=0;r<=this.rows*this.columns;r++){var i=1-2*(r%this.rows)/this.rows;var f=1-2*Math.floor(r/this.rows)/this.columns;if(f==1||i==1){continue}var M=new h;a.mat4Scale(M.matrix,[.01,.01,.01]);a.mat4TranslateX(M.matrix,i);a.mat4TranslateZ(M.matrix,f);this.entities.push(M);M.uoa+=this.localPlayer.children.size;this.localPlayer.addChild(M)}console.info("Number of entities: "+this.entities.length);this.lattice=new s({mesh:l(25,25),mode:"LINES",color:[1,.5,.2,1],programName:"position"});this.addChild(this.lattice);this.line001=new s({mesh:{aPosition:3,aColor:0,aUV:0,vertices:[0,0,0,-1,1,-1],indices:[0,1]},mode:"LINES",color:[1,0,0,1],programName:"position"});this.addChild(this.line001);n.mat4.rotate(this.camera.vMatrix,this.camera.vMatrix,35/180*Math.PI,[1,0,0]);this.onMouseMove=function(t,e,r){if(r.isMouseDownRight||r.isMouseDownLeft){return}var n=c.getObjectsUnderMouse(this.entities,e.x,e.y,r.domElement.width,r.domElement.height,r.camera.pMatrix,r.camera.vMatrix,5,function(t){if(!t.isSelected){t.setColor(1,1,1,1)}return t.BODY});var a="";for(var o=0,i=n.length;o<i;o++){var s=n[o];if(!s.isSelected){s.setColor(0,1,0,1)}}};this.onMouseUpLeft=function(t,e,r){if(r.isMouseDownRight){return}var n=c.getObjectsUnderMouse(this.entities,e.x,e.y,r.domElement.width,r.domElement.height,r.camera.pMatrix,r.camera.vMatrix,5,function(t){return t.BODY});var a="";if(n.length>0){for(var o=0,i=this.selectedEntities.length;o<i;o++){
this.selectedEntities[o].isSelected=false}this.selectedEntities.splice(0)}for(var o=0,i=n.length;o<i;o++){var s=n[o];s.isSelected=true;s.setColor(.1,.3,1,1);this.selectedEntities.push(s);console.log(s.uoa);var u=s.BODY.getConcatenatedMatrix();a+=[u[12].toFixed(2),u[13].toFixed(2),u[14].toFixed(2)].join(",");s.setState({position:a})}};this.onMouseUpRight=function(t,e,r){var n=c.ray_plane(e.x,e.y,r.domElement.width,r.domElement.height,r.camera.pMatrix,r.camera.vMatrix,this.lattice.getConcatenatedMatrix(),[-1,0,1],[-1,0,-1],[1,0,-1],[1,0,1]);console.log(n);for(var a=0,o=this.selectedEntities.length;a<o;a++){var i=this.selectedEntities[a];if(n){i.path.push(n.slice(0))}}};this.inputManager.on("mouseup0",this.onMouseUpLeft.bind(this));this.inputManager.on("mouseup2",this.onMouseUpRight.bind(this));this.inputManager.on("mousemove",this.onMouseMove.bind(this));return this}},function(t,e){"use strict";t.exports=function(t,e){var r=[];var n=[];var a,o,i,s;o=0;for(var s=0;s<=e;s++){a=2/e*s-1;r.push(a,o,-1);r.push(a,o,1)}for(var s=0;s<=t;s++){i=2/t*s-1;r.push(-1,o,i);r.push(1,o,i)}for(var s=0,u=r.length/3;s<u;s++){n.push(s)}return{rows:t||8,columns:e||8,aPosition:3,aColor:0,aUV:0,vertices:new Float32Array(r),indices:new Uint16Array(n)}}},function(t,e,r){"use strict";var n=r(7);var a=r(8);var o=r(33);var i=r(35);t.exports=s;function s(t){o.call(this);this.query="entity&target";this.rotation=Math.random()*.01-.01;this.speed=.01;this.movable_=new i;this.setColor(1,1,0,.2);Object.assign(this,t)}s.prototype=Object.create(o.prototype);s.prototype.constructor=s;s.prototype.update=function(){this.movable_.move(this);n.mat4RotateY(this.matrix,this.rotation);n.mat4RotateX(this.matrix,this.rotation)};s.prototype.setColor=function(t,e,r,n){var a=this.state.color;if(a){a[0]=t;a[1]=e;a[2]=r;a[3]=n}else{a=[t,e,r,n]}}},function(t,e,r){"use strict";var n=r(4);var a=r(34);t.exports=o;function o(t){n.call(this);this.isSelected=false;this.health_=100;this.speed_=1;this.determination_=100;this.strike_=10;this.direction=[1,0,0,0];this.position=[1,0,0,0];this.path=[];this.state={color:[1,1,1,1]};Object.assign(this,t);this.BODY=new n({mesh:a,textureUrl:"./resources/wood.png",programName:"position_uv",mode:"TRIANGLES"});this.addChild(this.BODY)}o.prototype=Object.create(n.prototype);o.prototype.constructor=o},function(t,e){"use strict";t.exports={aPosition:3,aColor:0,aUV:2,vertices:[-1,-1,1,0,0,1,-1,1,1,0,1,1,1,1,1,-1,1,1,0,1,-1,-1,-1,1,0,-1,1,-1,1,1,1,1,-1,0,1,1,-1,-1,0,0,-1,1,-1,0,1,-1,1,1,0,0,1,1,1,1,0,1,1,-1,1,1,-1,-1,-1,1,1,1,-1,-1,0,1,1,-1,1,0,0,-1,-1,1,1,0,1,-1,-1,1,0,1,1,-1,1,1,1,1,1,0,1,1,-1,1,0,0,-1,-1,-1,0,0,-1,-1,1,1,0,-1,1,1,1,1,-1,1,-1,0,1],indices:[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]}},function(t,e,r){"use strict";var n=r(7);var a=r(8);a.vec4.setLength=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3];var s=n*n+a*a+o*o+i*i;if(s>0){s=r/Math.sqrt(s);t[0]=n*s;t[1]=a*s;t[2]=o*s;t[3]=i*s}return t};t.exports=o;function o(){}o.prototype.move=function(t){var e=t.path,r=t.direction,o=t.position,i,s;if(e.length>0){i=e[0];n.mat4GetVec4(o,t.matrix);a.vec4.subtract(r,i,o);s=a.vec4.length(r);a.vec4.setLength(r,r,t.speed);if(s>=t.speed){n.mat4TranslateRaw(t.matrix,r)}else{a.vec4.setLength(r,r,s);n.mat4TranslateRaw(t.matrix,r);e.splice(0,1);this.move(t)}}}},function(t,e,r){"use strict";var n=r(37);var a=r(38);var o=r(39);t.exports=i;function i(t){this.canvas=null;this.context=null;this.animationID=-1;this.textureManager=null;this.resourceManager=null;this.scenes={};this.scene=null;this.socket=null;this.players=[];this.echos=[];this.commands=new Map;this.programs={};Object.assign(this,t)}i.prototype={constructor:i,load:function t(){this.resourceManager=new a;return this.resourceManager.load(this.resources)},init:function t(){this.context=new n(this.canvas);this.context.programs=Object.keys(this.programs).reduce(function(t,e,r,n){t[e]=this.programs[e](this.context.gl);return t}.bind(this),{});this.textureManager=new o({gl:this.context.gl,ioManager:this.resourceManager});this.initWorld();this.initDOMListeners();return Promise.resolve(true)},releaseResources:function t(){var e=this.context.gl;this.context.meshes.forEach(function(t,e,r){delete t[this.context.id]}.bind(this));this.context.buffers.forEach(function(t,r,n){e.deleteBuffer(t.ibo);e.deleteBuffer(t.vbo)});Object.keys(this.textureManager.store).forEach(function(t,r){e.deleteTexture(this.textureManager.store[t].texture)}.bind(this));e.getExtension("WEBGL_lose_context").loseContext()},startRunnerLoop:function t(e){this.runnerLoop()},stopRunnerLoop:function t(){cancelAnimationFrame(this.animationID);this.animationID=-1;console.log("runner loop stopped")},runnerLoop:function t(){if(this.scene){var e=true;var r=false;var n=undefined;try{for(var a=this.commands[Symbol.iterator](),o;!(e=(o=a.next()).done);e=true){var i=o.value;var s=this.scene[i[0]];if(i[1].length){console.log(i)}if(s){s.commandManager.notify(i[1])}this.commands.delete(i[0])}}catch(t){r=true;n=t}finally{try{if(!e&&a.return){a.return()}}finally{if(r){throw n}}}this.scene.processInput();this.scene.update();this.scene.draw(this.context,this.textureManager);this.context.gl.flush();this.animationID=window.requestAnimationFrame(this.runnerLoop.bind(this))}},initSocket:function t(){var e=this.socket;this.commandID=0;e.on("player",function(t){this.commands.set(t.id,t.commands);this.commandID++;if(this.commandID%100===0){console.log("commands %d",this.commandID)}}.bind(this))},initDOMListeners:function t(){var e=this.context.canvas;e.addEventListener("dblclick",this.doubleClick.bind(this));document.onkeyup=this.releaseKey.bind(this);document.onkeydown=this.pressKey.bind(this);e.addEventListener("mousedown",this.mouseDown.bind(this));e.addEventListener("mouseup",this.mouseUp.bind(this));e.addEventListener("mousemove",this.mouseMove.bind(this));e.addEventListener("touchstart",this.mouseDown.bind(this));e.addEventListener("touchend",this.mouseUp.bind(this));e.addEventListener("touchmove",this.mouseMove.bind(this));e.onwheel=this.wheel.bind(this);e.oncontextmenu=this.contextMenu.bind(this);window.addEventListener("resize",this.onResize.bind(this))},pressKey:function t(e){if(this.scene){this.scene.inputManager.keydown(e)}},releaseKey:function t(e){if(this.scene){this.scene.inputManager.keyup(e)}},mouseDown:function t(e){if(this.scene){this.scene.inputManager.mouseDown(e)}},mouseUp:function t(e){if(this.scene){this.scene.inputManager.mouseUp(e)}},mouseMove:function t(e){if(this.scene){var r=this.scene.inputManager.mouseMove(e)}},wheel:function t(e){if(this.scene){this.scene.inputManager.onWheel(e)}},contextMenu:function t(e){if(this.scene){this.scene.inputManager.onContextMenu(e)}return false},doubleClick:function t(e){if(this.animationID===-1){this.startRunnerLoop()}else{this.stopRunnerLoop()}},onResize:function t(e){}}},function(t,e){"use strict";t.exports=r;function r(t){this.canvas=t;this.id=(Math.random()*Math.pow(32,6)).toString(36).slice(0,4);this.programs={};this.buffers=new Map;this.meshes=new Map;this.activeProgram=null;if(!this.canvas){console.error("Couldn't find DOM element "+t);return null}this.canvas.width=this.canvas.clientWidth;this.canvas.height=this.canvas.clientHeight;try{this.gl=this.canvas.getContext("webgl",{antialias:true})||this.canvas.getContext("experimental-webgl",{antialias:true})}catch(t){alert("You are not webgl compatible :(");console.error("Couldn't inititalize webgl context...")}this.initGL()}r.prototype.initGL=function(){var t=this.gl,e=this.canvas;t.getExtension("OES_element_index_uint")||t.getExtension("MOZ_OES_element_index_uint")||t.getExtension("WEBKIT_OES_element_index_uint");t.viewport(0,0,e.width,e.height);t.clearColor(0,0,0,1);t.enable(t.DEPTH_TEST);t.depthFunc(t.LEQUAL);t.clearDepth(1);t.enable(t.BLEND);t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)};r.prototype.getProgram=function(t){return this.programs[t]};r.prototype.allocateBuffers=function(t){var e=this.gl,r={vbo:e.createBuffer(),ibo:e.createBuffer()};e.bindBuffer(e.ARRAY_BUFFER,r.vbo);e.bufferData(e.ARRAY_BUFFER,new Float32Array(t.vertices),e.STATIC_DRAW);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.ibo);e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(t.indices),e.STATIC_DRAW);this.buffers.set(t[this.id],r);return r};r.prototype.getBuffersById=function(t){return this.buffers.get(t)};r.prototype.getBuffersByIndex=function(t){return this.buffers[t]};r.prototype.addMesh=function(t){t.index=this.meshes.length;this.meshes.push(t)}},function(t,e,r){"use strict";function n(t){this.store={};Object.assign(this,t)}n.prototype={constructor:n,load:function t(e){return Promise.all(e.map(function(t,e,r){return fetch(t).then(function(e){return new Promise(function(r,n){if(/\.(eot|ttf|wav|mp3|ogv)$/.test(t)){e.blob().then(function(e){var a=new Audio;a.src=URL.createObjectURL(e);a.onload=function(e){this.store[t]=a;r(a)}.bind(this);a.onerror=function(t){n(t)}}.bind(this),function(t){n(t)})}else if(/\.ogv$/.test(t)){e.blob().then(function(e){var a=document.createElement("video");a.src=URL.createObjectURL(e);a.onload=function(e){this.store[t]=a;r(a)}.bind(this);a.onerror=function(t){n(t)}}.bind(this),function(t){n(t)})}else if(/\.(png|jpg|jpeg|gif)$/.test(t)){e.blob().then(function(e){var a=new Image;a.src=URL.createObjectURL(e);a.onload=function(e){this.store[t]=a;r(a)}.bind(this);a.onerror=function(t){n(t)}}.bind(this),function(t){n(t)})}else if(/\.json$/){e.json().then(function(e){this.store[t]=e;r(e)}.bind(this),function(t){n(t)})}else{e.text().then(function(e){this.store[t]=e;r(e)}.bind(this),function(t){n(t)})}}.bind(this))}.bind(this),function(t){console.log(t)})}.bind(this)))}};n.prototype.getResource=function(t){if(!this.store[t]){console.log(" ResourceManager.prototype.getResource : no such resource "+t);return}return this.store[t]};if(true){t.exports=n}},function(t,e){"use strict";t.exports=r;function r(t){this.ioManager=null;this.store={};this.idCounter=0;if(t){for(var e in t){if(t.hasOwnProperty(e)){this[e]=t[e]}}}if(!this.ioManager){console.error("TextureManger was contructed without IOManager...")}}r.prototype.getTexture=function(t){var e=this.gl;var r=this.store[t];if(!r){var n=this.ioManager.getResource(t);if(!n){console.log("getTexture() : image "+t+" has not been loaded");return}var a=this.createStandardTexture(n);this.store[t]={texture:a,id:this.idCounter++};r=this.store[t]}return r};r.prototype.createStandardTexture=function(t){var e=this.gl;var r=e.createTexture();e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,true);e.activeTexture(e["TEXTURE"+this.idCounter]);e.bindTexture(e.TEXTURE_2D,r);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_LINEAR);e.generateMipmap(e.TEXTURE_2D);return r}},function(t,e,r){"use strict";var n=r(41);var a=o(n);function o(t){return t&&t.__esModule?t:{default:t}}t.exports=function(t){return new a.default({name:"sphere_plane",attributeNames:["aPosition"],uniformNames:["uPMatrix","uMMatrix","uColor","uVMatrix","uIsFlat","uCoeff"],vsCode:r(42),fsCode:r(43),prepareBuffers:function t(e,r){var n=this.gl,a=e.aPosition+e.aColor+e.aUV;n.bindBuffer(n.ARRAY_BUFFER,r.vbo);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r.ibo);n.vertexAttribPointer(0,e.aPosition,n.FLOAT,false,a*4,0*4)},loadUniforms:function t(e){var r=this.gl;r.uniform4fv(this.UNIFORMS.uColor,e.searchTreeUp("color"));r.uniform1i(this.UNIFORMS.uIsFlat,e.searchTreeUp("uIsFlat"));r.uniform1f(this.UNIFORMS.uCoeff,e.searchTreeUp("uCoeff"))}}).init(t)}},function(t,e){"use strict";t.exports=r;function r(t){this.name=t.name;this.gl=t.gl;this.attributeNames=t.attributeNames||[];this.uniformNames=t.uniformNames||[];this.UNIFORMS={};this.ATTRIBUTES={};this.vsCode=t.vsCode||"no vs code";this.fsCode=t.fsCode||"no fs code";this.vertexShader=null;this.fragmentShader=null;this.program=null;this.prepareBuffers=t.prepareBuffers;this.loadUniforms=t.loadUniforms;return this}r.prototype.init=function(t){this.gl=t;this.compileShaders();this.linkShaders();this.bindAttributes();this.getUniformLocations();console.info("GLSL program '"+this.name+"' created");return this};r.prototype.use=function(){this.gl.useProgram(this.program);for(var t=0,e=this.attributeNames.length;t<e;t++){this.gl.enableVertexAttribArray(t)}};r.prototype.unuse=function(){this.gl.useProgram(null);for(var t=0,e=this.attributeNames.length;t<e;t++){this.gl.disableVertexAttribArray(t)}};r.prototype.compileShaders=function(){var t=this.gl;this.program=t.createProgram();this.vertexShader=this.compileShader(t.VERTEX_SHADER,this.vsCode);this.fragmentShader=this.compileShader(t.FRAGMENT_SHADER,this.fsCode)};r.prototype.bindAttributes=function(){for(var t=0,e=this.attributeNames.length;t<e;t++){var r=this.attributeNames[t];this.gl.bindAttribLocation(this.program,t,this.attributeNames[t]);this.ATTRIBUTES[r]=this.gl.getAttribLocation(this.program,r)}};r.prototype.getUniformLocations=function(){for(var t=0,e=this.uniformNames.length;t<e;t++){var r=this.uniformNames[t];this.UNIFORMS[r]=this.gl.getUniformLocation(this.program,r)}};r.prototype.linkShaders=function(){var t=this.gl;t.attachShader(this.program,this.vertexShader);t.attachShader(this.program,this.fragmentShader);t.linkProgram(this.program);if(!t.getProgramParameter(this.program,t.LINK_STATUS)){console.log("couldn't initialize shaders")}};r.prototype.compileShader=function(t,e){var r=this.gl,n=r.createShader(t);r.shaderSource(n,e);r.compileShader(n);if(!r.getShaderParameter(n,r.COMPILE_STATUS)){throw r.getShaderInfoLog(n)}return n}},function(t,e){t.exports="\nprecision mediump float;\n\nattribute vec3 aPosition;\n\nuniform mat4 uPMatrix;\nuniform mat4 uMMatrix;\nuniform mat4 uVMatrix;\nuniform int uIsFlat; \nuniform float uCoeff;\n//uniform mat4 uVMatrix;\nvarying vec4 vColor;\nfloat PI = 3.1415926;\n\nvoid main(void){\n\n    gl_PointSize = 1.0; // default point size is 0 so pint are not visible\n    vec3 pos = aPosition;\n    \n// at this point world map is just a squre x(-1.0,1.0), y(-1.0,1.0)\n  \n// option A: make world map a 2/1 rect\n      pos.x *= 2.0;\n       \n    //   pos.x /= 2.0;\n    //   pos.y /= 2.0;\n    //   pos.z /= 2.0;\n\n//option B: make world map a sphere\n    if(uIsFlat == 0){\n     pos.x /= 2.0; \n     float lon = (pos.x  + 1.0)* (1.0 - uCoeff + PI*uCoeff);\n     float lat = (pos.y + 1.0) / 2.0* (1.0 - uCoeff + PI*uCoeff);\n     \n     //spere equation : F(u, v) = [ cos(u)*sin(v)*r, cos(v)*r, sin(u)*sin(v)*r ]\n     pos.x = cos(lon)*sin(lat)*(-1.0); // multiply by -1 one to get rid of mirror effect \n     pos.y = cos(lat)*(-1.0); // multiply by -1 one to make north north\n     pos.z = sin(lon)*sin(lat);\n\n     // pos.y /= 2.0;\n    //  pos.z /= 2.0;\n    }\n// new position vector  \n  gl_Position =  uPMatrix*uVMatrix* uMMatrix*vec4(pos,1.0); \n}"},function(t,e){t.exports="precision mediump float;\n\n\nuniform vec4 uColor;\nvarying vec4 vColor;\n\nvoid main(void){\n    \n    gl_FragColor = uColor;//vColor;//uColor;//vec4(0.3,0.5,0.4,0.5);\n}"},function(t,e,r){"use strict";var n=r(41);var a=o(n);function o(t){return t&&t.__esModule?t:{default:t}}t.exports=function(t){return new a.default({name:"position",attributeNames:["aPosition"],uniformNames:["uPMatrix","uMMatrix","uColor","uVMatrix"],vsCode:r(45),fsCode:r(46),prepareBuffers:function t(e,r){var n=this.gl,a=e.aPosition+e.aColor+e.aUV;n.bindBuffer(n.ARRAY_BUFFER,r.vbo);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r.ibo);n.vertexAttribPointer(0,e.aPosition,n.FLOAT,false,a*4,0*4)},loadUniforms:function t(e){var r=this.gl;r.uniform4fv(this.UNIFORMS.uColor,e.color||e.state.color||e.goUp(function(t){if(t.state.color||t.color){return t.state.color||t.color}}))}}).init(t)}},function(t,e){t.exports="attribute vec3 aPosition;\n\nuniform mat4 uMMatrix;\nuniform mat4 uVMatrix;\nuniform mat4 uPMatrix;\nuniform vec4 uColor;\n\nvarying vec4 vColor;\n\nvoid main(void){\n    \n    gl_PointSize = 1.0; // default point size is 0 so pint are not visible\n    \n    vec3 pos = aPosition;\n     \n    gl_Position = uPMatrix*uVMatrix* uMMatrix*vec4(aPosition,1.0); \n  \n    vColor = uColor;\n}"},function(t,e){t.exports="precision mediump float;\n\nvarying vec4 vColor;\n\nvoid main(void){\n    gl_FragColor = vColor;\n}"},function(t,e,r){"use strict";var n=r(41);var a=o(n);function o(t){return t&&t.__esModule?t:{default:t}}t.exports=function(t){return new a.default({name:"position_uv",attributeNames:["aPosition","aUV"],uniformNames:["uPMatrix","uMMatrix","uSampler","uVMatrix","uColor"],vsCode:r(48),fsCode:r(49),prepareBuffers:function t(e,r){var n=this.gl,a=e.aPosition+e.aColor+e.aUV;n.bindBuffer(n.ARRAY_BUFFER,r.vbo);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r.ibo);n.vertexAttribPointer(0,e.aPosition,n.FLOAT,false,a*4,0*4);n.vertexAttribPointer(1,e.aUV,n.FLOAT,false,a*4,(e.aPosition+e.aColor)*4)},loadUniforms:function t(e,r){var n=this.gl;n.uniform4fv(this.UNIFORMS.uColor,e.color||e.state.color||e.goUp(function(t){if(t.state.color||t.color){return t.state.color||t.color}}));var a=r.getTexture(e.textureUrl);n.uniform1i(this.UNIFORMS.uSampler,a.id)}}).init(t)}},function(t,e){t.exports="//vertex shader\n\nattribute vec3 aPosition;\nattribute vec2 aUV;\n\nuniform mat4 uVMatrix;\nuniform mat4 uMMatrix;\nuniform mat4 uPMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vUV;\nvarying vec4 vColor;\n\nvoid main(void){\n\ngl_PointSize = 1.0; // default point size is 0 so pint are not visible\n   \ngl_Position = uPMatrix*uVMatrix*uMMatrix* vec4(aPosition,1.0);\nvUV = aUV;\nvColor = uColor;\n}\n"},function(t,e){t.exports="//fragment shader\n\nprecision mediump float;\n\nvarying vec2 vUV;\nvarying vec4 vColor;\n\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color  = vColor* texture2D(uSampler, vUV);\n    gl_FragColor = vec4(color.rgb, 1.0);\n}"}])});